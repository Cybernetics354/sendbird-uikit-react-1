{"version":3,"file":"ChannelPreview.js","sources":["../../src/ui/ChannelPreview/utils.js","../../src/ui/ChannelPreview/index.jsx"],"sourcesContent":["import isToday from 'date-fns/isToday';\nimport format from 'date-fns/format';\nimport formatRelative from 'date-fns/formatRelative';\nimport isYesterday from 'date-fns/isYesterday';\n\nimport { truncateString } from '../../utils';\nimport { LabelStringSet } from '../Label';\n\nexport const getChannelTitle = (channel = {}, currentUserId, stringSet = LabelStringSet) => {\n  if (!channel?.name && !channel?.members) {\n    return stringSet.NO_TITLE;\n  }\n  if (channel?.name && channel.name !== 'Group Channel') {\n    return channel.name;\n  }\n  if (channel?.members?.length === 1) {\n    return stringSet.NO_MEMBERS;\n  }\n  return (channel?.members || [])\n    .filter(({ userId }) => userId !== currentUserId)\n    .map(({ nickname }) => (nickname || stringSet.NO_NAME))\n    .join(', ');\n};\n\nexport const getLastMessageCreatedAt = (channel, locale) => {\n  const createdAt = channel?.lastMessage?.createdAt;\n  const optionalParam = locale ? { locale } : null;\n  if (!createdAt) {\n    return '';\n  }\n  if (isToday(createdAt)) {\n    return format(createdAt, 'p', optionalParam);\n  }\n  if (isYesterday(createdAt)) {\n    return formatRelative(createdAt, new Date(), optionalParam);\n  }\n  return format(createdAt, 'MMM dd', optionalParam);\n};\n\nexport const getTotalMembers = (channel) => (\n  channel?.memberCount\n    ? channel.memberCount\n    : 0\n);\n\nconst getPrettyLastMessage = (message = {}) => {\n  const MAXLEN = 30;\n  const { messageType, name } = message;\n  if (messageType === 'file') {\n    return truncateString(name, MAXLEN);\n  }\n  return message.message;\n};\n\nexport const getLastMessage = (channel) => (\n  channel?.lastMessage\n    ? getPrettyLastMessage(channel.lastMessage)\n    : ''\n);\n\nexport const getChannelUnreadMessageCount = (channel) => (\n  channel?.unreadMessageCount\n    ? channel.unreadMessageCount\n    : 0\n);\n","import React from 'react';\nimport PropTypes from 'prop-types';\n\nimport './index.scss';\n\nimport ChannelAvatar from '../ChannelAvatar/index';\nimport Badge from '../Badge';\nimport Icon, { IconColors, IconTypes } from '../Icon';\nimport Label, { LabelTypography, LabelColors } from '../Label';\nimport { useLocalization } from '../../lib/LocalizationContext';\n\nimport * as utils from './utils';\n\n// Legacy\nexport default function ChannelPreview({\n  channel,\n  currentUser,\n  isActive,\n  ChannelAction,\n  theme,\n  onClick,\n  tabIndex,\n}) {\n  const {\n    userId,\n  } = currentUser;\n  const isFrozen = channel?.isFrozen;\n  const isBroadcast = channel?.isBroadcast;\n  const { dateLocale, stringSet } = useLocalization();\n  return (\n    <div\n      className={[\n        'sendbird-channel-preview',\n        isActive ? 'sendbird-channel-preview--active' : '',\n      ].join(' ')}\n      role=\"link\"\n      onClick={onClick}\n      onKeyPress={onClick}\n      tabIndex={tabIndex}\n    >\n      <div\n        className=\"sendbird-channel-preview__avatar\"\n      >\n        <ChannelAvatar\n          channel={channel}\n          userId={userId}\n          theme={theme}\n        />\n      </div>\n      <div className=\"sendbird-channel-preview__content\">\n        <div className=\"sendbird-channel-preview__content__upper\">\n          <div className=\"sendbird-channel-preview__content__upper__header\">\n            {\n              isBroadcast\n              && (\n                <div className=\"sendbird-channel-preview__content__upper__header__broadcast-icon\">\n                  <Icon\n                    type={IconTypes.BROADCAST}\n                    fillColor={IconColors.SECONDARY}\n                    height=\"16px\"\n                    width=\"16px\"\n                  />\n                </div>\n              )\n            }\n            <Label\n              className=\"sendbird-channel-preview__content__upper__header__channel-name\"\n              type={LabelTypography.SUBTITLE_2}\n              color={LabelColors.ONBACKGROUND_1}\n            >\n              {utils.getChannelTitle(channel, userId, stringSet)}\n            </Label>\n            <Label\n              className=\"sendbird-channel-preview__content__upper__header__total-members\"\n              type={LabelTypography.CAPTION_2}\n              color={LabelColors.ONBACKGROUND_2}\n            >\n              {utils.getTotalMembers(channel)}\n            </Label>\n            {\n              isFrozen\n              && (\n                <div title=\"Frozen\" className=\"sendbird-channel-preview__content__upper__header__frozen-icon\">\n                  <Icon\n                    type={IconTypes.FREEZE}\n                    fillColor={IconColors.PRIMARY}\n                    height={12}\n                    width={12}\n                  />\n                </div>\n              )\n            }\n          </div>\n          <Label\n            className=\"sendbird-channel-preview__content__upper__last-message-at\"\n            type={LabelTypography.CAPTION_3}\n            color={LabelColors.ONBACKGROUND_2}\n          >\n            {utils.getLastMessageCreatedAt(channel, dateLocale)}\n          </Label>\n        </div>\n        <div className=\"sendbird-channel-preview__content__lower\">\n          <Label\n            className=\"sendbird-channel-preview__content__lower__last-message\"\n            type={LabelTypography.BODY_2}\n            color={LabelColors.ONBACKGROUND_3}\n          >\n            {utils.getLastMessage(channel)}\n          </Label>\n          <div className=\"sendbird-channel-preview__content__lower__unread-message-count\">\n            {\n              utils.getChannelUnreadMessageCount(channel) // return number\n                ? <Badge count={utils.getChannelUnreadMessageCount(channel)} />\n                : null\n            }\n          </div>\n        </div>\n      </div>\n      <div\n        className=\"sendbird-channel-preview__action\"\n      >\n        {ChannelAction}\n      </div>\n    </div>\n  );\n}\n\nChannelPreview.propTypes = {\n  /** Type: GroupChannel / OpenChannel(Not tested) */\n  channel: PropTypes.shape({\n    members: PropTypes.arrayOf(PropTypes.shape({})),\n    coverUrl: PropTypes.string,\n    isBroadcast: PropTypes.bool,\n    isFrozen: PropTypes.bool,\n  }),\n  /** Type: User */\n  currentUser: PropTypes.shape({\n    userId: PropTypes.string,\n  }),\n  isActive: PropTypes.bool,\n  /** To render dropdown menu */\n  ChannelAction: PropTypes.element.isRequired,\n  theme: PropTypes.string,\n  onClick: PropTypes.func,\n  tabIndex: PropTypes.number,\n};\n\nChannelPreview.defaultProps = {\n  channel: {},\n  currentUser: {},\n  isActive: false,\n  theme: 'light',\n  onClick: () => { },\n  tabIndex: 0,\n};\n"],"names":["getChannelTitle","channel","currentUserId","stringSet","LabelStringSet","name","members","NO_TITLE","length","NO_MEMBERS","filter","userId","map","nickname","NO_NAME","join","getLastMessageCreatedAt","locale","createdAt","lastMessage","optionalParam","isToday","format","isYesterday","formatRelative","Date","getTotalMembers","memberCount","getPrettyLastMessage","message","MAXLEN","messageType","truncateString","getLastMessage","getChannelUnreadMessageCount","unreadMessageCount","ChannelPreview","currentUser","isActive","ChannelAction","theme","onClick","tabIndex","isFrozen","isBroadcast","dateLocale","useLocalization","React","IconTypes","BROADCAST","IconColors","SECONDARY","LabelTypography","SUBTITLE_2","LabelColors","ONBACKGROUND_1","utils","CAPTION_2","ONBACKGROUND_2","FREEZE","PRIMARY","CAPTION_3","BODY_2","ONBACKGROUND_3","propTypes","PropTypes","shape","arrayOf","coverUrl","string","bool","element","isRequired","func","number","defaultProps"],"mappings":"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"}