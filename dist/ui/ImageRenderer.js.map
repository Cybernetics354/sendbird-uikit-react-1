{"version":3,"file":"ImageRenderer.js","sources":["../../src/ui/ImageRenderer/index.jsx"],"sourcesContent":["import React, { useState, useMemo } from 'react';\nimport PropTypes from 'prop-types';\n\nimport './index.scss';\n\n/*\n  ImageRenderer displays image with url or source\n  it checks if the source exist with img tag first\n  if it exists onLoad is called, if not onError is called\n  and those properties switch img tag to real purposing element\n*/\n\n// TODO: Set up the official constant of width and height with DesignTeam\n\nexport default function ImageRenderer({\n  className,\n  url,\n  alt,\n  width,\n  height,\n  fixedSize,\n  defaultComponent,\n  circle,\n  placeHolder, // a function returing JSX / (style) => Element\n  onLoad,\n  onError,\n}) {\n  const [showDefaultComponent, setShowDefaultComponent] = useState(false);\n  const [showPlaceHolder, setShowPlaceHolder] = useState(true);\n\n  const DefaultComponent = useMemo(() => {\n    if (typeof defaultComponent === 'function') {\n      return defaultComponent();\n    }\n    return defaultComponent;\n  }, [defaultComponent]);\n\n  const PlaceHolder = useMemo(() => {\n    if (placeHolder && typeof placeHolder === 'function') {\n      return placeHolder({\n        style: {\n          width: '100%',\n          minWidth: width,\n          maxWidth: fixedSize ? width : '400px',\n          height,\n          position: 'absolute',\n          display: 'flex',\n          justifyContent: 'center',\n          alignItems: 'center',\n        },\n      });\n    }\n    return null;\n  }, [placeHolder]);\n\n  const HiddenImageLoader = useMemo(() => {\n    setShowDefaultComponent(false);\n    // reset the state when url is changed\n    return (\n      <img\n        className=\"sendbird-image-renderer__hidden-image-loader\"\n        src={url}\n        alt={alt}\n        onLoad={() => {\n          setShowPlaceHolder(false);\n          onLoad();\n        }}\n        onError={() => {\n          setShowDefaultComponent(true);\n          onError();\n        }}\n      />\n    );\n  }, [url]);\n\n  return (\n    <div\n      className={[\n        ...(Array.isArray(className) ? className : [className]),\n        'sendbird-image-renderer',\n      ].join(' ')}\n      style={{\n        width: '100%',\n        minWidth: width,\n        maxWidth: fixedSize ? width : '400px',\n        height,\n      }}\n    >\n      {showPlaceHolder && PlaceHolder}\n      {\n        showDefaultComponent\n          ? DefaultComponent\n          : (\n            <div\n              className=\"sendbird-image-renderer__image\"\n              style={{\n                width: '100%',\n                minWidth: width,\n                maxWidth: fixedSize ? width : '400px',\n                height,\n                position: 'absolute',\n                backgroundRepeat: 'no-repeat',\n                backgroundPosition: 'center',\n                backgroundSize: 'cover',\n                backgroundImage: `url(${url})`,\n                borderRadius: circle ? '50%' : null,\n              }}\n            />\n          )\n      }\n      {HiddenImageLoader}\n    </div>\n  );\n}\n\nImageRenderer.propTypes = {\n  className: PropTypes.oneOfType([\n    PropTypes.arrayOf(PropTypes.string),\n    PropTypes.string,\n  ]),\n  url: PropTypes.string.isRequired,\n  alt: PropTypes.string,\n  width: PropTypes.oneOfType([\n    PropTypes.string,\n    PropTypes.number,\n  ]),\n  height: PropTypes.oneOfType([\n    PropTypes.string,\n    PropTypes.number,\n  ]),\n  fixedSize: PropTypes.bool,\n  defaultComponent: PropTypes.oneOfType([\n    PropTypes.element,\n    PropTypes.func,\n  ]),\n  placeHolder: PropTypes.func,\n  circle: PropTypes.bool,\n  onLoad: PropTypes.func,\n  onError: PropTypes.func,\n};\nImageRenderer.defaultProps = {\n  className: '',\n  defaultComponent: null,\n  placeHolder: null,\n  alt: '',\n  width: null,\n  height: null,\n  fixedSize: false,\n  circle: false,\n  onLoad: () => { },\n  onError: () => { },\n};\n"],"names":["ImageRenderer","className","url","alt","width","height","fixedSize","defaultComponent","circle","placeHolder","onLoad","onError","showDefaultComponent","setShowDefaultComponent","useState","showPlaceHolder","setShowPlaceHolder","DefaultComponent","useMemo","PlaceHolder","style","minWidth","maxWidth","position","display","justifyContent","alignItems","HiddenImageLoader","React","Array","isArray","join","backgroundRepeat","backgroundPosition","backgroundSize","backgroundImage","borderRadius","propTypes","PropTypes","oneOfType","arrayOf","string","isRequired","number","bool","element","func","defaultProps"],"mappings":"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"}