{"version":3,"file":"TypingIndicator.js","sources":["../../../src/smart-components/Channel/components/TypingIndicator.tsx"],"sourcesContent":["import React, { useEffect, useState, useContext } from 'react';\nimport {\n  GroupChannelHandler,\n  Member,\n  SendbirdGroupChat,\n} from '@sendbird/chat/groupChannel';\n\nimport { LocalizationContext } from '../../../lib/LocalizationContext';\nimport { uuidv4 } from '../../../utils/uuid';\nimport Label, { LabelTypography, LabelColors } from '../../../ui/Label';\nimport { useChannelContext } from '../context/ChannelProvider';\nimport useSendbirdStateContext from '../../../hooks/useSendbirdStateContext';\n\nexport interface TypingIndicatorTextProps {\n  members: Member[];\n}\n\nexport const TypingIndicatorText: React.FC<TypingIndicatorTextProps> = ({ members }: TypingIndicatorTextProps) => {\n  const { stringSet } = useContext(LocalizationContext);\n  if (!members || members.length === 0) {\n    return '';\n  }\n\n  if (members && members.length === 1) {\n    return `${members[0].nickname} ${stringSet.TYPING_INDICATOR__IS_TYPING}`;\n  }\n\n  if (members && members.length === 2) {\n    return `${members[0].nickname} ${stringSet.TYPING_INDICATOR__AND} ${members[1].nickname} ${stringSet.TYPING_INDICATOR__ARE_TYPING}`;\n  }\n\n  return stringSet.TYPING_INDICATOR__MULTIPLE_TYPING;\n};\n\nconst TypingIndicator: React.FC = () => {\n  const { channelUrl } = useChannelContext();\n  const globalStore = useSendbirdStateContext();\n  const sb = globalStore?.stores?.sdkStore?.sdk as SendbirdGroupChat;\n  const logger = globalStore?.config?.logger;\n  const [handlerId, setHandlerId] = useState(uuidv4());\n  const [typingMembers, setTypingMembers] = useState<Member[]>([]);\n\n  useEffect(() => {\n    if (sb?.groupChannel?.addGroupChannelHandler) {\n      sb.groupChannel.removeGroupChannelHandler(handlerId);\n      const newHandlerId = uuidv4();\n      const handler = new GroupChannelHandler({\n        onTypingStatusUpdated: (groupChannel) => {\n          // there is a possible warning in here - setState called after unmount\n          logger.info('Channel > Typing Indicator: onTypingStatusUpdated', groupChannel);\n          if (groupChannel.url === channelUrl) {\n            const members = groupChannel.getTypingUsers();\n            setTypingMembers(members);\n          }\n        }\n      });\n      sb.groupChannel.addGroupChannelHandler(newHandlerId, handler);\n      setHandlerId(newHandlerId);\n    }\n\n    return () => {\n      setTypingMembers([]);\n      if (sb) {\n        sb.groupChannel.removeGroupChannelHandler(handlerId);\n      }\n    };\n  }, [channelUrl]);\n\n  return (\n    <Label\n      className=\"sendbird-conversation__footer__typing-indicator__text\"\n      type={LabelTypography.CAPTION_2}\n      color={LabelColors.ONBACKGROUND_2}\n    >\n      <TypingIndicatorText members={typingMembers} />\n    </Label>\n  );\n}\n\nexport default TypingIndicator;\n"],"names":["TypingIndicatorText","_a","members","stringSet","useContext","LocalizationContext","length","nickname","TYPING_INDICATOR__IS_TYPING","TYPING_INDICATOR__AND","TYPING_INDICATOR__ARE_TYPING","TYPING_INDICATOR__MULTIPLE_TYPING","TypingIndicator","channelUrl","useChannelContext","globalStore","useSendbirdStateContext","sb","stores","sdkStore","sdk","logger","config","_d","useState","uuidv4","handlerId","setHandlerId","_e","typingMembers","setTypingMembers","useEffect","groupChannel","addGroupChannelHandler","removeGroupChannelHandler","newHandlerId","handler","GroupChannelHandler","onTypingStatusUpdated","info","url","getTypingUsers","React","LabelTypography","CAPTION_2","LabelColors","ONBACKGROUND_2"],"mappings":";;;;;;;;;;;;;;;;;;;;;;;;;;;IAiBaA,mBAAmB,GAAuC,UAACC,EAAD;MAAGC,OAAO;EACvE,IAAAC,SAAS,GAAKC,UAAU,CAACC,mBAAD,CAAV,UAAd;;EACR,IAAI,CAACH,OAAD,IAAYA,OAAO,CAACI,MAAR,KAAmB,CAAnC,EAAsC;IACpC,OAAO,EAAP;;;EAGF,IAAIJ,OAAO,IAAIA,OAAO,CAACI,MAAR,KAAmB,CAAlC,EAAqC;IACnC,OAAO,SAAA,CAAGJ,OAAO,CAAC,CAAD,CAAP,CAAWK,QAAd,KAAA,QAAA,CAA0BJ,SAAS,CAACK,2BAApC,CAAP;;;EAGF,IAAIN,OAAO,IAAIA,OAAO,CAACI,MAAR,KAAmB,CAAlC,EAAqC;IACnC,OAAO,SAAA,CAAGJ,OAAO,CAAC,CAAD,CAAP,CAAWK,QAAd,KAAA,QAAA,CAA0BJ,SAAS,CAACM,qBAApC,KAAA,QAAA,CAA6DP,OAAO,CAAC,CAAD,CAAP,CAAWK,QAAxE,KAAA,QAAA,CAAoFJ,SAAS,CAACO,4BAA9F,CAAP;;;EAGF,OAAOP,SAAS,CAACQ,iCAAjB;AACD;;IAEKC,eAAe,GAAa;;;EACxB,IAAAC,UAAU,GAAKC,iBAAiB,aAAhC;EACR,IAAMC,WAAW,GAAGC,uBAAuB,EAA3C;EACA,IAAMC,EAAE,GAAG,MAAA,MAAAF,WAAW,SAAX,IAAAA,WAAW,WAAX,SAAA,GAAAA,WAAW,CAAEG,MAAb,UAAA,iBAAA,SAAA,MAAqBC,QAArB,UAAA,iBAAA,SAAA,MAA+BC,GAA1C;EACA,IAAMC,MAAM,GAAG,MAAAN,WAAW,SAAX,IAAAA,WAAW,WAAX,SAAA,GAAAA,WAAW,CAAEO,MAAb,UAAA,iBAAA,SAAA,MAAqBD,MAApC;;EACM,IAAAE,KAA4BC,QAAQ,CAACC,MAAM,EAAP,CAApC;MAACC,SAAS,QAAV;MAAYC,YAAY,QAAxB;;EACA,IAAAC,KAAoCJ,QAAQ,CAAW,EAAX,CAA5C;MAACK,aAAa,QAAd;MAAgBC,gBAAgB,QAAhC;;EAENC,SAAS,CAAC;;;IACR,IAAI,MAAAd,EAAE,SAAF,IAAAA,EAAE,WAAF,SAAA,GAAAA,EAAE,CAAEe,YAAJ,UAAA,iBAAA,SAAA,MAAkBC,sBAAtB,EAA8C;MAC5ChB,EAAE,CAACe,YAAH,CAAgBE,yBAAhB,CAA0CR,SAA1C;MACA,IAAMS,YAAY,GAAGV,MAAM,EAA3B;MACA,IAAMW,OAAO,GAAG,IAAIC,EAAJ,CAAwB;QACtCC,qBAAqB,EAAE,UAACN,YAAD;;UAErBX,MAAM,CAACkB,IAAP,CAAY,mDAAZ,EAAiEP,YAAjE;;UACA,IAAIA,YAAY,CAACQ,GAAb,KAAqB3B,UAAzB,EAAqC;YACnC,IAAMX,OAAO,GAAG8B,YAAY,CAACS,cAAb,EAAhB;YACAX,gBAAgB,CAAC5B,OAAD,CAAhB;;;OANU,CAAhB;MAUAe,EAAE,CAACe,YAAH,CAAgBC,sBAAhB,CAAuCE,YAAvC,EAAqDC,OAArD;MACAT,YAAY,CAACQ,YAAD,CAAZ;;;IAGF,OAAO;MACLL,gBAAgB,CAAC,EAAD,CAAhB;;MACA,IAAIb,EAAJ,EAAQ;QACNA,EAAE,CAACe,YAAH,CAAgBE,yBAAhB,CAA0CR,SAA1C;;KAHJ;GAlBO,EAwBN,CAACb,UAAD,CAxBM,CAAT;EA0BA,oBACE6B,6BAAC,KAAD;IACE,SAAS,EAAC,uDADZ;IAEE,IAAI,EAAEC,eAAe,CAACC,SAFxB;IAGE,KAAK,EAAEC,WAAW,CAACC;kBAEnBJ,6BAAC,mBAAD;IAAqB,OAAO,EAAEb;IALhC,CADF;AASD;;;;"}