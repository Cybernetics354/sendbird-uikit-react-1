{"version":3,"file":"Message.js","sources":["../../../../src/smart-components/Channel/components/Message/index.tsx"],"sourcesContent":["import React, {\n  useRef,\n  useMemo,\n  useState,\n  useEffect,\n  useLayoutEffect,\n} from 'react';\nimport type { FileMessage } from '@sendbird/chat/message';\nimport format from 'date-fns/format';\n\nimport SuggestedMentionList from '../SuggestedMentionList';\nimport useSendbirdStateContext from '../../../../hooks/useSendbirdStateContext';\nimport { useChannelContext } from '../../context/ChannelProvider';\nimport { getClassName } from '../../../../utils';\nimport { isDisabledBecauseFrozen, isDisabledBecauseMuted } from '../../context/utils';\nimport { MAX_USER_MENTION_COUNT, MAX_USER_SUGGESTION_COUNT } from '../../context/const';\n\nimport DateSeparator from '../../../../ui/DateSeparator';\nimport Label, { LabelTypography, LabelColors } from '../../../../ui/Label';\nimport MessageInput from '../../../../ui/MessageInput';\nimport MessageContent from '../../../../ui/MessageContent';\nimport FileViewer from '../FileViewer';\nimport RemoveMessageModal from '../RemoveMessageModal';\nimport { MessageInputKeys } from '../../../../ui/MessageInput/const';\nimport { EveryMessage, RenderMessageProps } from '../../../../types';\nimport { useLocalization } from '../../../../lib/LocalizationContext';\n\ntype MessageUIProps = {\n  message: EveryMessage;\n  hasSeparator?: boolean;\n  chainTop?: boolean;\n  chainBottom?: boolean;\n  handleScroll: () => void;\n  // for extending\n  renderMessage?: (props: RenderMessageProps) => React.ReactElement;\n  renderCustomSeparator?: () => React.ReactElement;\n  renderEditInput?: () => React.ReactElement;\n  renderMessageContent?: () => React.ReactElement;\n};\n\nconst Message = (props: MessageUIProps): React.FC<MessageUIProps> | React.ReactElement => {\n  const {\n    message,\n    hasSeparator,\n    chainTop,\n    chainBottom,\n    handleScroll,\n    renderCustomSeparator,\n    renderEditInput,\n    renderMessage,\n    renderMessageContent,\n  } = props;\n\n  const { dateLocale } = useLocalization();\n  const globalStore = useSendbirdStateContext();\n  const {\n    userId,\n    isOnline,\n    isMentionEnabled,\n    userMention,\n  } = globalStore?.config;\n  const maxUserMentionCount = userMention?.maxMentionCount || MAX_USER_MENTION_COUNT;\n  const maxUserSuggestionCount = userMention?.maxSuggestionCount || MAX_USER_SUGGESTION_COUNT;\n\n  const {\n    initialized,\n    currentGroupChannel,\n    highLightedMessageId,\n    setHighLightedMessageId,\n    animatedMessageId,\n    setAnimatedMessageId,\n    updateMessage,\n    scrollToMessage,\n    replyType,\n    isReactionEnabled,\n    toggleReaction,\n    emojiContainer,\n    nicknamesMap,\n    setQuoteMessage,\n    resendMessage,\n    renderUserMentionItem,\n  } = useChannelContext();\n\n  const [showEdit, setShowEdit] = useState(false);\n  const [showRemove, setShowRemove] = useState(false);\n  const [showFileViewer, setShowFileViewer] = useState(false);\n  const [isAnimated, setIsAnimated] = useState(false);\n  const [isHighlighted, setIsHighlighted] = useState(false);\n  const [mentionNickname, setMentionNickname] = useState('');\n  const [mentionedUsers, setMentionedUsers] = useState([]);\n  const [mentionedUserIds, setMentionedUserIds] = useState([]);\n  const [messageInputEvent, setMessageInputEvent] = useState(null);\n  const [selectedUser, setSelectedUser] = useState(null);\n  const [mentionSuggestedUsers, setMentionSuggestedUsers] = useState([]);\n  const [ableMention, setAbleMention] = useState(true);\n  const editMessageInputRef = useRef(null);\n  const useMessageScrollRef = useRef(null);\n  const displaySuggestedMentionList = isOnline\n    && isMentionEnabled\n    && mentionNickname.length > 0\n    && !isDisabledBecauseFrozen(currentGroupChannel)\n    && !isDisabledBecauseMuted(currentGroupChannel);\n  const disabled = !initialized\n    || isDisabledBecauseFrozen(currentGroupChannel)\n    || isDisabledBecauseMuted(currentGroupChannel)\n    || !isOnline;\n\n  useEffect(() => {\n    if (mentionedUsers?.length >= maxUserMentionCount) {\n      setAbleMention(false);\n    } else {\n      setAbleMention(true);\n    }\n  }, [mentionedUsers]);\n\n  useEffect(() => {\n    setMentionedUsers(mentionedUsers.filter(({ userId }) => {\n      const i = mentionedUserIds.indexOf(userId);\n      if (i < 0) {\n        return false;\n      } else {\n        mentionedUserIds.splice(i, 1);\n        return true;\n      }\n    }));\n  }, [mentionedUserIds]);\n\n  useLayoutEffect(() => {\n    handleScroll?.();\n  }, [showEdit, message?.reactions?.length]);\n\n  useLayoutEffect(() => {\n    if (highLightedMessageId === message.messageId) {\n      if (useMessageScrollRef && useMessageScrollRef.current) {\n        useMessageScrollRef.current.scrollIntoView({ block: 'center', inline: 'center' });\n        setIsAnimated(false);\n        setTimeout(() => {\n          setIsHighlighted(true);\n        }, 500);\n        setTimeout(() => {\n          setHighLightedMessageId(0);\n        }, 1600);\n      }\n    } else {\n      setIsHighlighted(false);\n    }\n  }, [highLightedMessageId, useMessageScrollRef.current, message.messageId]);\n\n  useLayoutEffect(() => {\n    if (animatedMessageId === message.messageId) {\n      if (useMessageScrollRef && useMessageScrollRef.current) {\n        useMessageScrollRef.current.scrollIntoView({ block: 'center', inline: 'center' });\n        setIsHighlighted(false);\n        setTimeout(() => {\n          setIsAnimated(true);\n        }, 500);\n        setTimeout(() => {\n          setAnimatedMessageId(0);\n        }, 1600);\n      }\n    } else {\n      setIsAnimated(false);\n    }\n  }, [animatedMessageId, useMessageScrollRef.current, message.messageId]);\n  const renderedMessage = useMemo(() => {\n    return renderMessage?.({\n      message,\n      chainTop,\n      chainBottom,\n    });\n  }, [message, renderMessage]);\n  const renderedCustomSeparator = useMemo(() => {\n    if (renderCustomSeparator) {\n      return renderCustomSeparator?.();\n    }\n    return null;\n  }, [message, renderCustomSeparator]);\n\n  if (renderedMessage) {\n    return (\n      <div\n        ref={useMessageScrollRef}\n        className={getClassName([\n          'sendbird-msg-hoc sendbird-msg--scroll-ref',\n          isAnimated ? 'sendbird-msg-hoc__animated' : '',\n          isHighlighted ? 'sendbird-msg-hoc__highlighted' : '',\n        ])}\n      >\n        {/* date-separator */}\n        {\n          // TODO: Add message instance as a function parameter\n          hasSeparator && (renderedCustomSeparator || (\n            <DateSeparator>\n              <Label type={LabelTypography.CAPTION_2} color={LabelColors.ONBACKGROUND_2}>\n                {format(message.createdAt, 'MMMM dd, yyyy', {\n                  locale: dateLocale,\n                })}\n              </Label>\n            </DateSeparator>\n          ))\n        }\n        {renderedMessage}\n      </div>\n    );\n  }\n\n  if (showEdit && message.isUserMessage()) {\n    return renderEditInput?.() || (\n      <>\n        {\n          displaySuggestedMentionList && (\n            <SuggestedMentionList\n              targetNickname={mentionNickname}\n              inputEvent={messageInputEvent}\n              renderUserMentionItem={renderUserMentionItem}\n              onUserItemClick={(user) => {\n                if (user) {\n                  setMentionedUsers([...mentionedUsers, user]);\n                }\n                setMentionNickname('');\n                setSelectedUser(user);\n                setMessageInputEvent(null);\n              }}\n              onFocusItemChange={() => {\n                setMessageInputEvent(null);\n              }}\n              onFetchUsers={(users) => {\n                setMentionSuggestedUsers(users);\n              }}\n              ableAddMention={ableMention}\n              maxMentionCount={maxUserMentionCount}\n              maxSuggestionCount={maxUserSuggestionCount}\n            />\n          )\n        }\n        <MessageInput\n          isEdit\n          disabled={disabled}\n          ref={editMessageInputRef}\n          mentionSelectedUser={selectedUser}\n          isMentionEnabled={isMentionEnabled}\n          message={message}\n          onUpdateMessage={({ messageId, message, mentionTemplate }) => {\n            updateMessage({\n              messageId,\n              message,\n              mentionedUsers,\n              mentionTemplate,\n            });\n            setShowEdit(false);\n          }}\n          onCancelEdit={() => {\n            setMentionNickname('');\n            setMentionedUsers([]);\n            setMentionedUserIds([]);\n            setMentionSuggestedUsers([])\n            setShowEdit(false);\n          }}\n          onUserMentioned={(user) => {\n            if (selectedUser?.userId === user?.userId) {\n              setSelectedUser(null);\n              setMentionNickname('');\n            }\n          }}\n          onMentionStringChange={(mentionText) => {\n            setMentionNickname(mentionText);\n          }}\n          onMentionedUserIdsUpdated={(userIds) => {\n            setMentionedUserIds(userIds);\n          }}\n          onKeyDown={(e) => {\n            if (displaySuggestedMentionList && mentionSuggestedUsers?.length > 0\n              && ((e.key === MessageInputKeys.Enter && ableMention) || e.key === MessageInputKeys.ArrowUp || e.key === MessageInputKeys.ArrowDown)\n            ) {\n              setMessageInputEvent(e);\n              return true;\n            }\n            return false;\n          }}\n        />\n      </>\n    );\n  }\n\n  return (\n    <div\n      className={getClassName([\n        'sendbird-msg-hoc sendbird-msg--scroll-ref',\n        isAnimated ? 'sendbird-msg-hoc__animated' : '',\n        isHighlighted ? 'sendbird-msg-hoc__highlighted' : '',\n      ])}\n      style={{ marginBottom: '2px' }}\n      ref={useMessageScrollRef}\n    >\n      {/* date-separator */}\n      {\n        hasSeparator && (renderedCustomSeparator || (\n          <DateSeparator>\n            <Label type={LabelTypography.CAPTION_2} color={LabelColors.ONBACKGROUND_2}>\n              {format(message.createdAt, 'MMMM dd, yyyy', {\n                locale: dateLocale,\n              })}\n            </Label>\n          </DateSeparator>\n        ))\n      }\n      {/* Message */}\n      {\n        renderMessageContent?.() || (\n          <MessageContent\n            className=\"sendbird-message-hoc__message-content\"\n            userId={userId}\n            scrollToMessage={scrollToMessage}\n            channel={currentGroupChannel}\n            message={message}\n            disabled={!isOnline}\n            chainTop={chainTop}\n            chainBottom={chainBottom}\n            isReactionEnabled={isReactionEnabled}\n            replyType={replyType}\n            nicknamesMap={nicknamesMap}\n            emojiContainer={emojiContainer}\n            showEdit={setShowEdit}\n            showRemove={setShowRemove}\n            showFileViewer={setShowFileViewer}\n            resendMessage={resendMessage}\n            toggleReaction={toggleReaction}\n            setQuoteMessage={setQuoteMessage}\n          />\n        )\n      }\n      {/* Modal */}\n      {\n        showRemove && (\n          <RemoveMessageModal\n            message={message}\n            onCancel={() => setShowRemove(false)}\n          />\n        )\n      }\n      {\n        showFileViewer && (\n          <FileViewer\n            message={message as FileMessage}\n            onCancel={() => setShowFileViewer(false)}\n          />\n        )\n      }\n    </div>\n  );\n};\n\nexport default Message;\n"],"names":["Message","props","message","hasSeparator","chainTop","chainBottom","handleScroll","renderCustomSeparator","renderEditInput","renderMessage","renderMessageContent","dateLocale","useLocalization","globalStore","useSendbirdStateContext","_b","config","userId","isOnline","isMentionEnabled","userMention","maxUserMentionCount","maxMentionCount","MAX_USER_MENTION_COUNT","maxUserSuggestionCount","maxSuggestionCount","MAX_USER_SUGGESTION_COUNT","_c","useChannelContext","initialized","currentGroupChannel","highLightedMessageId","setHighLightedMessageId","animatedMessageId","setAnimatedMessageId","updateMessage","scrollToMessage","replyType","isReactionEnabled","toggleReaction","emojiContainer","nicknamesMap","setQuoteMessage","resendMessage","renderUserMentionItem","_d","useState","showEdit","setShowEdit","_e","showRemove","setShowRemove","_f","showFileViewer","setShowFileViewer","_g","isAnimated","setIsAnimated","_h","isHighlighted","setIsHighlighted","_j","mentionNickname","setMentionNickname","_k","mentionedUsers","setMentionedUsers","_l","mentionedUserIds","setMentionedUserIds","_m","messageInputEvent","setMessageInputEvent","_o","selectedUser","setSelectedUser","_p","mentionSuggestedUsers","setMentionSuggestedUsers","_q","ableMention","setAbleMention","editMessageInputRef","useRef","useMessageScrollRef","displaySuggestedMentionList","length","isDisabledBecauseFrozen","isDisabledBecauseMuted","disabled","useEffect","filter","_a","i","indexOf","splice","useLayoutEffect","reactions","messageId","current","scrollIntoView","block","inline","setTimeout","renderedMessage","useMemo","renderedCustomSeparator","React","getClassName","DateSeparator","Label","LabelTypography","CAPTION_2","LabelColors","ONBACKGROUND_2","format","createdAt","locale","isUserMessage","SuggestedMentionList","user","users","MessageInput","mentionTemplate","mentionText","userIds","e","key","MessageInputKeys","Enter","ArrowUp","ArrowDown","marginBottom","MessageContent","RemoveMessageModal","FileViewer"],"mappings":"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"}