{"version":3,"file":"MentionLabel.js","sources":["../../../src/ui/MentionLabel/index.tsx"],"sourcesContent":["import './index.scss';\n\nimport React, {\n  ReactElement,\n  useRef,\n  useState,\n  useCallback,\n} from 'react';\nimport type { User } from '@sendbird/chat';\n\nimport ContextMenu, { MenuItems } from '../ContextMenu';\nimport Label, { LabelTypography, LabelColors } from '../Label';\nimport UserProfile from '../UserProfile';\nimport useSendbirdStateContext from '../../hooks/useSendbirdStateContext';\n\ninterface MentionLabelProps {\n  mentionTemplate: string;\n  mentionedUserId: string;\n  mentionedUserNickname: string;\n  isByMe: boolean;\n}\n\nexport default function MentionLabel(props: MentionLabelProps): JSX.Element {\n  const {\n    mentionTemplate,\n    mentionedUserId,\n    mentionedUserNickname,\n    isByMe,\n  } = props;\n\n  const mentionRef = useRef();\n\n  const sendbirdState = useSendbirdStateContext();\n  const userId = sendbirdState?.config?.userId;\n  const sdk = sendbirdState?.stores?.sdkStore?.sdk;\n  const amIBeingMentioned = userId === mentionedUserId;\n  const [user, setUser] = useState<User| null>();\n  const fetchUser = useCallback(\n    (toggleDropdown) => {\n      if (user) {\n        toggleDropdown();\n      }\n      const query = sdk.createApplicationUserListQuery({\n        userIdsFilter: [mentionedUserId],\n      });\n      query.next().then((members) => {\n        if (members?.length > 0) {\n          setUser(members[0]);\n        }\n        toggleDropdown();\n      })\n    },\n    [sdk, mentionedUserId],\n  );\n  return (\n    <ContextMenu\n      menuTrigger={(toggleDropdown: () => void): ReactElement => (\n        <a\n          className={`\n            sendbird-word__mention\n            ${amIBeingMentioned ? 'sendbird-word__mention--me' : ''}\n          `}\n          onClick={() => fetchUser(toggleDropdown)}\n          ref={mentionRef}\n        >\n          <Label\n            type={LabelTypography.CAPTION_1}\n            color={isByMe ? LabelColors.ONCONTENT_1 : LabelColors.ONBACKGROUND_1}\n          >\n            {`${mentionTemplate}${mentionedUserNickname}`}\n          </Label>\n        </a>\n      )}\n      menuItems={(closeDropdown: () => void): ReactElement => (\n        <MenuItems\n          /**\n          * parentRef: For catching location(x, y) of MenuItems\n          * parentContainRef: For toggling more options(menus & reactions)\n          */\n          parentRef={mentionRef}\n          parentContainRef={mentionRef}\n          closeDropdown={closeDropdown}\n          style={{ paddingTop: 0, paddingBottom: 0 }}\n        >\n          <UserProfile user={user} onSuccess={closeDropdown} />\n        </MenuItems>\n      )}\n    />\n  )\n}\n"],"names":["MentionLabel","props","mentionTemplate","mentionedUserId","mentionedUserNickname","isByMe","mentionRef","useRef","sendbirdState","useSendbirdStateContext","userId","config","sdk","stores","sdkStore","amIBeingMentioned","_d","useState","user","setUser","fetchUser","useCallback","toggleDropdown","query","createApplicationUserListQuery","userIdsFilter","next","then","members","length","React","ContextMenu","Label","LabelTypography","CAPTION_1","LabelColors","ONCONTENT_1","ONBACKGROUND_1","closeDropdown","MenuItems","paddingTop","paddingBottom","UserProfile"],"mappings":";;;;;;;;;;;;;;;;;;;;;;;;;;;;;;SAsBwBA,aAAaC;;;EAEjC,IAAAC,eAAe,GAIbD,KAAK,gBAJP;MACAE,eAAe,GAGbF,KAAK,gBAJP;MAEAG,qBAAqB,GAEnBH,KAAK,sBAJP;MAGAI,MAAM,GACJJ,KAAK,OAJP;EAMF,IAAMK,UAAU,GAAGC,YAAM,EAAzB;EAEA,IAAMC,aAAa,GAAGC,uBAAuB,EAA7C;EACA,IAAMC,MAAM,GAAG,MAAAF,aAAa,SAAb,IAAAA,aAAa,WAAb,SAAA,GAAAA,aAAa,CAAEG,MAAf,UAAA,iBAAA,SAAA,MAAuBD,MAAtC;EACA,IAAME,GAAG,GAAG,MAAA,MAAAJ,aAAa,SAAb,IAAAA,aAAa,WAAb,SAAA,GAAAA,aAAa,CAAEK,MAAf,UAAA,iBAAA,SAAA,MAAuBC,QAAvB,UAAA,iBAAA,SAAA,MAAiCF,GAA7C;EACA,IAAMG,iBAAiB,GAAGL,MAAM,KAAKP,eAArC;;EACM,IAAAa,KAAkBC,cAAQ,EAA1B;MAACC,IAAI,QAAL;MAAOC,OAAO,QAAd;;EACN,IAAMC,SAAS,GAAGC,iBAAW,CAC3B,UAACC,cAAD;IACE,IAAIJ,IAAJ,EAAU;MACRI,cAAc;;;IAEhB,IAAMC,KAAK,GAAGX,GAAG,CAACY,8BAAJ,CAAmC;MAC/CC,aAAa,EAAE,CAACtB,eAAD;KADH,CAAd;IAGAoB,KAAK,CAACG,IAAN,GAAaC,IAAb,CAAkB,UAACC,OAAD;MAChB,IAAI,CAAAA,OAAO,SAAP,IAAAA,OAAO,WAAP,SAAA,GAAAA,OAAO,CAAEC,MAAT,IAAkB,CAAtB,EAAyB;QACvBV,OAAO,CAACS,OAAO,CAAC,CAAD,CAAR,CAAP;;;MAEFN,cAAc;KAJhB;GARyB,EAe3B,CAACV,GAAD,EAAMT,eAAN,CAf2B,CAA7B;EAiBA,oBACE2B,wCAACC,yBAAD;IACE,WAAW,EAAE,UAACT,cAAD;MAA8C,oBACzDQ;QACE,SAAS,EAAE,2DAAA,CAEPf,iBAAiB,GAAG,4BAAH,GAAkC,EAF5C,gBAAA,CADb;QAKE,OAAO,EAAE;UAAM,OAAAK,SAAS,CAACE,cAAD,CAAT;SALjB;QAME,GAAG,EAAEhB;sBAELwB,wCAACE,cAAD;QACE,IAAI,EAAEC,wBAAe,CAACC,SADxB;QAEE,KAAK,EAAE7B,MAAM,GAAG8B,oBAAW,CAACC,WAAf,GAA6BD,oBAAW,CAACE;SAErD,SAAA,CAAGnC,eAAH,QAAA,CAAqBE,qBAArB,CAJH,CARF,CADyD;KAD7D;IAkBE,SAAS,EAAE,UAACkC,aAAD;MAA6C,oBACtDR,wCAACS;;;;;;QAKC,SAAS,EAAEjC,UALb;QAME,gBAAgB,EAAEA,UANpB;QAOE,aAAa,EAAEgC,aAPjB;QAQE,KAAK,EAAE;UAAEE,UAAU,EAAE,CAAd;UAAiBC,aAAa,EAAE;;sBAEvCX,wCAACY,cAAD;QAAa,IAAI,EAAExB,IAAnB;QAAyB,SAAS,EAAEoB;QAVtC,CADsD;;IAnB5D;AAmCD;;;;"}