{"version":3,"file":"ContextMenu.js","sources":["../../../src/ui/ContextMenu/items/MenuItems.jsx","../../../src/ui/ContextMenu/items/EmojiListItems.jsx","../../../src/ui/ContextMenu/index.jsx"],"sourcesContent":["import React, { Component } from 'react';\nimport { createPortal } from 'react-dom';\nimport PropTypes from 'prop-types';\n\nexport default class MenuItems extends Component {\n  constructor(props) {\n    super(props);\n    this.menuRef = React.createRef();\n    this.state = {\n      menuStyle: {},\n      handleClickOutside: () => { },\n    };\n  }\n\n  componentDidMount() {\n    this.setupEvents();\n    this.getMenuPosition();\n  }\n\n  componentWillUnmount() {\n    this.cleanUpEvents();\n  }\n\n  setupEvents = () => {\n    const { closeDropdown } = this.props;\n    const { menuRef } = this;\n    const handleClickOutside = (event) => {\n      if (menuRef.current && !menuRef.current.contains(event.target)) {\n        closeDropdown();\n      }\n    };\n    this.setState({\n      handleClickOutside,\n    });\n\n    document.addEventListener('mousedown', handleClickOutside);\n  }\n\n  cleanUpEvents = () => {\n    const {\n      handleClickOutside,\n    } = this.state;\n    document.removeEventListener('mousedown', handleClickOutside);\n  }\n\n  getMenuPosition = () => {\n    const { parentRef, openLeft } = this.props;\n    const parentRect = parentRef.current.getBoundingClientRect();\n    const x = parentRect.x || parentRect.left;\n    const y = parentRect.y || parentRect.top;\n    const menuStyle = {\n      top: y,\n      left: x,\n    };\n\n    if (!this.menuRef.current) return menuStyle;\n\n    const { innerWidth, innerHeight } = window;\n    const rect = this.menuRef.current.getBoundingClientRect();\n    if (y + rect.height > innerHeight) {\n      menuStyle.top -= rect.height;\n    }\n\n    if (x + rect.width > innerWidth && !openLeft) {\n      menuStyle.left -= rect.width;\n    }\n\n    if (menuStyle.top < 0) {\n      menuStyle.top = rect.height < innerHeight ? (innerHeight - rect.height) / 2 : 0;\n    }\n\n    if (menuStyle.left < 0) {\n      menuStyle.left = rect.width < innerWidth ? (innerWidth - rect.width) / 2 : 0;\n    }\n\n    menuStyle.top += 32;\n    if (openLeft) {\n      const padding = Number.isNaN(rect.width - 30)\n        ? 108 // default\n        : rect.width - 30;\n      menuStyle.left -= padding;\n    }\n\n    return this.setState({ menuStyle });\n  }\n\n  render() {\n    const { menuStyle } = this.state;\n    const { children, style } = this.props;\n    return (\n      createPortal(\n        (\n          <>\n            <div className=\"sendbird-dropdown__menu-backdrop\" />\n            <ul\n              className=\"sendbird-dropdown__menu\"\n              ref={this.menuRef}\n              style={{\n                display: 'inline-block',\n                position: 'fixed',\n                left: `${Math.round(menuStyle.left)}px`,\n                top: `${Math.round(menuStyle.top)}px`,\n                ...style,\n              }}\n            >\n              {children}\n            </ul>\n          </>\n        ),\n        document.getElementById('sendbird-dropdown-portal'),\n      )\n    );\n  }\n}\nMenuItems.propTypes = {\n  closeDropdown: PropTypes.func.isRequired,\n  children: PropTypes.oneOfType([\n    PropTypes.element,\n    PropTypes.arrayOf(PropTypes.element),\n  ]).isRequired,\n  style: PropTypes.shape({}),\n  // https://stackoverflow.com/a/51127130\n  parentRef: PropTypes.oneOfType([\n    PropTypes.func,\n    PropTypes.shape({ current: PropTypes.instanceOf(Element) }),\n  ]).isRequired,\n  // parentContainRef: PropTypes.oneOfType([\n  //   PropTypes.func,\n  //   PropTypes.shape({ current: PropTypes.instanceOf(Element) }),\n  // ]).isRequired,\n  openLeft: PropTypes.bool,\n};\nMenuItems.defaultProps = {\n  style: {},\n  openLeft: false,\n};\n","import React, { Component } from 'react';\nimport { createPortal } from 'react-dom';\nimport PropTypes from 'prop-types';\n\nimport SortByRow from '../../SortByRow';\n\nexport default class EmojiListItems extends Component {\n  constructor(props) {\n    super(props);\n    this.reactionRef = React.createRef();\n    this.state = {\n      reactionStyle: {},\n      handleClickOutside: () => { },\n    };\n  }\n\n  componentDidMount() {\n    this.setupEvents();\n    this.getBarPosition();\n    this.showParent();\n  }\n\n  componentWillUnmount() {\n    this.cleanUpEvents();\n    this.hideParent();\n  }\n\n  showParent = () => {\n    const { parentContainRef = {} } = this.props;\n    const { current } = parentContainRef;\n    if (parentContainRef && current) {\n      current.classList.add('sendbird-reactions--pressed');\n    }\n  }\n\n  hideParent = () => {\n    const { parentContainRef = {} } = this.props;\n    const { current } = parentContainRef;\n    if (parentContainRef && current) {\n      current.classList.remove('sendbird-reactions--pressed');\n    }\n  }\n\n  setupEvents = () => {\n    const { closeDropdown } = this.props;\n    const { reactionRef } = this;\n    const handleClickOutside = (event) => {\n      if (reactionRef.current && !reactionRef.current.contains(event.target)) {\n        closeDropdown();\n      }\n    };\n    this.setState({\n      handleClickOutside,\n    });\n    document.addEventListener('mousedown', handleClickOutside);\n  }\n\n  cleanUpEvents = () => {\n    const {\n      handleClickOutside,\n    } = this.state;\n    document.removeEventListener('mousedown', handleClickOutside);\n  }\n\n  getBarPosition = () => {\n    // calculate the location that the context menu should be\n    const {\n      parentRef,\n      spaceFromTrigger,\n    } = this.props;\n    const spaceFromTriggerX = spaceFromTrigger.x || 0;\n    const spaceFromTriggerY = spaceFromTrigger.y || 0;\n\n    const parentRect = parentRef.current.getBoundingClientRect();\n\n    const x = parentRect.x || parentRect.left;\n    const y = parentRect.y || parentRect.top;\n\n    const reactionStyle = {\n      top: y,\n      left: x,\n    };\n\n    if (!this.reactionRef.current) return reactionStyle;\n    const rect = this.reactionRef.current.getBoundingClientRect();\n\n    if (reactionStyle.top < rect.height) {\n      reactionStyle.top += parentRect.height;\n      reactionStyle.top += spaceFromTriggerY;\n    } else {\n      reactionStyle.top -= rect.height;\n      reactionStyle.top -= spaceFromTriggerY;\n    }\n\n    reactionStyle.left -= (rect.width / 2);\n    reactionStyle.left += (parentRect.height / 2) - 2;\n    reactionStyle.left += spaceFromTriggerX;\n\n    const maximumLeft = (window.innerWidth - rect.width);\n    if (maximumLeft < reactionStyle.left) {\n      reactionStyle.left = maximumLeft;\n    }\n    if (reactionStyle.left < 0) {\n      reactionStyle.left = 0;\n    }\n\n    return this.setState({ reactionStyle });\n  }\n\n  render() {\n    const { reactionStyle } = this.state;\n    const { children } = this.props;\n    return (\n      createPortal(\n        <>\n          <div className=\"sendbird-dropdown__menu-backdrop\" />\n          <ul\n            className=\"sendbird-dropdown__reaction-bar\"\n            ref={this.reactionRef}\n            style={{\n              display: 'inline-block',\n              position: 'fixed',\n              left: `${Math.round(reactionStyle.left)}px`,\n              top: `${Math.round(reactionStyle.top)}px`,\n            }}\n          >\n            <SortByRow\n              className=\"sendbird-dropdown__reaction-bar__row\"\n              maxItemCount={8}\n              itemWidth={44}\n              itemHeight={40}\n            >\n              {children}\n            </SortByRow>\n          </ul>\n        </>,\n        document.getElementById('sendbird-emoji-list-portal'),\n      )\n    );\n  }\n}\nEmojiListItems.propTypes = {\n  closeDropdown: PropTypes.func.isRequired,\n  children: PropTypes.oneOfType([\n    PropTypes.element,\n    PropTypes.arrayOf(PropTypes.element),\n  ]).isRequired,\n  parentRef: PropTypes.oneOfType([\n    PropTypes.func,\n    PropTypes.shape({ current: PropTypes.instanceOf(Element) }),\n  ]).isRequired,\n  parentContainRef: PropTypes.oneOfType([\n    PropTypes.func,\n    PropTypes.shape({ current: PropTypes.instanceOf(Element) }),\n  ]).isRequired,\n  spaceFromTrigger: PropTypes.shape({\n    x: PropTypes.number,\n    y: PropTypes.number,\n  }),\n};\nEmojiListItems.defaultProps = {\n  spaceFromTrigger: {},\n};\n","import React, { useState } from 'react';\nimport PropTypes from 'prop-types';\n\nimport './index.scss';\n\nimport Label, { LabelTypography, LabelColors } from '../Label';\nimport { getClassName } from '../../utils';\n\nimport MenuItems_ from './items/MenuItems';\nimport EmojiListItems_ from './items/EmojiListItems';\n\nconst ENTER = 13;\n\nexport const MenuItems = MenuItems_;\nexport const EmojiListItems = EmojiListItems_;\n\nexport const MenuItem = ({\n  className,\n  children,\n  onClick,\n  disable,\n}) => {\n  const handleClickEvent = (e) => { if (!disable) onClick(e); };\n  return (\n    <li\n      className={getClassName([className, 'sendbird-dropdown__menu-item', disable ? 'disable' : ''])}\n      role=\"menuitem\"\n      onClick={handleClickEvent}\n      onKeyPress={(e) => { if (e.keyCode === ENTER) handleClickEvent(e); }}\n      tabIndex={0}\n    >\n      <Label\n        className=\"sendbird-dropdown__menu-item__text\"\n        type={LabelTypography.SUBTITLE_2}\n        color={disable ? LabelColors.ONBACKGROUND_4 : LabelColors.ONBACKGROUND_1}\n      >\n        {children}\n      </Label>\n    </li>\n  );\n};\n\nMenuItem.propTypes = {\n  className: PropTypes.oneOfType([\n    PropTypes.string,\n    PropTypes.arrayOf(PropTypes.string),\n  ]),\n  children: PropTypes.oneOfType([\n    PropTypes.string,\n    PropTypes.element,\n  ]).isRequired,\n  onClick: PropTypes.func.isRequired,\n  disable: PropTypes.bool,\n};\n\nMenuItem.defaultProps = {\n  className: '',\n  disable: false,\n};\n\n// Root components should be appended before ContextMenu is rendered\nexport const MenuRoot = () => (\n  <div id=\"sendbird-dropdown-portal\" />\n);\nexport const EmojiReactionListRoot = () => (\n  <div id=\"sendbird-emoji-list-portal\" />\n);\n\nexport default function ContextMenu({ menuTrigger, menuItems }) {\n  const [showMenu, setShowMenu] = useState(false);\n\n  return (\n    <div className=\"sendbird-context-menu\" style={{ display: 'inline' }}>\n      {menuTrigger(() => setShowMenu(!showMenu))}\n      {showMenu && menuItems(() => setShowMenu(false))}\n    </div>\n  );\n}\n\nContextMenu.propTypes = {\n  menuTrigger: PropTypes.func.isRequired,\n  menuItems: PropTypes.func.isRequired,\n};\n"],"names":["MenuItems","Component","constructor","props","_defineProperty","closeDropdown","menuRef","handleClickOutside","event","current","contains","target","setState","document","addEventListener","state","removeEventListener","parentRef","openLeft","parentRect","getBoundingClientRect","x","left","y","top","menuStyle","innerWidth","innerHeight","window","rect","height","width","padding","Number","isNaN","React","createRef","componentDidMount","setupEvents","getMenuPosition","componentWillUnmount","cleanUpEvents","render","children","style","createPortal","_objectSpread","display","position","Math","round","getElementById","propTypes","PropTypes","func","isRequired","oneOfType","element","arrayOf","shape","instanceOf","Element","bool","defaultProps","EmojiListItems","parentContainRef","classList","add","remove","reactionRef","spaceFromTrigger","spaceFromTriggerX","spaceFromTriggerY","reactionStyle","maximumLeft","getBarPosition","showParent","hideParent","SortByRow","number","ENTER","MenuItems_","EmojiListItems_","MenuItem","className","onClick","disable","handleClickEvent","e","getClassName","keyCode","Label","LabelTypography","SUBTITLE_2","LabelColors","ONBACKGROUND_4","ONBACKGROUND_1","string","MenuRoot","EmojiReactionListRoot","ContextMenu","menuTrigger","menuItems","showMenu","setShowMenu","useState"],"mappings":"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"}