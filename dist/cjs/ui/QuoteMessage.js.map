{"version":3,"file":"QuoteMessage.js","sources":["../../../src/ui/QuoteMessage/index.tsx"],"sourcesContent":["import './index.scss';\nimport React, { ReactElement, useContext, useState } from 'react';\nimport type { FileMessage, UserMessage } from '@sendbird/chat/message';\n\nimport Icon, { IconTypes, IconColors } from '../Icon';\nimport Label, { LabelTypography, LabelColors } from '../Label';\nimport ImageRenderer from '../ImageRenderer';\nimport { LocalizationContext } from '../../lib/LocalizationContext';\nimport {\n  getClassName,\n  getUIKitFileType,\n  getUIKitFileTypes,\n  isFileMessage,\n  isGif,\n  isSupportedFileView,\n  isThumbnailMessage,\n  isUserMessage,\n  isVideo,\n  truncateString,\n} from '../../utils';\ninterface Props {\n  message?: UserMessage | FileMessage;\n  userId?: string;\n  isByMe?: boolean;\n  className?: string | Array<string>;\n  onClick?: () => void;\n}\n\nexport default function QuoteMessage({\n  message,\n  userId = '',\n  isByMe = false,\n  className,\n  onClick,\n}: Props): ReactElement {\n  const { stringSet } = useContext(LocalizationContext);\n\n  const { parentMessage } = message;\n  const parentMessageSender = (parentMessage as UserMessage | FileMessage)?.sender;\n  const parentMessageSenderNickname = (userId === parentMessageSender?.userId) ? stringSet.QUOTED_MESSAGE__CURRENT_USER : parentMessageSender?.nickname;\n  const parentMessageUrl = (parentMessage as FileMessage)?.url || '';\n  const parentMessageType = (parentMessage as FileMessage)?.type;\n  const currentMessageSenderNickname = (userId === message?.sender?.userId) ? stringSet.QUOTED_MESSAGE__CURRENT_USER : message?.sender?.nickname;\n\n  const [isThumbnailLoaded, setThumbnailLoaded] = useState(false);\n  const uikitFileTypes = getUIKitFileTypes();\n  const splitFileName = (parentMessage as FileMessage)?.name ? (parentMessage as FileMessage).name.split('/') : parentMessageUrl.split('/');\n\n  return (\n    <div\n      className={getClassName([className, 'sendbird-quote-message', isByMe ? 'outgoing' : 'incoming'])}\n      key={parentMessage?.messageId}\n      onClick={() => { if (onClick) onClick() }}\n    >\n      <div className=\"sendbird-quote-message__replied-to\">\n        <Icon\n          className=\"sendbird-quote-message__replied-to__icon\"\n          type={IconTypes.REPLY}\n          fillColor={IconColors.ON_BACKGROUND_3}\n          width=\"12px\"\n          height=\"12px\"\n        />\n        <Label\n          className=\"sendbird-quote-message__replied-to__text\"\n          type={LabelTypography.CAPTION_2}\n          color={LabelColors.ONBACKGROUND_3}\n        >\n          {`${currentMessageSenderNickname} ${stringSet.QUOTED_MESSAGE__REPLIED_TO} ${parentMessageSenderNickname}`}\n        </Label>\n      </div>\n      <div className=\"sendbird-quote-message__replied-message\">\n        {/* text message */}\n        {(isUserMessage(parentMessage as UserMessage) && (parentMessage as UserMessage)?.message?.length > 0) && (\n          <div className=\"sendbird-quote-message__replied-message__text-message\">\n            <Label\n              className=\"sendbird-quote-message__replied-message__text-message__word\"\n              type={LabelTypography.BODY_2}\n              color={LabelColors.ONBACKGROUND_1}\n            >\n              {(parentMessage as UserMessage)?.message}\n            </Label>\n          </div>\n        )}\n        {/* thumbnail message */}\n        {(isThumbnailMessage(parentMessage as FileMessage) && parentMessageUrl) && (\n          <div className=\"sendbird-quote-message__replied-message__thumbnail-message\">\n            <ImageRenderer\n              className=\"sendbird-quote-message__replied-message__thumbnail-message__image\"\n              url={parentMessageUrl}\n              alt={parentMessageType}\n              width=\"144px\"\n              height=\"108px\"\n              onLoad={() => setThumbnailLoaded(true)}\n              defaultComponent={(\n                <div className=\"sendbird-quote-message__replied-message__thumbnail-message__placeholder\">\n                  <div className=\"sendbird-quote-message__replied-message__thumbnail-message__placeholder__icon\">\n                    <Icon\n                      type={isVideo(parentMessageType) ? IconTypes.PLAY : IconTypes.PHOTO}\n                      fillColor={IconColors.ON_BACKGROUND_2}\n                      width=\"22px\"\n                      height=\"22px\"\n                    />\n                  </div>\n                </div>\n              )}\n            />\n            {(isVideo(parentMessageType) && !((parentMessage as FileMessage)?.thumbnails?.length > 0)) && (\n              <>\n                <video className=\"sendbird-quote-message__replied-message__thumbnail-message__video\">\n                  <source src={parentMessageUrl} type={parentMessageType} />\n                </video>\n                <div className=\"sendbird-quote-message__replied-message__thumbnail-message__cover\">\n                  <div className=\"sendbird-quote-message__replied-message__thumbnail-message__cover__icon\">\n                    <Icon\n                      type={IconTypes.PLAY}\n                      fillColor={IconColors.GRAY}\n                      width=\"14px\"\n                      height=\"14px\"\n                    />\n                  </div>\n                </div>\n              </>\n            )}\n            {(isThumbnailLoaded && isGif(parentMessageType)) && (\n              <div className=\"sendbird-quote-message__replied-message__thumbnail-message__cover\">\n                <div className=\"sendbird-quote-message__replied-message__thumbnail-message__cover__icon\">\n                  <Icon\n                    type={IconTypes.GIF}\n                    fillColor={IconColors.GRAY}\n                    width=\"14px\"\n                    height=\"14px\"\n                  />\n                </div>\n              </div>\n            )}\n          </div>\n        )}\n        {/* file message */}\n        {(isFileMessage(parentMessage as FileMessage) && !isSupportedFileView((parentMessage as FileMessage).type) && parentMessageUrl) && (\n          <div className=\"sendbird-quote-message__replied-message__file-message\">\n            <Icon\n              className=\"sendbird-quote-message__replied-message__file-message__type-icon\"\n              type={{\n                [uikitFileTypes.IMAGE]: IconTypes.PHOTO,\n                [uikitFileTypes.VIDEO]: IconTypes.PLAY,\n                [uikitFileTypes.AUDIO]: IconTypes.FILE_AUDIO,\n                [uikitFileTypes.GIF]: IconTypes.GIF,\n                [uikitFileTypes.OTHERS]: IconTypes.FILE_DOCUMENT,\n              }[getUIKitFileType(parentMessageType)]}\n              fillColor={IconColors.ON_BACKGROUND_3}\n              width=\"16px\"\n              height=\"16px\"\n            />\n            <Label\n              className=\"sendbird-quote-message__replied-message__file-message__file-name\"\n              type={LabelTypography.BODY_2}\n              color={LabelColors.ONBACKGROUND_3}\n            >\n              {truncateString(splitFileName[splitFileName.length - 1])}\n            </Label>\n          </div>\n        )}\n      </div>\n    </div>\n  );\n}\n"],"names":["QuoteMessage","_a","message","_g","userId","_h","isByMe","className","onClick","stringSet","useContext","LocalizationContext","parentMessage","parentMessageSender","sender","parentMessageSenderNickname","QUOTED_MESSAGE__CURRENT_USER","nickname","parentMessageUrl","url","parentMessageType","type","currentMessageSenderNickname","_j","useState","isThumbnailLoaded","setThumbnailLoaded","uikitFileTypes","getUIKitFileTypes","splitFileName","name","split","React","getClassName","messageId","Icon","IconTypes","REPLY","IconColors","ON_BACKGROUND_3","Label","LabelTypography","CAPTION_2","LabelColors","ONBACKGROUND_3","QUOTED_MESSAGE__REPLIED_TO","isUserMessage","length","BODY_2","ONBACKGROUND_1","isThumbnailMessage","ImageRenderer","isVideo","PLAY","PHOTO","ON_BACKGROUND_2","thumbnails","GRAY","isGif","GIF","isFileMessage","isSupportedFileView","_b","IMAGE","VIDEO","AUDIO","FILE_AUDIO","OTHERS","FILE_DOCUMENT","getUIKitFileType","truncateString"],"mappings":";;;;;;;;;;;;;;;;;SA4BwBA,aAAaC;;;;;MACnCC,OAAO;MACPC;MAAAC,MAAM,mBAAG;MACTC;MAAAC,MAAM,mBAAG;MACTC,SAAS;MACTC,OAAO;EAEC,IAAAC,SAAS,GAAKC,gBAAU,CAACC,uCAAD,CAAV,UAAd;EAEA,IAAAC,aAAa,GAAKV,OAAO,cAAzB;EACR,IAAMW,mBAAmB,GAAID,aAA2C,SAA3C,IAAAA,aAAa,WAAb,SAAA,GAAAA,aAAa,CAAgCE,MAA1E;EACA,IAAMC,2BAA2B,GAAIX,MAAM,MAAKS,mBAAmB,SAAnB,IAAAA,mBAAmB,WAAnB,SAAA,GAAAA,mBAAmB,CAAET,MAA1B,CAAP,GAA2CK,SAAS,CAACO,4BAArD,GAAoFH,mBAAmB,SAAnB,IAAAA,mBAAmB,WAAnB,SAAA,GAAAA,mBAAmB,CAAEI,QAA7I;EACA,IAAMC,gBAAgB,GAAG,CAACN,aAA6B,SAA7B,IAAAA,aAAa,WAAb,SAAA,GAAAA,aAAa,CAAkBO,GAAhC,KAAuC,EAAhE;EACA,IAAMC,iBAAiB,GAAIR,aAA6B,SAA7B,IAAAA,aAAa,WAAb,SAAA,GAAAA,aAAa,CAAkBS,IAA1D;EACA,IAAMC,4BAA4B,GAAIlB,MAAM,MAAK,MAAAF,OAAO,SAAP,IAAAA,OAAO,WAAP,SAAA,GAAAA,OAAO,CAAEY,MAAT,UAAA,iBAAA,SAAA,MAAiBV,MAAtB,CAAP,GAAuCK,SAAS,CAACO,4BAAjD,GAAgF,MAAAd,OAAO,SAAP,IAAAA,OAAO,WAAP,SAAA,GAAAA,OAAO,CAAEY,MAAT,UAAA,iBAAA,SAAA,MAAiBG,QAAtI;;EAEM,IAAAM,KAA0CC,cAAQ,CAAC,KAAD,CAAlD;MAACC,iBAAiB,QAAlB;MAAoBC,kBAAkB,QAAtC;;EACN,IAAMC,cAAc,GAAGC,uBAAiB,EAAxC;EACA,IAAMC,aAAa,GAAG,CAACjB,aAA6B,SAA7B,IAAAA,aAAa,WAAb,SAAA,GAAAA,aAAa,CAAkBkB,IAAhC,IAAwClB,aAA6B,CAACkB,IAA9B,CAAmCC,KAAnC,CAAyC,GAAzC,CAAxC,GAAwFb,gBAAgB,CAACa,KAAjB,CAAuB,GAAvB,CAA9G;EAEA,oBACEC;IACE,SAAS,EAAEC,kBAAY,CAAC,CAAC1B,SAAD,EAAY,wBAAZ,EAAsCD,MAAM,GAAG,UAAH,GAAgB,UAA5D,CAAD,CADzB;IAEE,GAAG,EAAEM,aAAa,SAAb,IAAAA,aAAa,WAAb,SAAA,GAAAA,aAAa,CAAEsB,SAFtB;IAGE,OAAO,EAAE;MAAQ,IAAI1B,OAAJ,EAAaA,OAAO;;kBAErCwB;IAAK,SAAS,EAAC;kBACbA,wCAACG,kBAAD;IACE,SAAS,EAAC,0CADZ;IAEE,IAAI,EAAEC,iBAAS,CAACC,KAFlB;IAGE,SAAS,EAAEC,kBAAU,CAACC,eAHxB;IAIE,KAAK,EAAC,MAJR;IAKE,MAAM,EAAC;IANX,eAQEP,wCAACQ,cAAD;IACE,SAAS,EAAC,0CADZ;IAEE,IAAI,EAAEC,wBAAe,CAACC,SAFxB;IAGE,KAAK,EAAEC,oBAAW,CAACC;KAElB,SAAA,CAAGtB,4BAAH,KAAA,QAAA,CAAmCb,SAAS,CAACoC,0BAA7C,KAAA,QAAA,CAA2E9B,2BAA3E,CALH,CARF,CALF,eAqBEiB;IAAK,SAAS,EAAC;KAEXc,mBAAa,CAAClC,aAAD,CAAb,IAA+C,CAAA,MAACA,aAA6B,SAA7B,IAAAA,aAAa,WAAb,SAAA,GAAAA,aAAa,CAAkBV,OAAhC,UAAA,iBAAA,SAAA,MAAyC6C,MAAzC,IAAkD,CAAlG,iBACCf;IAAK,SAAS,EAAC;kBACbA,wCAACQ,cAAD;IACE,SAAS,EAAC,6DADZ;IAEE,IAAI,EAAEC,wBAAe,CAACO,MAFxB;IAGE,KAAK,EAAEL,oBAAW,CAACM;KAEjBrC,aAA6B,SAA7B,IAAAA,aAAa,WAAb,SAAA,GAAAA,aAAa,CAAkBV,OALnC,CADF,CAHJ,EAcIgD,wBAAkB,CAACtC,aAAD,CAAlB,IAAoDM,gBAArD,iBACCc;IAAK,SAAS,EAAC;kBACbA,wCAACmB,gBAAD;IACE,SAAS,EAAC,mEADZ;IAEE,GAAG,EAAEjC,gBAFP;IAGE,GAAG,EAAEE,iBAHP;IAIE,KAAK,EAAC,OAJR;IAKE,MAAM,EAAC,OALT;IAME,MAAM,EAAE;MAAM,OAAAM,kBAAkB,CAAC,IAAD,CAAlB;KANhB;IAOE,gBAAgB,eACdM;MAAK,SAAS,EAAC;oBACbA;MAAK,SAAS,EAAC;oBACbA,wCAACG,kBAAD;MACE,IAAI,EAAEiB,aAAO,CAAChC,iBAAD,CAAP,GAA6BgB,iBAAS,CAACiB,IAAvC,GAA8CjB,iBAAS,CAACkB,KADhE;MAEE,SAAS,EAAEhB,kBAAU,CAACiB,eAFxB;MAGE,KAAK,EAAC,MAHR;MAIE,MAAM,EAAC;MALX,CADF;IATN,EAqBIH,aAAO,CAAChC,iBAAD,CAAP,IAA8B,EAAE,CAAA,MAACR,aAA6B,SAA7B,IAAAA,aAAa,WAAb,SAAA,GAAAA,aAAa,CAAkB4C,UAAhC,UAAA,iBAAA,SAAA,MAA4CT,MAA5C,IAAqD,CAAvD,CAA/B,iBACCf,+FACEA;IAAO,SAAS,EAAC;kBACfA;IAAQ,GAAG,EAAEd,gBAAb;IAA+B,IAAI,EAAEE;IADvC,CADF,eAIEY;IAAK,SAAS,EAAC;kBACbA;IAAK,SAAS,EAAC;kBACbA,wCAACG,kBAAD;IACE,IAAI,EAAEC,iBAAS,CAACiB,IADlB;IAEE,SAAS,EAAEf,kBAAU,CAACmB,IAFxB;IAGE,KAAK,EAAC,MAHR;IAIE,MAAM,EAAC;IALX,CADF,CAJF,CAtBJ,EAsCIhC,iBAAiB,IAAIiC,WAAK,CAACtC,iBAAD,CAA3B,iBACCY;IAAK,SAAS,EAAC;kBACbA;IAAK,SAAS,EAAC;kBACbA,wCAACG,kBAAD;IACE,IAAI,EAAEC,iBAAS,CAACuB,GADlB;IAEE,SAAS,EAAErB,kBAAU,CAACmB,IAFxB;IAGE,KAAK,EAAC,MAHR;IAIE,MAAM,EAAC;IALX,CADF,CAvCJ,CAfJ,EAoEIG,mBAAa,CAAChD,aAAD,CAAb,IAA+C,CAACiD,yBAAmB,CAAEjD,aAA6B,CAACS,IAAhC,CAAnE,IAA4GH,gBAA7G,iBACCc;IAAK,SAAS,EAAC;kBACbA,wCAACG,kBAAD;IACE,SAAS,EAAC,kEADZ;IAEE,IAAI,EAAE,UACJ2B,GAACnC,cAAc,CAACoC,MAAhB,GAAwB3B,iBAAS,CAACkB,OAClCQ,GAACnC,cAAc,CAACqC,MAAhB,GAAwB5B,iBAAS,CAACiB,MAClCS,GAACnC,cAAc,CAACsC,MAAhB,GAAwB7B,iBAAS,CAAC8B,YAClCJ,GAACnC,cAAc,CAACgC,IAAhB,GAAsBvB,iBAAS,CAACuB,KAChCG,GAACnC,cAAc,CAACwC,OAAhB,GAAyB/B,iBAAS,CAACgC,iBAL/B,EAMJC,sBAAgB,CAACjD,iBAAD,CANZ,CAFR;IASE,SAAS,EAAEkB,kBAAU,CAACC,eATxB;IAUE,KAAK,EAAC,MAVR;IAWE,MAAM,EAAC;IAZX,eAcEP,wCAACQ,cAAD;IACE,SAAS,EAAC,kEADZ;IAEE,IAAI,EAAEC,wBAAe,CAACO,MAFxB;IAGE,KAAK,EAAEL,oBAAW,CAACC;KAElB0B,oBAAc,CAACzC,aAAa,CAACA,aAAa,CAACkB,MAAd,GAAuB,CAAxB,CAAd,CALjB,CAdF,CArEJ,CArBF,CADF;AAqHD;;;;"}