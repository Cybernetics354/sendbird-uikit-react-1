import { t, aK as T, W, a as n, l as a, m as o, r, i, T as K, aL as se, y, E, a7 as m, af as st, b as bn$1, o as ot, S as St$1, aM as z, R, aN as le, s, aO as xt$1, aP as an$1, I as Ie, aQ as $t$1, ao as h, ae as On$1, aR as Ie$1, aS as we, h as U, aT as Bt$1, e as ct, v as pe, aU as ne, d as at, aV as re, p, aW as ae, aX as ie, aY as me, aZ as un$1, a5 as S, ak as kt$1, a_ as G, a$ as Q, b0 as Ct$1, ag as Tt$1, b1 as re$1, b2 as Ue, n as ne$1, L as Le, b3 as L, g as d, U as Ue$1, q, F, b4 as Fe, b5 as qe, b6 as Ve, b7 as Ot$1, ay as C, aj as H, B, a4 as ue, a3 as he, b8 as fe, f as M, am as de, an as J, b9 as We, ba as Ht$1, bb as ee, bc as Y, bd as ae$1, be as oe, bf as Gt$1, bg as Dt$1, bh as Lt$1, bi as Wt$1, ab as H$1, bj as In$1, bk as j, Y as Y$1, al as U$1, Q as $, bl as Vt$1, w as be, x as te, A as me$1, ap as tt, aq as je, ar as pt, au as dt, at as ct$1, as as _, av as at$1, aw as ot$1, ax as d$1, az as h$1, aA as T$1, aB as H$2, bm as cn$1, aC as wt$1, aD as Tt$2, aE as It$1, aF as c, aG as gt, aH as Jt$1, aI as A, bn as Se, aJ as En$1, u as ue$1, bo as Ee, bp as ln$1, bq as Rt$1, br as Me, bs as Ot$2, bt as Ee$1, a8 as Ee$2, a9 as _e, aa as ye, ac as Ae, bu as Nt$1, bv as bt$1, P as ve } from './__bundle-7dfccc8c-8480a26a.js';

var yt;!function(e){e.NONE="none",e.JOINED="joined",e.INVITED="invited";}(yt||(yt={}));var Ct,Nt,bt,Mt,St,At,Tt,Ut,It=function(i){function a(e,r){var s=i.call(this,e,r)||this;return s.state=null,s.role=null,s.isMuted=!1,s.isBlockedByMe=!1,s.isBlockingMe=!1,s.state=m(yt,r.state)?r.state:null,s.role=m(re$1,r.role)?r.role:null,r.hasOwnProperty("is_muted")&&(s.isMuted=r.is_muted),r.hasOwnProperty("is_blocked_by_me")&&(s.isBlockedByMe=r.is_blocked_by_me),r.hasOwnProperty("is_blocking_me")&&(s.isBlockingMe=r.is_blocking_me),s}return t(a,i),a.payloadify=function(e){return e?U(n(n({},i.payloadify.call(this,e)),{state:e.state,role:e.role,is_muted:e.isMuted,is_blocked_by_me:e.isBlockedByMe,is_blocking_me:e.isBlockingMe})):null},a}(Ue),wt=function(t$1){function n(e,n){var r,s,o=this;return (o=t$1.call(this,e)||this).channelUrl=null!==(r=n.channel_url)&&void 0!==r?r:"",o.channelType=null!==(s=n.channel_type)&&void 0!==s?s:ne$1.GROUP,o.reader=new ct(o._iid,n.user),o.readAt=n.ts,o}return t(n,t$1),n}(Le);!function(e){e.ALL="all",e.PUBLIC="public",e.PRIVATE="private";}(Ct||(Ct={})),function(e){e.ALL="all",e.JOINED="joined_only",e.INVITED="invited_only",e.INVITED_BY_FRIEND="invited_by_friend",e.INVITED_BY_NON_FRIEND="invited_by_non_friend";}(Nt||(Nt={})),function(e){e.ALL="all",e.SUPER="super",e.NON_SUPER="nonsuper",e.BROADCAST_ONLY="broadcast_only",e.EXCLUSIVE_ONLY="exclusive_only";}(bt||(bt={})),function(e){e.ALL="all",e.UNREAD_MESSAGE="unread_message";}(Mt||(Mt={})),function(e){e.ALL="all",e.UNHIDDEN="unhidden_only",e.HIDDEN="hidden_only",e.HIDDEN_ALLOW_AUTO_UNHIDE="hidden_allow_auto_unhide",e.HIDDEN_PREVENT_AUTO_UNHIDE="hidden_prevent_auto_unhide";}(St||(St={})),function(e){e.ALL="all",e.OPERATOR="operator",e.NONOPERATOR="nonoperator";}(At||(At={})),function(e){e.AND="AND",e.OR="OR";}(Tt||(Tt={})),function(e){e.MEMBER_NICKNAME="member_nickname",e.CHANNEL_NAME="channel_name";}(Ut||(Ut={}));var Dt,Lt=function(){function e(){this._searchFilter=null,this._userIdsFilter=null,this.includeEmpty=!1,this.nicknameContainsFilter="",this.channelNameContainsFilter="",this.myMemberStateFilter=Nt.ALL,this.customTypesFilter=null,this.channelUrlsFilter=null,this.superChannelFilter=bt.ALL,this.publicChannelFilter=Ct.ALL,this.customTypeStartsWithFilter=null,this.unreadChannelFilter=Mt.ALL,this.hiddenChannelFilter=St.UNHIDDEN,this.includeFrozen=!0;}return e.prototype._isFriend=function(e){return !!e.friendDiscoveryKey||!!e.friendName},Object.defineProperty(e.prototype,"searchFilter",{get:function(){return this._searchFilter},enumerable:!1,configurable:!0}),e.prototype.setSearchFilter=function(e,t){Array.isArray(e)&&0!==e.length&&"string"==typeof t&&t&&(this._searchFilter={query:t,fields:e});},Object.defineProperty(e.prototype,"userIdsFilter",{get:function(){return this._userIdsFilter},enumerable:!1,configurable:!0}),e.prototype.setUserIdsFilter=function(e,t,n){void 0===n&&(n=Tt.AND),this._userIdsFilter={userIds:e,includeMode:t,queryType:n};},e.prototype.clone=function(){var t=new e;this.searchFilter&&t.setSearchFilter(this.searchFilter.fields,this.searchFilter.query),this.userIdsFilter&&t.setUserIdsFilter(this.userIdsFilter.userIds,this.userIdsFilter.includeMode,this.userIdsFilter.queryType);var n=JSON.parse(JSON.stringify(this));return Object.keys(n).forEach((function(e){t[e]=n[e];})),t},e.prototype.match=function(e,t){if(this._searchFilter){var n=this._searchFilter,r=n.query,s=n.fields;if(r&&s&&s.length>0&&!s.some((function(t){switch(t){case Ut.CHANNEL_NAME:return e.name.toLowerCase().includes(r.toLowerCase());case Ut.MEMBER_NICKNAME:return e.members.some((function(e){return e.nickname.toLowerCase().includes(r.toLowerCase())}));default:return !0}})))return !1}if(this._userIdsFilter){var i=this._userIdsFilter,a=i.userIds,o=i.includeMode,u=i.queryType,l=e.members.map((function(e){return e.userId}));if(o){if(a.length>0)switch(u){case Tt.AND:if(a.some((function(e){return !l.includes(e)})))return !1;break;case Tt.OR:if(a.every((function(e){return !l.includes(e)})))return !1}}else {if(a.includes(t)||a.push(t),e.members.length>a.length)return !1;if(!T(a,l))return !1}}if(!this.includeEmpty&&!e.lastMessage)return !1;if(!this.includeFrozen&&e.isFrozen)return !1;if(this.customTypesFilter&&this.customTypesFilter.length>0&&!this.customTypesFilter.includes(e.customType))return !1;if(this.customTypeStartsWithFilter&&!new RegExp("^".concat(this.customTypeStartsWithFilter)).test(e.customType))return !1;if(this.channelNameContainsFilter&&!e.name.toLowerCase().includes(this.channelNameContainsFilter.toLowerCase()))return !1;if(this.nicknameContainsFilter){var h=this.nicknameContainsFilter.toLowerCase();if(e.members.every((function(e){return !e.nickname.toLowerCase().includes(h)})))return !1}if(this.channelUrlsFilter&&this.channelUrlsFilter.length>0&&!this.channelUrlsFilter.includes(e.url))return !1;if(this.myMemberStateFilter)switch(this.myMemberStateFilter){case Nt.JOINED:if("joined"!==e.myMemberState)return !1;break;case Nt.INVITED:if("invited"!==e.myMemberState)return !1;break;case Nt.INVITED_BY_FRIEND:if("invited"!==e.myMemberState||!this._isFriend(e.inviter))return !1;break;case Nt.INVITED_BY_NON_FRIEND:if("invited"!==e.myMemberState||this._isFriend(e.inviter))return !1;break;case Nt.ALL:if("none"===e.myMemberState)return !1}if(this.hiddenChannelFilter)switch(this.hiddenChannelFilter){case St.UNHIDDEN:if(e.isHidden||"unhidden"!==e.hiddenState)return !1;break;case St.HIDDEN:if(!e.isHidden)return !1;break;case St.HIDDEN_ALLOW_AUTO_UNHIDE:if(!e.isHidden||"hidden_allow_auto_unhide"!==e.hiddenState)return !1;break;case St.HIDDEN_PREVENT_AUTO_UNHIDE:if(!e.isHidden||"hidden_prevent_auto_unhide"!==e.hiddenState)return !1}if(this.unreadChannelFilter&&this.unreadChannelFilter===Mt.UNREAD_MESSAGE)if(0===e.unreadMessageCount)return !1;if(this.publicChannelFilter)switch(this.publicChannelFilter){case Ct.PUBLIC:if(!e.isPublic)return !1;break;case Ct.PRIVATE:if(e.isPublic)return !1}if(this.superChannelFilter)switch(this.superChannelFilter){case bt.SUPER:if(!e.isSuper)return !1;break;case bt.NON_SUPER:if(e.isSuper)return !1}return !0},e}(),Rt=function(t$1){function n$1(e,n){var r=n.sdkState,s=n.cacheContext,i=t$1.call(this,e)||this;return i._channels=new Map,i._sdkState=r,i._cacheContext=s,i}return t(n$1,t$1),Object.defineProperty(n$1.prototype,"collection",{get:function(){var e=this._cacheContext.nestdb;return e?e.collection(W):null},enumerable:!1,configurable:!0}),Object.defineProperty(n$1.prototype,"localCacheEnabled",{get:function(){return this._cacheContext.localCacheEnabled&&!!this.collection},enumerable:!1,configurable:!0}),n$1.prototype._serialize=function(e,t){return void 0===t&&(t=0),n(n({},e.serialize()),{lastMessageUpdatedAt:e.lastMessage?e.lastMessage.createdAt:0,syncIndex:t})},n$1.prototype._deserialize=function(e){return Bn.of(this._iid).buildGroupChannelFromSerializedData(e)},Object.defineProperty(n$1.prototype,"channels",{get:function(){return a([],o(this._channels.values()),!1)},enumerable:!1,configurable:!0}),n$1.prototype.isCachedInMemory=function(e){return this._channels.has(e)},n$1.prototype.get=function(e){return r(this,void 0,void 0,(function(){var t,n;return i(this,(function(r){switch(r.label){case 0:return this._channels.has(e)?[3,3]:this.localCacheEnabled?[4,this.collection.getByKey(e)]:[3,2];case 1:if(t=r.sent())return n=this._deserialize(t),this._channels.set(e,n),[2,n];r.label=2;case 2:return [2,null];case 3:return [2,this._channels.get(e)]}}))}))},n$1.prototype.fetch=function(e){var t=e.token,n=e.limit,r$1=void 0===n?j:n,s=e.backward,i$1=void 0!==s&&s,a=e.filter,o=void 0===a?new Lt:a,u=e.order,c=void 0===u?K.LATEST_LAST_MESSAGE:u;return r(this,void 0,void 0,(function(){var e,n,s,a,u=this;return i(this,(function(l){switch(l.label){case 0:return this.localCacheEnabled?(e=$(c),n={where:function(e){if(t)switch(c){case K.CHANNEL_NAME_ALPHABETICAL:if(!i$1&&e.name.localeCompare(t)<0||i$1&&e.name.localeCompare(t)>0)return !1;break;case K.CHRONOLOGICAL:if(!i$1&&e.createdAt>t||i$1&&e.createdAt<t)return !1;break;case K.LATEST_LAST_MESSAGE:if(!i$1&&e.lastMessageUpdatedAt>t||i$1&&e.lastMessageUpdatedAt<t)return !1}return o.match(u._deserialize(e),u._sdkState.userId)},index:e,backward:i$1},[4,this.collection.query(n)]):[3,3];case 1:return [4,l.sent().fetch({limit:r$1})];case 2:return s=l.sent(),(a=s.map((function(e){return u._deserialize(e)}))).forEach((function(e){u._channels.has(e.url)||u._channels.set(e.url,e);})),[2,a];case 3:return [2,[]]}}))}))},n$1.prototype.upsert=function(e){return r(this,void 0,void 0,(function(){var t,n,r=this;return i(this,(function(s){switch(s.label){case 0:if(e.forEach((function(e){if(r._channels.has(e.url)){var t=r._channels.get(e.url);Object.assign(t,e,{_iid:r._iid});}else r._channels.set(e.url,e);})),!this.localCacheEnabled)return [3,2];for(n in t=[],e)t.push(this._serialize(e[n],parseInt(n)));return [4,this.collection.upsertMany(t)];case 1:s.sent(),s.label=2;case 2:return [2]}}))}))},n$1.prototype.remove=function(e){return r(this,void 0,void 0,(function(){var t,n,r,s$1,i$1,a;return i(this,(function(o){switch(o.label){case 0:o.trys.push([0,5,6,7]),t=s(e),n=t.next(),o.label=1;case 1:return n.done?[3,4]:(r=n.value,this._channels.delete(r),this.localCacheEnabled?[4,this.collection.remove(r)]:[3,3]);case 2:o.sent(),o.label=3;case 3:return n=t.next(),[3,1];case 4:return [3,7];case 5:return s$1=o.sent(),i$1={error:s$1},[3,7];case 6:try{n&&!n.done&&(a=t.return)&&a.call(t);}finally{if(i$1)throw i$1.error}return [7];case 7:return [2]}}))}))},n$1.prototype.clear=function(){return r(this,void 0,void 0,(function(){return i(this,(function(e){switch(e.label){case 0:return this.clearMemoryCache(),this.localCacheEnabled?[4,this.collection.clear()]:[3,2];case 1:e.sent(),e.label=2;case 2:return [2]}}))}))},n$1.prototype.clearMemoryCache=function(){this._channels.clear();},n$1.prototype._setBlockStateOfAllChannels=function(e,t,n){return r(this,void 0,void 0,(function(){var r,s$1,i$1,a,o,u,c,l,h,d,p,m,v,g,E,y,C,N,b;return i(this,(function(_){switch(_.label){case 0:if(r=[],e===this._sdkState.userId)try{for(s$1=s(this._channels.values()),i$1=s$1.next();!i$1.done;i$1=s$1.next()){l=i$1.value;try{for(g=void 0,a=s(l.members),o=a.next();!o.done;o=a.next())if((p=o.value).userId===t){p.isBlockedByMe=n,r.push(l);break}}catch(e){g={error:e};}finally{try{o&&!o.done&&(E=a.return)&&E.call(a);}finally{if(g)throw g.error}}}}catch(e){m={error:e};}finally{try{i$1&&!i$1.done&&(v=s$1.return)&&v.call(s$1);}finally{if(m)throw m.error}}else if(t===this._sdkState.userId)try{for(u=s(this._channels.values()),c=u.next();!c.done;c=u.next()){l=c.value;try{for(N=void 0,h=s(l.members),d=h.next();!d.done;d=h.next())if((p=d.value).userId===e){p.isBlockingMe=n,r.push(l);break}}catch(e){N={error:e};}finally{try{d&&!d.done&&(b=h.return)&&b.call(h);}finally{if(N)throw N.error}}}}catch(e){y={error:e};}finally{try{c&&!c.done&&(C=u.return)&&C.call(u);}finally{if(y)throw y.error}}return r.length>0?[4,this.upsert(r)]:[3,2];case 1:_.sent(),_.label=2;case 2:return [2]}}))}))},n$1.prototype.block=function(e,t){return r(this,void 0,void 0,(function(){return i(this,(function(n){switch(n.label){case 0:return [4,this._setBlockStateOfAllChannels(e,t,!0)];case 1:return n.sent(),[2]}}))}))},n$1.prototype.unblock=function(e,t){return r(this,void 0,void 0,(function(){return i(this,(function(n){switch(n.label){case 0:return [4,this._setBlockStateOfAllChannels(e,t,!1)];case 1:return n.sent(),[2]}}))}))},n$1.prototype.markAsRead=function(e,t){return void 0===t&&(t=a([],o(this._channels.keys()),!1)),r(this,void 0,void 0,(function(){var n,r,s$1,i$1,a,o,u,c;return i(this,(function(l){switch(l.label){case 0:n=[],l.label=1;case 1:l.trys.push([1,6,7,8]),r=s(t),s$1=r.next(),l.label=2;case 2:return s$1.done?[3,5]:(i$1=s$1.value,[4,this.get(i$1)]);case 3:(a=l.sent())._updateUnreadMemberState(this._sdkState.userId,e)&&(a._updateUnreadCount(0,0),n.push(a)),l.label=4;case 4:return s$1=r.next(),[3,2];case 5:return [3,8];case 6:return o=l.sent(),u={error:o},[3,8];case 7:try{s$1&&!s$1.done&&(c=r.return)&&c.call(r);}finally{if(u)throw u.error}return [7];case 8:return n.length>0?[4,this.upsert(n)]:[3,10];case 9:l.sent(),l.label=10;case 10:return [2]}}))}))},n$1}(Le),Ot={invitedUserIds:null,channelUrl:null,coverUrl:null,coverImage:null,isDistinct:null,isSuper:null,isBroadcast:null,isExclusive:null,isPublic:null,isDiscoverable:null,isStrict:null,isEphemeral:null,accessCode:null,name:null,data:null,customType:null,operatorUserIds:null,messageSurvivalSeconds:null},kt=function(e){return E("string",e.invitedUserIds,!0)&&y("string",e.channelUrl,!0)&&y("string",e.coverUrl,!0)&&(S(e.coverImage)||y("string",e.coverImage)||null===e.coverImage)&&y("boolean",e.isDistinct,!0)&&y("boolean",e.isSuper,!0)&&y("boolean",e.isBroadcast,!0)&&y("boolean",e.isExclusive,!0)&&y("boolean",e.isPublic,!0)&&y("boolean",e.isStrict,!0)&&y("boolean",e.isDiscoverable,!0)&&y("boolean",e.isEphemeral,!0)&&y("string",e.accessCode,!0)&&y("string",e.name,!0)&&y("string",e.data,!0)&&y("string",e.customType,!0)&&E("string",e.operatorUserIds,!0)&&y("number",e.messageSurvivalSeconds,!0)},Ft={customTypes:null,includeEmpty:!1,includeFrozen:!0},Pt=function(e){return E("string",e.customTypes,!0)&&y("boolean",e.includeEmpty)&&y("boolean",e.includeFrozen)},xt={myMemberStateFilter:Nt.ALL},Ht=function(e){return m(Nt,e.myMemberStateFilter)};!function(e){e.GROUP_CHANNEL_UNREAD_MENTION_COUNT="group_channel_unread_mention_count",e.NONSUPER_UNREAD_MENTION_COUNT="non_super_group_channel_unread_mention_count",e.SUPER_UNREAD_MENTION_COUNT="super_group_channel_unread_mention_count",e.GROUP_CHANNEL_UNREAD_MESSAGE_COUNT="group_channel_unread_message_count",e.NONSUPER_UNREAD_MESSAGE_COUNT="non_super_group_channel_unread_message_count",e.SUPER_UNREAD_MESSAGE_COUNT="super_group_channel_unread_message_count",e.GROUP_CHANNEL_INVITATION_COUNT="group_channel_invitation_count",e.NONSUPER_INVITATION_COUNT="non_super_group_channel_invitation_count",e.SUPER_INVITATION_COUNT="super_group_channel_invitation_count";}(Dt||(Dt={}));var Vt,Gt={keys:[]},qt={channelCustomTypesFilter:null,superChannelFilter:bt.ALL},Bt={channelUrl:null,scheduledStatus:null,messageTypeFilter:se.ALL};!function(e){e.UNKNOWN="UNKNOWN",e.EVENT_CHANNEL_CREATED="EVENT_CHANNEL_CREATED",e.EVENT_CHANNEL_UPDATED="EVENT_CHANNEL_UPDATED",e.EVENT_CHANNEL_DELETED="EVENT_CHANNEL_DELETED",e.EVENT_CHANNEL_READ="EVENT_CHANNEL_READ",e.EVENT_CHANNEL_DELIVERED="EVENT_CHANNEL_DELIVERED",e.EVENT_CHANNEL_INVITED="EVENT_CHANNEL_INVITED",e.EVENT_CHANNEL_JOINED="EVENT_CHANNEL_JOINED",e.EVENT_CHANNEL_LEFT="EVENT_CHANNEL_LEFT",e.EVENT_CHANNEL_ACCEPTED_INVITE="EVENT_CHANNEL_ACCEPTED_INVITE",e.EVENT_CHANNEL_DECLINED_INVITE="EVENT_CHANNEL_DECLINED_INVITE",e.EVENT_CHANNEL_OPERATOR_UPDATED="EVENT_CHANNEL_OPERATOR_UPDATED",e.EVENT_CHANNEL_MUTED="EVENT_CHANNEL_MUTED",e.EVENT_CHANNEL_UNMUTED="EVENT_CHANNEL_UNMUTED",e.EVENT_CHANNEL_FROZEN="EVENT_CHANNEL_FROZEN",e.EVENT_CHANNEL_UNFROZEN="EVENT_CHANNEL_UNFROZEN",e.EVENT_CHANNEL_HIDDEN="EVENT_CHANNEL_HIDDEN",e.EVENT_CHANNEL_UNHIDDEN="EVENT_CHANNEL_UNHIDDEN",e.EVENT_CHANNEL_RESET_HISTORY="EVENT_CHANNEL_RESET_HISTORY",e.EVENT_CHANNEL_TYPING_STATUS_UPDATE="EVENT_CHANNEL_TYPING_STATUS_UPDATE",e.EVENT_CHANNEL_MEMBER_COUNT_UPDATED="EVENT_CHANNEL_MEMBER_COUNT_UPDATED",e.EVENT_MESSAGE_SENT="EVENT_MESSAGE_SENT",e.EVENT_MESSAGE_RECEIVED="EVENT_MESSAGE_RECEIVED",e.EVENT_MESSAGE_UPDATED="EVENT_MESSAGE_UPDATED",e.REQUEST_CHANNEL="REQUEST_CHANNEL",e.REQUEST_CHANNEL_CHANGELOGS="REQUEST_CHANNEL_CHANGELOGS",e.SYNC_CHANNEL_BACKGROUND="SYNC_CHANNEL_BACKGROUND",e.SYNC_CHANNEL_CHANGELOGS="SYNC_CHANNEL_CHANGELOGS";}(Vt||(Vt={}));var Kt=function(e){return e.startsWith("EVENT_")||e===Vt.SYNC_CHANNEL_BACKGROUND||e===Vt.SYNC_CHANNEL_CHANGELOGS},jt=function(t$1){function n(e){var n=e.channels,r=e.source,s=t$1.call(this)||this;return s.channels=n,s.source=r,s}return t(n,t$1),n}(L),zt=function(t$1){function n(e){var n=e.channelUrls,r=e.source,s=t$1.call(this)||this;return s.channelUrls=n,s.source=r,s}return t(n,t$1),n}(L),Qt=function(){function e(e){var t=e.groupChannelCache,n=e.messageCache,r$1=e.unsentMessageCache,s$1=e.dispatcher,i$1=this;this._observers=new Map,s$1.on((function(e){return r(i$1,void 0,void 0,(function(){var s$1,i$1,a,o,u=this;return i(this,(function(c){switch(c.label){case 0:return e instanceof jt?(s$1=e.channels,o=e.source,i$1=s$1.filter((function(e){return e instanceof Vr})),[4,t.upsert(i$1)]):[3,2];case 1:return c.sent(),this._broadcastUpdateEvent(i$1,o),[3,7];case 2:return e instanceof zt?(a=e.channelUrls,o=e.source,[4,t.remove(a)]):[3,5];case 3:return c.sent(),[4,Se((function(){return r(u,void 0,void 0,(function(){var e,t,s$1,i$1,o,u;return i(this,(function(c){switch(c.label){case 0:c.trys.push([0,6,7,8]),e=s(a),t=e.next(),c.label=1;case 1:return t.done?[3,5]:(s$1=t.value,[4,n.removeMessagesOfChannel(s$1)]);case 2:return c.sent(),[4,r$1.removeMessagesOfChannel(s$1)];case 3:c.sent(),c.label=4;case 4:return t=e.next(),[3,1];case 5:return [3,8];case 6:return i$1=c.sent(),o={error:i$1},[3,8];case 7:try{t&&!t.done&&(u=e.return)&&u.call(e);}finally{if(o)throw o.error}return [7];case 8:return [2]}}))}))}))];case 4:return c.sent(),this._broadcastRemoveEvent(a,o),[3,7];case 5:return e instanceof ve?[4,t.fetch({token:Number.MAX_SAFE_INTEGER,limit:Number.MAX_SAFE_INTEGER})]:[3,7];case 6:c.sent(),c.label=7;case 7:return [2]}}))}))}));}return e.prototype._broadcastUpdateEvent=function(e,t){var n,r;try{for(var s$1=s(this._observers.values()),i=s$1.next();!i.done;i=s$1.next()){i.value.onUpdate(e,t);}}catch(e){n={error:e};}finally{try{i&&!i.done&&(r=s$1.return)&&r.call(s$1);}finally{if(n)throw n.error}}},e.prototype._broadcastRemoveEvent=function(e,t){var n,r;try{for(var s$1=s(this._observers.values()),i=s$1.next();!i.done;i=s$1.next()){i.value.onRemove(e,t);}}catch(e){n={error:e};}finally{try{i&&!i.done&&(r=s$1.return)&&r.call(s$1);}finally{if(n)throw n.error}}},e.prototype.subscribe=function(e,t){this._observers.set(e,t);},e.prototype.unsubscribe=function(e){this._observers.delete(e);},e}(),Wt=function(){function e(e){var t=e.messageCache,n=e.unsentMessageCache,r$1=e.dispatcher,s=e.logger,i$1=this;this._observers=new Map,this._logger=null,this._logger=s,r$1.on((function(e){return r(i$1,void 0,void 0,(function(){var r$1,s,i$1,a,o,u,c=this;return i(this,(function(l){switch(l.label){case 0:return e instanceof un$1?(r$1=e.messages,u=e.source,s=r$1.filter((function(e){return e.messageId>0})),i$1=r$1.filter((function(e){return 0===e.messageId})),s.length>0?[4,Se((function(){return r(c,void 0,void 0,(function(){return i(this,(function(e){switch(e.label){case 0:return [4,t.upsert(s)];case 1:return e.sent(),[4,n.remove(s.map((function(e){return e instanceof xt$1?e.reqId:null})).filter((function(e){return null!==e})))];case 2:return e.sent(),[2]}}))}))}))]:[3,2]):[3,5];case 1:l.sent(),this._broadcastUpdateEvent(s,u),l.label=2;case 2:return i$1.length>0?[4,Se((function(){return r(c,void 0,void 0,(function(){return i(this,(function(e){switch(e.label){case 0:return [4,n.upsert(i$1)];case 1:return e.sent(),[2]}}))}))}))]:[3,4];case 3:l.sent(),this._broadcastUpdateEvent(i$1,u),l.label=4;case 4:return [3,9];case 5:return e instanceof cn$1?(a=e.messageIds,u=e.source,[4,Se((function(){return r(c,void 0,void 0,(function(){return i(this,(function(e){switch(e.label){case 0:return [4,t.remove(a)];case 1:return e.sent(),[2]}}))}))}))]):[3,7];case 6:return l.sent(),this._broadcastRemoveEvent(a,u),[3,9];case 7:return e instanceof ln$1?(o=e.reqId,u=e.source,[4,Se((function(){return r(c,void 0,void 0,(function(){return i(this,(function(e){switch(e.label){case 0:return [4,n.remove([o])];case 1:return e.sent(),[2]}}))}))}))]):[3,9];case 8:l.sent(),this._broadcastRemoveUnsentEvent(o,u),l.label=9;case 9:return [2]}}))}))}));}return e.prototype._broadcastUpdateEvent=function(e,t){var n,r;try{for(var s$1=s(this._observers.values()),i=s$1.next();!i.done;i=s$1.next()){i.value.onUpdate(e,t);}}catch(e){n={error:e};}finally{try{i&&!i.done&&(r=s$1.return)&&r.call(s$1);}finally{if(n)throw n.error}}},e.prototype._broadcastRemoveEvent=function(e,t){var n,r;try{for(var s$1=s(this._observers.values()),i=s$1.next();!i.done;i=s$1.next()){i.value.onRemove(e,t);}}catch(e){n={error:e};}finally{try{i&&!i.done&&(r=s$1.return)&&r.call(s$1);}finally{if(n)throw n.error}}},e.prototype._broadcastRemoveUnsentEvent=function(e,t){var n,r;try{for(var s$1=s(this._observers.values()),i=s$1.next();!i.done;i=s$1.next()){i.value.onRemoveUnsent(e,t);}}catch(e){n={error:e};}finally{try{i&&!i.done&&(r=s$1.return)&&r.call(s$1);}finally{if(n)throw n.error}}},e.prototype.subscribe=function(e,t){this._observers.set(e,t);},e.prototype.unsubscribe=function(e){this._observers.delete(e);},e}(),Yt=function(t$1){function n$1(e){var n$1=e.userId,i=e.ts,a=e.token,o=e.filter,u=t$1.call(this)||this,c=n(n({},Ft),o),l=c.customTypes,h=c.includeEmpty,d$1=c.includeFrozen;return u.method=d.GET,u.path="".concat(Ue$1,"/").concat(encodeURIComponent(n$1),"/my_group_channels/changelogs"),u.params=U({show_delivery_receipt:!0,show_member:!0,show_read_receipt:!0,change_ts:i,token:a,custom_types:l,show_empty:h,show_frozen:d$1}),u}return t(n$1,t$1),n$1}(q),Jt=function(t$1){function n(e,n){var r=t$1.call(this,e,n)||this;return r.updatedChannels=n.updated.map((function(t){return new Vr(e,t)})),r.deletedChannelUrls=n.deleted,r.hasMore=n.has_more,r.token=n.next,r}return t(n,t$1),n}(F),Xt=function(t$1){function n(e){var n=e.channelUrl,r=e.isInternalCall,s=t$1.call(this)||this;return s.method=d.GET,s.path="".concat(r?Fe:qe,"/").concat(encodeURIComponent(n)),s.params={show_member:!0,show_read_receipt:!0,show_delivery_receipt:!0},s}return t(n,t$1),n}(q),Zt=function(t$1){function n(e,n){var r=t$1.call(this,e,n)||this;return r.channel=null,r.channel=new Vr(e,n),r}return t(n,t$1),n}(F),$t=function(t$1){function n(e){var n=this,s=e.userId,i=e.token,a=e.limit,o=e.order,u=e.includeEmpty,c=e.myMemberStateFilter,l=e.superChannelFilter,h=e.publicChannelFilter,d$1=e.unreadChannelFilter,_=e.nicknameContainsFilter,f=e.channelNameContainsFilter,p=e.channelUrlsFilter,m=e.customTypesFilter,v=e.customTypeStartsWithFilter,g=e.hiddenChannelFilter,E=e.metadataOrderKeyFilter,y=e.metadataKey,C=e.metadataValues,N=e.metadataValueStartsWith,b=e.includeFrozen,M=e.includeMetaData,S=e.searchFilter,U$1=e.userIdsFilter;return (n=t$1.call(this)||this).method=d.GET,n.path="".concat(Ue$1,"/").concat(encodeURIComponent(s),"/my_group_channels"),n.params=U({token:i,limit:a,order:o,show_member:!0,show_read_receipt:!0,show_delivery_receipt:!0,show_empty:u,member_state_filter:c,super_mode:l,public_mode:h,unread_filter:d$1,members_nickname_contains:_,name_contains:f,channel_urls:p,custom_types:m,custom_type_startswith:v,hidden_mode:g,metadata_order_key:E,metadata_key:y,metadata_values:C,metadata_value_startswith:N,show_frozen:b,show_metadata:M}),S&&S.query&&S.fields&&(n.params.search_query=S.query,n.params.search_fields=S.fields),U$1&&U$1.userIds&&U$1.userIds.length>0&&(U$1.includeMode?(n.params.members_include_in=U$1.userIds,n.params.query_type=U$1.queryType.toUpperCase()):n.params.members_exactly_in=U$1.userIds),n}return t(n,t$1),n}(q),en=function(t$1){function n(e,n){var r=t$1.call(this,e,n)||this;r.token=null,r.channels=[],r.ts=null;var s=n.next,i=n.channels,a=n.ts;return r.token=s,i&&i.length>0&&(r.channels=i.map((function(t){return t.ts=a,new Vr(e,t)}))),r.ts=null!=a?a:null,r}return t(n,t$1),n}(F),tn=function(t$1){function n(e){var n=e.userId,r=e.filter,s=t$1.call(this)||this,i=r.myMemberStateFilter;return s.method=d.GET,s.path="".concat(Ue$1,"/").concat(encodeURIComponent(n),"/group_channel_count"),s.params={state:null!=i?i:Nt.ALL},s}return t(n,t$1),n}(q),nn=function(t$1){function n(e,n){var r=t$1.call(this,e,n)||this;return r.groupChannelCount=n.group_channel_count,r}return t(n,t$1),n}(F),rn=function(t$1){function n(e){var n=e.userId,r=e.filter,s=t$1.call(this)||this,i=r.keys;return s.method=d.GET,s.path="".concat(Ue$1,"/").concat(encodeURIComponent(n),"/unread_item_count"),s.params={item_keys:i},s}return t(n,t$1),n}(q),sn=function(t$1){function n(e,n){var r=t$1.call(this,e,n)||this;return "number"==typeof n[Dt.GROUP_CHANNEL_UNREAD_MENTION_COUNT]&&(r.groupChannelUnreadMentionCount=n[Dt.GROUP_CHANNEL_UNREAD_MENTION_COUNT]),"number"==typeof n[Dt.GROUP_CHANNEL_UNREAD_MESSAGE_COUNT]&&(r.groupChannelUnreadMessageCount=n[Dt.GROUP_CHANNEL_UNREAD_MESSAGE_COUNT]),"number"==typeof n[Dt.GROUP_CHANNEL_INVITATION_COUNT]&&(r.groupChannelInvitationCount=n[Dt.GROUP_CHANNEL_INVITATION_COUNT]),"number"==typeof n[Dt.SUPER_UNREAD_MENTION_COUNT]&&(r.superGroupChannelUnreadMentionCount=n[Dt.SUPER_UNREAD_MENTION_COUNT]),"number"==typeof n[Dt.SUPER_UNREAD_MESSAGE_COUNT]&&(r.superGroupChannelUnreadMessageCount=n[Dt.SUPER_UNREAD_MESSAGE_COUNT]),"number"==typeof n[Dt.SUPER_INVITATION_COUNT]&&(r.superGroupChannelInvitationCount=n[Dt.SUPER_INVITATION_COUNT]),"number"==typeof n[Dt.NONSUPER_UNREAD_MENTION_COUNT]&&(r.nonSuperGroupChannelUnreadMentionCount=n[Dt.NONSUPER_UNREAD_MENTION_COUNT]),"number"==typeof n[Dt.NONSUPER_UNREAD_MESSAGE_COUNT]&&(r.nonSuperGroupChannelUnreadMessageCount=n[Dt.NONSUPER_UNREAD_MESSAGE_COUNT]),"number"==typeof n[Dt.NONSUPER_INVITATION_COUNT]&&(r.nonSuperGroupChannelInvitationCount=n[Dt.NONSUPER_INVITATION_COUNT]),r}return t(n,t$1),n}(F),an=function(t$1){function n(e){var n=e.userId,r=t$1.call(this)||this;return r.method=d.GET,r.path="".concat(Ue$1,"/").concat(encodeURIComponent(n),"/unread_channel_count"),r}return t(n,t$1),n}(q),on=function(t$1){function n(e,n){var r=t$1.call(this,e,n)||this;return r.unreadCount=n.unread_count,r}return t(n,t$1),n}(F),un=function(t$1){function n(e){var n=e.userId,r=e.filter,s=t$1.call(this)||this,i=r.channelCustomTypesFilter,a=r.superChannelFilter;return s.method=d.GET,s.path="".concat(Ue$1,"/").concat(encodeURIComponent(n),"/unread_message_count"),s.params={super_mode:null!=a?a:bt.ALL,custom_types:i},s}return t(n,t$1),n}(q),cn=function(t$1){function n(e,n){var r=t$1.call(this,e,n)||this;return r.unreadCount=n.unread_count,r}return t(n,t$1),n}(F),ln=function(t$1){function n(e){var n=e.channelUrl,r=e.scheduledStatus,s=e.messageTypeFilter,i=t$1.call(this)||this;return i.method=d.GET,i.path="".concat(Ve,"/count"),i.params={channel_url:n,status:dn(r)},s&&(i.params.message_type=s),i}return t(n,t$1),n}(q),hn=function(t$1){function n(e,n){var r=t$1.call(this,e,n)||this;return r.count=n.count,r}return t(n,t$1),n}(F),dn=function(e){if(e){var t=[];e.forEach((function(e){switch(e){case Ct$1.PENDING:t.push(Ot$1.PENDING);break;case Ct$1.SENT:t.push(Ot$1.IN_QUEUE),t.push(Ot$1.SENT);break;case Ct$1.CANCELED:t.push(Ot$1.CANCELED);break;case Ct$1.FAILED:t.push(Ot$1.FAILED);}}));}},_n=function(t$1){function n(e){var n=this,s=e.userId,i=e.channelUrl,a$1=e.coverUrl,o$1=e.coverImage,u=e.isDistinct,c=e.isSuper,d$1=e.isBroadcast,_=e.isPublic,f=e.isExclusive,p=e.isDiscoverable,m=e.isStrict,v=e.isEphemeral,g=e.accessCode,E=e.name,y=e.data,C=e.customType,N=e.messageSurvivalSeconds,b=e.invitedUserIds,M=e.operatorUserIds;return (n=t$1.call(this)||this).method=d.POST,n.path=qe,n.params=U({user_ids:a([s],o(null!=b?b:[]),!1).filter((function(e,t,n){return t===n.indexOf(e)})),channel_url:i,cover_url:a$1,cover_file:o$1,is_distinct:u,is_super:c,is_broadcast:d$1,is_exclusive:f,is_public:_,is_discoverable:p,strict:m,is_ephemeral:v,access_code:g,name:E,data:y,custom_type:C,operator_ids:M,message_survival_seconds:N}),n}return t(n,t$1),n}(q),fn=function(t$1){function n(e,n){var r=t$1.call(this,e,n)||this;return r.channel=new Vr(e,n),r.isCreated=n.is_created,r}return t(n,t$1),n}(F),pn=function(t$1){function n(e){var n=e.userId,r=e.channelUrls,s=t$1.call(this)||this;return s.method=d.PUT,s.path="".concat(Ue$1,"/").concat(encodeURIComponent(n),"/mark_as_read_all"),s.params={channel_urls:r},s}return t(n,t$1),n}(q);!function(t$1){function n(){return null!==t$1&&t$1.apply(this,arguments)||this}t(n,t$1);}(F);var mn=function(t$1){function n(e){var n=this,r=e.channelUrl,s=e.userId,i=e.accessCode;return (n=t$1.call(this)||this).method=d.PUT,n.path="".concat(qe,"/").concat(encodeURIComponent(r),"/join"),n.params={user_id:s,access_code:i},n}return t(n,t$1),n}(q),vn=function(t$1){function n(e,n){var r=t$1.call(this,e,n)||this;return r.channel=new Vr(e,n),r}return t(n,t$1),n}(F),gn=function(t$1){function n(e,n,r){var s=t$1.call(this,e,n,r)||this,i=r.data,a=i.member_count,o=void 0===a?null:a,u=i.joined_member_count,c=void 0===u?null:u,l=i.users,h=void 0===l?null:l;return s.memberCount=o,s.joinedMemberCount=c,s.members=Array.isArray(h)?h.map((function(t){return new It(e,t)})):[new It(e,r.data)],s}return t(n,t$1),n}(C),En=function(t$1){function n(e){var n=this,r=e.channelUrl,s=e.userId,i=e.shouldRemoveOperatorStatus;return (n=t$1.call(this)||this).method=d.PUT,n.path="".concat(qe,"/").concat(encodeURIComponent(r),"/leave"),n.params={user_id:s,should_remove_operator_status:i},n}return t(n,t$1),n}(q);!function(t$1){function n(e,n){return t$1.call(this,e,n)||this}t(n,t$1);}(F);var yn=function(t$1){function n(e,n,r){var s=t$1.call(this,e,n,r)||this,i=r.data,a=i.member_count,o=void 0===a?null:a,u=i.joined_member_count,c=void 0===u?null:u;return s.memberCount=o,s.joinedMemberCount=c,s.member=new It(s._iid,r.data),s}return t(n,t$1),n}(C),Cn=function(t$1){function n(e){var n=this,r=e.channelUrl,s=e.userIds;return (n=t$1.call(this)||this).method=d.POST,n.path="".concat(qe,"/").concat(encodeURIComponent(r),"/invite"),n.params={user_ids:s},n}return t(n,t$1),n}(q),Nn=function(t$1){function n(e,n){var r=t$1.call(this,e,n)||this;return r.channel=new Vr(e,n),r}return t(n,t$1),n}(F),bn=function(t$1){function n(e,n,r){var s=t$1.call(this,e,n,r)||this,i=r.data,o=i.member_count,u=void 0===o?null:o,c=i.joined_member_count,l=void 0===c?null:c,h=i.inviter,d=void 0===h?null:h,_=i.invitees,f=void 0===_?[]:_;return s.memberCount=u,s.joinedMemberCount=l,s.inviter=d?new ct(e,d):null,s.invitees=f.map((function(t){return new It(e,t)})),s}return t(n,t$1),n}(C),Mn=function(t$1){function n(e){var n=this,r=e.channelUrl,s=e.userId;return (n=t$1.call(this)||this).method=d.PUT,n.path="".concat(qe,"/").concat(encodeURIComponent(r),"/decline"),n.params={user_id:s},n}return t(n,t$1),n}(q),Sn=function(t$1){function n(e,n){var r=t$1.call(this,e,n)||this;return r.channel=new Vr(e,n),r.channel.myMemberState=yt.NONE,r}return t(n,t$1),n}(F),An=function(t$1){function n(e,n,r){var s=t$1.call(this,e,n,r)||this,i=r.data,o=i.member_count,u=void 0===o?null:o,c=i.joined_member_count,l=void 0===c?null:c,h=i.inviter,d=void 0===h?null:h,_=i.invitee,f=void 0===_?null:_;return s.memberCount=u,s.joinedMemberCount=l,s.inviter=d?new ct(e,d):null,s.invitee=f?new It(e,f):null,s}return t(n,t$1),n}(C),Tn=function(t$1){function n(e){var n=e.channelUrl;return t$1.call(this,{code:"READ",ackRequired:!0,payload:{channel_url:n}})||this}return t(n,t$1),n}(H),Un=function(t$1){function n(e,n,r){var s=t$1.call(this,e,"READ",r)||this;return s.readStatus=new wt(e,r),s}return t(n,t$1),n}(B),In=function(t$1){function n(e){var n=e.channelUrl,s=e.userId,i=t$1.call(this)||this;return (i=t$1.call(this)||this).method=d.PUT,i.path="".concat(qe,"/").concat(encodeURIComponent(n),"/messages/mark_as_delivered"),i.params=U({userId:s}),i}return t(n,t$1),n}(q);!function(t$1){function n(){return null!==t$1&&t$1.apply(this,arguments)||this}t(n,t$1);}(F);var wn,Dn=function(t$1){function n(e,n,r){var s=t$1.call(this,e,"DLVR",r)||this;return s.channelUrl=r.channel_url,s.deliveredStateUpdate=r.updated,s}return t(n,t$1),n}(B),Ln=function(t$1){function n(e){var n=this,r=e.channelUrl,s=e.userId,i=e.hidePreviousMessages,a=e.allowAutoUnhide;return (n=t$1.call(this)||this).method=d.PUT,n.path="".concat(qe,"/").concat(encodeURIComponent(r),"/hide"),n.params={user_id:s,hide_previous_messages:i,allow_auto_unhide:a},n}return t(n,t$1),n}(q),Rn=function(t$1){function n(e,n){var r=t$1.call(this,e,n)||this;r.messageOffsetTimestamp=null;var s=n.ts_message_offset;return r.messageOffsetTimestamp=null!=s?s:null,r}return t(n,t$1),n}(F),On=function(t$1){function n(e,n,r){var s=t$1.call(this,e,"SYEV",r)||this;return s.allowAutoUnhide=null,s.hidePreviousMessages=null,s.messageOffsetTimestamp=null,r.data&&(s.allowAutoUnhide=r.data.allow_auto_unhide,s.hidePreviousMessages=r.data.hide_previous_messages),s.messageOffsetTimestamp=r.ts_message_offset,s}return t(n,t$1),n}(B),kn=function(t$1){function n(e){var n=e.channelUrl,r=e.time;return t$1.call(this,{code:"TPST",ackRequired:!1,payload:{channel_url:n,time:r}})||this}return t(n,t$1),n}(H),Fn=function(t$1){function n(e,n,r){var s=t$1.call(this,e,"SYEV",r)||this;return s.user=new ct(e,r.data),s}return t(n,t$1),n}(B),Pn=function(t$1){function n(e){var n=e.channelUrl,r=e.time;return t$1.call(this,{code:"TPEN",ackRequired:!1,payload:{channel_url:n,time:r}})||this}return t(n,t$1),n}(H),xn=function(t$1){function n(e,n,r){var s=t$1.call(this,e,"SYEV",r)||this;return s.user=new ct(e,r.data),s}return t(n,t$1),n}(B),Hn=function(t$1){function n(e){var n=e.channelUrl,r=e.messageId;return t$1.call(this,{code:"MACK",ackRequired:!1,payload:{channel_url:n,msg_id:r}})||this}return t(n,t$1),n}(H),Vn=function(n){function r$1(e,t){var r,s,i,a,o,u,c,l,h,d,_,f,p,m,v,g,E,y,C,N,b=this;return (b=n.call(this,e,t)||this).includeEmpty=!1,b.includeFrozen=!0,b.includeMetaData=!0,b.channelUrlsFilter=null,b.customTypesFilter=null,b.customTypeStartsWithFilter=null,b.nicknameContainsFilter="",b.channelNameContainsFilter="",b.myMemberStateFilter=Nt.ALL,b.unreadChannelFilter=Mt.ALL,b.superChannelFilter=bt.ALL,b.publicChannelFilter=Ct.ALL,b.hiddenChannelFilter=St.UNHIDDEN,b.searchFilter={fields:[],query:null},b.userIdsFilter={userIds:[],includeMode:!0,queryType:Tt.AND},b.metadataKey=null,b.metadataValues=null,b.metadataOrderKeyFilter=null,b.metadataValueStartsWith=null,b.order=K.LATEST_LAST_MESSAGE,b.includeEmpty=null!==(r=t.includeEmpty)&&void 0!==r&&r,b.includeFrozen=null===(s=t.includeFrozen)||void 0===s||s,b.includeMetaData=null===(i=t.includeMetaData)||void 0===i||i,b.channelUrlsFilter=null!==(a=t.channelUrlsFilter)&&void 0!==a?a:null,b.customTypesFilter=null!==(o=t.customTypesFilter)&&void 0!==o?o:null,b.customTypeStartsWithFilter=null!==(u=t.customTypeStartsWithFilter)&&void 0!==u?u:"",b.nicknameContainsFilter=null!==(c=t.nicknameContainsFilter)&&void 0!==c?c:"",b.channelNameContainsFilter=null!==(l=t.channelNameContainsFilter)&&void 0!==l?l:"",b.myMemberStateFilter=null!==(h=t.myMemberStateFilter)&&void 0!==h?h:Nt.ALL,b.unreadChannelFilter=null!==(d=t.unreadChannelFilter)&&void 0!==d?d:Mt.ALL,b.superChannelFilter=null!==(_=t.superChannelFilter)&&void 0!==_?_:bt.ALL,b.publicChannelFilter=null!==(f=t.publicChannelFilter)&&void 0!==f?f:Ct.ALL,b.hiddenChannelFilter=null!==(p=t.hiddenChannelFilter)&&void 0!==p?p:St.UNHIDDEN,b.searchFilter=null!==(m=t.searchFilter)&&void 0!==m?m:{fields:[],query:null},b.userIdsFilter=null!==(v=t.userIdsFilter)&&void 0!==v?v:{userIds:[],includeMode:!0,queryType:Tt.AND},b.metadataKey=null!==(g=t.metadataKey)&&void 0!==g?g:null,b.metadataValues=null!==(E=t.metadataValues)&&void 0!==E?E:null,b.metadataOrderKeyFilter=null!==(y=t.metadataOrderKeyFilter)&&void 0!==y?y:null,b.metadataValueStartsWith=null!==(C=t.metadataValueStartsWith)&&void 0!==C?C:null,b.order=null!==(N=t.order)&&void 0!==N?N:K.LATEST_LAST_MESSAGE,b}return t(r$1,n),r$1.prototype._validate=function(){return n.prototype._validate.call(this)&&y("boolean",this.includeEmpty)&&y("boolean",this.includeFrozen)&&y("boolean",this.includeMetaData)&&y("string",this.channelNameContainsFilter)&&E("string",this.channelUrlsFilter,!0)&&E("string",this.customTypesFilter,!0)&&y("string",this.customTypeStartsWithFilter)&&y("string",this.nicknameContainsFilter)&&m(Nt,this.myMemberStateFilter)&&m(bt,this.superChannelFilter)&&m(Ct,this.publicChannelFilter)&&m(Mt,this.unreadChannelFilter)&&m(St,this.hiddenChannelFilter)&&E(Ut,this.searchFilter.fields)&&y("string",this.searchFilter.query,!0)&&E("string",this.userIdsFilter.userIds)&&y("boolean",this.userIdsFilter.includeMode)&&m(Tt,this.userIdsFilter.queryType)&&m(K,this.order)&&y("string",this.metadataOrderKeyFilter,!0)&&y("string",this.metadataKey,!0)&&E("string",this.metadataValues,!0)&&y("string",this.metadataValueStartsWith,!0)},r$1.prototype.serialize=function(){return st(this)},r$1.prototype.next=function(){return r(this,void 0,void 0,(function(){var e,t,n;return i(this,(function(r){switch(r.label){case 0:return this._validate()?this._isLoading?[3,3]:this._hasNext?(this._isLoading=!0,[4,Bn.of(this._iid).getMyGroupChannels(this._token,this,this.limit)]):[3,2]:[3,5];case 1:return e=r.sent(),t=e.channels,n=e.token,this._token=n,this._hasNext=!!n,this._isLoading=!1,[2,t];case 2:return [2,[]];case 3:throw p.queryInProgress;case 4:return [3,6];case 5:throw p.invalidParameters;case 6:return [2]}}))}))},r$1}(bn$1),Gn=function(){function e(e){var t=e.top,n=void 0===t?Number.MAX_SAFE_INTEGER:t,r=e.bottom,s=void 0===r?0:r;this.top=n,this.bottom=s;}return e.prototype.includes=function(){for(var e=this,t=[],n=0;n<arguments.length;n++)t[n]=arguments[n];return t.every((function(t){return e.top<=t&&t<=e.bottom}))},e.prototype.overlap=function(e){return this.includes(e.top)||this.includes(e.bottom)},e.prototype.extends=function(){for(var e=[],t=0;t<arguments.length;t++)e[t]=arguments[t];this.top=Math.min.apply(Math,a([this.top],o(e),!1)),this.bottom=Math.max.apply(Math,a([this.bottom],o(e),!1));},e}(),qn={},Bn=function(){function e(e,t){var n=t.sdkState,r$1=t.cacheContext,s$1=t.dispatcher,i$1=t.sessionManager,a=t.requestQueue,o=t.logger,u=this;this._leftChannels=new Map,this._markAsReadAllLastSentAt=0,this._iid=e,this._sdkState=n,this._sessionManager=i$1,this._requestQueue=a,this._dispatcher=s$1,this._logger=o,this._groupChannelHandlers=new Map,this._groupChannelCache=new Rt(this._iid,{sdkState:n,cacheContext:r$1}),this._unsentMessageCache=new ue(this._iid,{sdkState:n,cacheContext:r$1}),this._messageCache=new he(this._iid,{sdkState:n,cacheContext:r$1,unsentMessageCache:this._unsentMessageCache}),this._groupChannelBroadcast=new Qt({groupChannelCache:this._groupChannelCache,messageCache:this._messageCache,unsentMessageCache:this._unsentMessageCache,dispatcher:s$1}),this._messageBroadcast=new Wt({messageCache:this._messageCache,unsentMessageCache:this._unsentMessageCache,dispatcher:s$1,logger:o}),setInterval((function(){var e,t,n=function(e){e.invalidateTypingStatus()&&(u._dispatcher.dispatch(new jt({channels:[e],source:Vt.EVENT_CHANNEL_TYPING_STATUS_UPDATE})),u._groupChannelHandlers.forEach((function(t){t.onTypingStatusUpdated(e);})));};try{for(var r=s(u._groupChannelCache.channels),s$1=r.next();!s$1.done;s$1=r.next()){n(s$1.value);}}catch(t){e={error:t};}finally{try{s$1&&!s$1.done&&(t=r.return)&&t.call(r);}finally{if(e)throw e.error}}}),1e3),this._dispatcher.on((function(e){e instanceof B?u._handleEvent(e):e instanceof fe&&r(u,void 0,void 0,(function(){var t,n;return i(this,(function(r){switch(r.label){case 0:return t=e.message,[4,this.getChannel(t.channelUrl,!0)];case 1:return n=r.sent(),t instanceof Vt$1?n._autoResendUserMessage(t):t instanceof Wt$1&&n._autoResendFileMessage(t),[2]}}))}));})),qn[e]=this;}return e.of=function(e){return qn[e]},Object.defineProperty(e.prototype,"handlers",{get:function(){return a([],o(this._groupChannelHandlers.values()),!1)},enumerable:!1,configurable:!0}),e.prototype.buildGroupChannelFromSerializedData=function(e){var t=ot(e);return new Vr(this._iid,Vr.payloadify(t))},e.prototype.buildGroupChannelListQueryFromSerializedData=function(e){var t=ot(e);return new Vn(this._iid,t)},e.prototype.buildMemberFromSerializedData=function(e){var t=ot(e);return new It(this._iid,It.payloadify(t))},e.prototype.getChannelFromCache=function(e){return r(this,void 0,void 0,(function(){return i(this,(function(t){switch(t.label){case 0:return [4,this._groupChannelCache.get(e)];case 1:return [2,t.sent()]}}))}))},e.prototype.getChannelsFromCache=function(e,t,n){return r(this,void 0,void 0,(function(){return i(this,(function(r){switch(r.label){case 0:return [4,this._groupChannelCache.fetch({token:e,filter:t,order:n})];case 1:return [2,r.sent()]}}))}))},e.prototype._handleEvent=function(e){return r(this,void 0,void 0,(function(){var t,r$1,s$1,a,o,u,c$1,l,h$2,p,m,v,g,E,y,N,A$1,T,U,I,w,D,L,R,O,k,F,P,x,H,G,q,B,z,Y,J,X,Z,$,ee,te$1,ne,re,se,ie,ae,oe,ue,ce,le,he,de,_e,fe,pe,me,ve,ge,Ee,ye,Ce,Ne,be$1,Me,Se$1,Ae,Te,Ue,Le,Re,Oe,ke,Fe,Pe,xe,He,Ve,Ge,qe,Be,Ke,je$1,ze,st,it,at,ot,ut,ct,lt,Et,Ct,Nt,bt,Mt,St,At,Tt,Ut,It,wt,Dt,Lt,Rt,Ot,kt,Ft,Pt,xt,Ht,Gt,qt,Bt,Kt,Qt,Wt,Yt,Jt,Xt,Zt,$t,en,tn=this;return i(this,(function(nn){switch(nn.label){case 0:switch(nn.trys.push([0,72,,73]),e.code){case"MESG":case"FILE":case"ADMM":case"BRDM":return [3,1];case"MEDI":case"FEDI":case"AEDI":return [3,4];case"DELM":return [3,7];case"READ":return [3,10];case"DLVR":return [3,13];case"MRCT":return [3,15];case"MTHD":return [3,19];case"MCNT":return [3,23];case"SYEV":return [3,32];case"USEV":return [3,70]}return [3,71];case 1:return l=null,"MESG"===e.code?l=e.as(gt):"FILE"===e.code?l=e.as(Jt$1):"ADMM"!==e.code&&"BRDM"!=e.code||(l=e.as(A)),l?(t=l.message,r$1=l.isMentioned,s$1=l.forceUpdateLastMessage,t.channelType!==ne$1.GROUP?[3,3]:(Se((function(){return r(tn,void 0,void 0,(function(){var e;return i(this,(function(n){return e=new Hn(t),this._requestQueue.send(e),[2]}))}))})),L=this._groupChannelCache.isCachedInMemory(t.channelUrl),v=t instanceof xt$1&&t.sender.userId===this._sdkState.userId,[4,this.getChannel(t.channelUrl,!0)])):[3,3];case 2:if((a=nn.sent()).hiddenState=Fr.UNHIDDEN,t instanceof xt$1){o=St$1.of(this._iid).useMemberInfoInMessage;try{for(u=s(a.members),c$1=u.next();!c$1.done;c$1=u.next())if((Be=c$1.value).userId===t.sender.userId){o?(t.sender.nickname=Be.nickname,t.sender.plainProfileUrl=Be.plainProfileUrl,t.sender.metaData=Be.metaData,t.sender.isBlockedByMe=Be.isBlockedByMe):(Be.nickname=t.sender.nickname,Be.plainProfileUrl=t.sender.plainProfileUrl,Be.metaData=t.sender.metaData,Be.isBlockedByMe=t.sender.isBlockedByMe);break}}catch(e){Bt={error:e};}finally{try{c$1&&!c$1.done&&(Kt=u.return)&&Kt.call(u);}finally{if(Bt)throw Bt.error}}o&&r$1&&t.mentionedUsers.forEach((function(e){var t,n;try{for(var r=s(a.members),s$1=r.next();!s$1.done;s$1=r.next()){var i=s$1.value;if(e.userId===i.userId){e.nickname=i.nickname,e.plainProfileUrl=i.plainProfileUrl,e.metaData=i.metaData;break}}}catch(e){t={error:e};}finally{try{s$1&&!s$1.done&&(n=r.return)&&n.call(r);}finally{if(t)throw t.error}}})),v&&(E=this._sessionManager.currentUser)&&(E.nickname=t.sender.nickname,E.plainProfileUrl=t.sender.plainProfileUrl,E.metaData=t.sender.metaData);}t.silent&&!v||(a.isEphemeral||L)&&((!a.lastMessage||a.lastMessage.createdAt<t.createdAt)&&(a.lastMessage=t),v||a._updateUnreadCount(a.unreadMessageCount+1,a.unreadMentionCount+(r$1?1:0))),s$1&&(!a.lastMessage||a.lastMessage.createdAt<t.createdAt)&&(a.lastMessage=t),this._dispatcher.dispatch(new jt({channels:[a],source:Vt.EVENT_MESSAGE_RECEIVED})),t.silent&&!v||Ie((function(){return r(tn,void 0,void 0,(function(){var e,t,n,r;return i(this,(function(s$1){try{for(e=s(this._groupChannelHandlers.values()),t=e.next();!t.done;t=e.next())t.value.onChannelChanged(a);}catch(e){n={error:e};}finally{try{t&&!t.done&&(r=e.return)&&r.call(e);}finally{if(n)throw n.error}}return [2]}))}))})),this._dispatcher.dispatch(new un$1({messages:[t],source:$t$1.EVENT_MESSAGE_RECEIVED})),Ie((function(){return r(tn,void 0,void 0,(function(){var e,n,s$1,i$1,o;return i(this,(function(u){try{for(e=s(this._groupChannelHandlers.values()),n=e.next();!n.done;n=e.next())(s$1=n.value).onMessageReceived(a,t),r$1&&s$1.onMentionReceived(a,t);}catch(e){i$1={error:e};}finally{try{n&&!n.done&&(o=e.return)&&o.call(e);}finally{if(i$1)throw i$1.error}}return [2]}))}))})),nn.label=3;case 3:return [3,71];case 4:return l=null,"MEDI"===e.code?l=e.as(Tt$2):"FEDI"===e.code?l=e.as(It$1):"AEDI"===e.code&&(l=e.as(c)),l?(h$2=l.message,p=l.mentionCountChange,h$2.channelType!==ne$1.GROUP?[3,6]:(L=this._groupChannelCache.isCachedInMemory(h$2.channelUrl),[4,this.getChannel(h$2.channelUrl,!0)])):[3,6];case 5:m=nn.sent(),v=h$2 instanceof xt$1&&h$2.sender.userId===this._sdkState.userId,g=!1,v?(E=this._sessionManager.currentUser)&&(E.nickname=h$2.sender.nickname,E.plainProfileUrl=h$2.sender.plainProfileUrl,E.metaData=h$2.sender.metaData):m.isReadMessage(h$2)&&0!==p&&!h$2.silent&&L&&(m._updateUnreadCount(m.unreadMessageCount,m.unreadMentionCount+p),g=!0),!m.lastMessage||m.lastMessage.createdAt<h$2.createdAt?(m.lastMessage=h$2,g=!0):m.lastMessage.isIdentical(h$2)&&(L?m.lastMessage.updatedAt<h$2.updatedAt&&(m.lastMessage=h$2,g=!0):g=!0),g&&(this._dispatcher.dispatch(new jt({channels:[m],source:Vt.EVENT_MESSAGE_UPDATED})),h$2.silent&&!v||Ie((function(){return r(tn,void 0,void 0,(function(){var e,t,n,r;return i(this,(function(s$1){try{for(e=s(this._groupChannelHandlers.values()),t=e.next();!t.done;t=e.next())t.value.onChannelChanged(m);}catch(e){n={error:e};}finally{try{t&&!t.done&&(r=e.return)&&r.call(e);}finally{if(n)throw n.error}}return [2]}))}))}))),this._dispatcher.dispatch(new un$1({messages:[h$2],source:$t$1.EVENT_MESSAGE_UPDATED})),Ie((function(){return r(tn,void 0,void 0,(function(){var e,t,n,r,s$1;return i(this,(function(i){try{for(e=s(this._groupChannelHandlers.values()),t=e.next();!t.done;t=e.next())(n=t.value).onMessageUpdated(m,h$2),0!==p&&n.onMentionReceived(m,h$2);}catch(e){r={error:e};}finally{try{t&&!t.done&&(s$1=e.return)&&s$1.call(e);}finally{if(r)throw r.error}}return [2]}))}))})),nn.label=6;case 6:return [3,71];case 7:return y=e.as(wt$1),Z=y.channelUrl,F=y.channelType,N=y.messageId,F!==ne$1.GROUP?[3,9]:[4,this.getChannel(Z,!0)];case 8:A$1=nn.sent(),this._dispatcher.dispatch(new cn$1({messageIds:[N],source:$t$1.EVENT_MESSAGE_DELETED})),Ie((function(){return r(tn,void 0,void 0,(function(){var e,t,n,r;return i(this,(function(s$1){try{for(e=s(this._groupChannelHandlers.values()),t=e.next();!t.done;t=e.next())t.value.onMessageDeleted(A$1,N);}catch(e){n={error:e};}finally{try{t&&!t.done&&(r=e.return)&&r.call(e);}finally{if(n)throw n.error}}return [2]}))}))})),nn.label=9;case 9:return [3,71];case 10:return (T=e.as(Un).readStatus).channelType!==ne$1.GROUP?[3,12]:(L=this._groupChannelCache.isCachedInMemory(T.channelUrl),[4,this.getChannel(T.channelUrl,!0)]);case 11:U=nn.sent(),L&&U._updateUnreadMemberState(T.reader.userId,T.readAt),T.reader.userId===this._sdkState.userId?L?(U.unreadMessageCount>0||U.unreadMentionCount>0)&&(U._updateUnreadCount(0,0),this._dispatcher.dispatch(new jt({channels:[U],source:Vt.EVENT_CHANNEL_READ})),Ie((function(){return r(tn,void 0,void 0,(function(){var e,t,n,r;return i(this,(function(s$1){try{for(e=s(this._groupChannelHandlers.values()),t=e.next();!t.done;t=e.next())t.value.onChannelChanged(U);}catch(e){n={error:e};}finally{try{t&&!t.done&&(r=e.return)&&r.call(e);}finally{if(n)throw n.error}}return [2]}))}))}))):0!==U.unreadMessageCount&&0!==U.unreadMentionCount||(this._dispatcher.dispatch(new jt({channels:[U],source:Vt.EVENT_CHANNEL_READ})),Ie((function(){return r(tn,void 0,void 0,(function(){var e,t,n,r;return i(this,(function(s$1){try{for(e=s(this._groupChannelHandlers.values()),t=e.next();!t.done;t=e.next())t.value.onChannelChanged(U);}catch(e){n={error:e};}finally{try{t&&!t.done&&(r=e.return)&&r.call(e);}finally{if(n)throw n.error}}return [2]}))}))}))):(this._dispatcher.dispatch(new jt({channels:[U],source:Vt.EVENT_CHANNEL_READ})),Ie((function(){return r(tn,void 0,void 0,(function(){var e,t,n,r;return i(this,(function(s$1){try{for(e=s(this._groupChannelHandlers.values()),t=e.next();!t.done;t=e.next())t.value.onUnreadMemberStatusUpdated(U);}catch(e){n={error:e};}finally{try{t&&!t.done&&(r=e.return)&&r.call(e);}finally{if(n)throw n.error}}return [2]}))}))}))),nn.label=12;case 12:return [3,71];case 13:return I=e.as(Dn),Z=I.channelUrl,w=I.deliveredStateUpdate,D=void 0===w?{}:w,L=this._groupChannelCache.isCachedInMemory(Z),[4,this.getChannel(Z,!0)];case 14:if(R=nn.sent(),L)for(O in D)R._updateUndeliveredMemberState(O,D[O]);return this._dispatcher.dispatch(new jt({channels:[R],source:Vt.EVENT_CHANNEL_DELIVERED})),Object.keys(D).some((function(e){return e!==tn._sdkState.userId}))&&Ie((function(){return r(tn,void 0,void 0,(function(){var e,t,n,r;return i(this,(function(s$1){try{for(e=s(this._groupChannelHandlers.values()),t=e.next();!t.done;t=e.next())t.value.onUndeliveredMemberStatusUpdated(R);}catch(e){n={error:e};}finally{try{t&&!t.done&&(r=e.return)&&r.call(e);}finally{if(n)throw n.error}}return [2]}))}))})),[3,71];case 15:return k=e.as(H$2),Z=k.channelUrl,F=k.channelType,P=k.event,F!==ne$1.GROUP?[3,18]:[4,this.getChannel(Z,!0)];case 16:return x=nn.sent(),[4,this.getMessageFromCache(P.messageId)];case 17:(q=nn.sent())&&(q.applyReactionEvent(P),this._dispatcher.dispatch(new un$1({messages:[q],source:$t$1.EVENT_MESSAGE_REACTION_UPDATED}))),Ie((function(){return r(tn,void 0,void 0,(function(){var e,t,n,r;return i(this,(function(s$1){try{for(e=s(this._groupChannelHandlers.values()),t=e.next();!t.done;t=e.next())t.value.onReactionUpdated(x,P);}catch(e){n={error:e};}finally{try{t&&!t.done&&(r=e.return)&&r.call(e);}finally{if(n)throw n.error}}return [2]}))}))})),nn.label=18;case 18:return [3,71];case 19:return (H=e.as(T$1).event).channelType!==ne$1.GROUP?[3,22]:[4,this.getChannel(H.channelUrl,!0)];case 20:return G=nn.sent(),[4,this.getMessageFromCache(H.targetMessageId)];case 21:(q=nn.sent())&&(q.applyThreadInfoUpdateEvent(H),this._dispatcher.dispatch(new un$1({messages:[q],source:$t$1.EVENT_MESSAGE_THREADINFO_UPDATED}))),Ie((function(){return r(tn,void 0,void 0,(function(){var e,t,n,r;return i(this,(function(s$1){try{for(e=s(this._groupChannelHandlers.values()),t=e.next();!t.done;t=e.next())t.value.onThreadInfoUpdated(G,H);}catch(e){n={error:e};}finally{try{t&&!t.done&&(r=e.return)&&r.call(e);}finally{if(n)throw n.error}}return [2]}))}))})),nn.label=22;case 22:return [3,71];case 23:B=e.as(h$1).groupChannelMemberCounts,z=[],nn.label=24;case 24:nn.trys.push([24,29,30,31]),Y=s(B),J=Y.next(),nn.label=25;case 25:return J.done?[3,28]:(X=J.value,Z=X.channelUrl,Ue=X.memberCount,Le=X.joinedMemberCount,$=X.updatedAt,[4,this.getChannelFromCache(Z)]);case 26:(ee=nn.sent())&&ee._setLatestMemberCount(Ue,Le,$)&&z.push(ee),nn.label=27;case 27:return J=Y.next(),[3,25];case 28:return [3,31];case 29:return te$1=nn.sent(),Qt={error:te$1},[3,31];case 30:try{J&&!J.done&&(Wt=Y.return)&&Wt.call(Y);}finally{if(Qt)throw Qt.error}return [7];case 31:return z.length>0&&(this._dispatcher.dispatch(new jt({channels:z,source:Vt.EVENT_CHANNEL_MEMBER_COUNT_UPDATED})),Ie((function(){return r(tn,void 0,void 0,(function(){var e,t,n,r;return i(this,(function(s$1){try{for(e=s(this._groupChannelHandlers.values()),t=e.next();!t.done;t=e.next())t.value.onChannelMemberCountChanged(z);}catch(e){n={error:e};}finally{try{t&&!t.done&&(r=e.return)&&r.call(e);}finally{if(n)throw n.error}}return [2]}))}))}))),[3,71];case 32:if(!(ne=e.as(C).event).isGroupChannelEvent)return [3,69];switch(ne.category){case _.CHANNEL_JOIN:return [3,33];case _.CHANNEL_LEAVE:return [3,35];case _.CHANNEL_OPERATOR_UPDATE:return [3,39];case _.CHANNEL_INVITE:return [3,41];case _.CHANNEL_DECLINE_INVITE:return [3,43];case _.TYPING_START:case _.TYPING_END:return [3,45];case _.USER_CHANNEL_MUTE:case _.USER_CHANNEL_UNMUTE:return [3,47];case _.USER_CHANNEL_BAN:return [3,49];case _.USER_CHANNEL_UNBAN:return [3,53];case _.CHANNEL_FREEZE:case _.CHANNEL_UNFREEZE:return [3,55];case _.CHANNEL_HIDE:return [3,57];case _.CHANNEL_UNHIDE:return [3,59];case _.CHANNEL_DELETED:return [3,61];case _.CHANNEL_PROP_CHANGED:return [3,63];case _.CHANNEL_META_DATA_CHANGED:return [3,65];case _.CHANNEL_META_COUNTERS_CHANGED:return [3,67]}return [3,69];case 33:return [4,this.getChannel(ne.channelUrl,!0)];case 34:return re=nn.sent(),se=e.as(gn),ie=se.memberCount,ae=se.joinedMemberCount,oe=se.members,ue=!1,oe.forEach((function(e){re.isExclusive||re.isSuper||re.isBroadcast?ue=ue||re._setLatestMemberCount(ie,ae,ne.ts):(e.state=yt.JOINED,re.addMember(e,ne.ts),tn._updateJoinedMemberCount(re)),e.userId===tn._sdkState.userId&&(re.myMemberState=yt.JOINED);})),this._dispatcher.dispatch(new jt({channels:[re],source:Vt.EVENT_CHANNEL_JOINED})),Ie((function(){return r(tn,void 0,void 0,(function(){return i(this,(function(e){return this._groupChannelHandlers.forEach((function(e){var t,n;try{for(var r=s(oe),s$1=r.next();!s$1.done;s$1=r.next()){var i=s$1.value;e.onUserJoined(re,i);}}catch(e){t={error:e};}finally{try{s$1&&!s$1.done&&(n=r.return)&&n.call(r);}finally{if(t)throw t.error}}re.isBroadcast&&ue&&e.onChannelMemberCountChanged([re]);})),[2]}))}))})),[3,69];case 35:return (Ke=this._leftChannels.get(ne.channelUrl))?(le=Ke.channel,[3,38]):[3,36];case 36:return [4,this.getChannel(ne.channelUrl,!0)];case 37:le=nn.sent(),nn.label=38;case 38:return ce=le,he=e.as(yn),Ue=he.memberCount,Le=he.joinedMemberCount,de=he.member,_e=!1,ce.isExclusive||ce.isSuper||ce.isBroadcast?_e=ce._setLatestMemberCount(Ue,Le,ne.ts):(ce.removeMember(de),this._updateJoinedMemberCount(ce)),de.userId===this._sdkState.userId?ce.isPublic?(ce.myMemberState=yt.NONE,ce.invitedAt=0,ce.joinedAt=0,ce._updateUnreadCount(0,0),this._dispatcher.dispatch(new jt({channels:[ce],source:Vt.EVENT_CHANNEL_LEFT}))):(this._markAsLeave(ce),this._dispatcher.dispatch(new zt({channelUrls:[ce.url],source:Vt.EVENT_CHANNEL_LEFT}))):this._dispatcher.dispatch(new jt({channels:[ce],source:Vt.EVENT_CHANNEL_LEFT})),Ie((function(){return r(tn,void 0,void 0,(function(){return i(this,(function(e){return this._groupChannelHandlers.forEach((function(e){e.onUserLeft(ce,de),ce.isBroadcast&&_e&&e.onChannelMemberCountChanged([ce]);})),[2]}))}))})),[3,69];case 39:return [4,this.getChannel(ne.channelUrl,!0)];case 40:fe=nn.sent(),pe=e.as(d$1).operators,me=pe.map((function(e){return e.userId}));try{for(ve=s(fe.members),ge=ve.next();!ge.done;ge=ve.next())(Be=ge.value).role=me.includes(Be.userId)?re$1.OPERATOR:re$1.NONE;}catch(e){Yt={error:e};}finally{try{ge&&!ge.done&&(Jt=ve.return)&&Jt.call(ve);}finally{if(Yt)throw Yt.error}}return fe.myRole=me.includes(this._sdkState.userId)?re$1.OPERATOR:re$1.NONE,this._dispatcher.dispatch(new jt({channels:[fe],source:Vt.EVENT_CHANNEL_OPERATOR_UPDATED})),Ie((function(){return r(tn,void 0,void 0,(function(){return i(this,(function(e){return this._groupChannelHandlers.forEach((function(e){e.onOperatorUpdated(fe,pe);})),[2]}))}))})),[3,69];case 41:return [4,this.getChannel(ne.channelUrl,!0)];case 42:Ee=nn.sent(),ye=e.as(bn),Ue=ye.memberCount,Le=ye.joinedMemberCount,Ce=ye.inviter,(Ne=ye.invitees).forEach((function(e){return e.state=yt.INVITED}));try{for(be$1=s(Ne),Me=be$1.next();!Me.done;Me=be$1.next())Se$1=Me.value,Ee.isExclusive||Ee.isSuper||Ee.isBroadcast?Ee._setLatestMemberCount(Ue,Le,ne.ts):Ee.addMember(Se$1,ne.ts),this._sdkState.userId===Se$1.userId&&(Ee.hiddenState=Fr.UNHIDDEN,Ee.myMemberState!==yt.JOINED&&(Ee.myMemberState=yt.INVITED),Ee.invitedAt=ne.ts);}catch(e){Xt={error:e};}finally{try{Me&&!Me.done&&(Zt=be$1.return)&&Zt.call(be$1);}finally{if(Xt)throw Xt.error}}return this._dispatcher.dispatch(new jt({channels:[Ee],source:Vt.EVENT_CHANNEL_INVITED})),Ie((function(){return r(tn,void 0,void 0,(function(){return i(this,(function(e){return this._groupChannelHandlers.forEach((function(e){e.onUserReceivedInvitation(Ee,Ce,Ne);})),[2]}))}))})),[3,69];case 43:return [4,this.getChannel(ne.channelUrl,!0)];case 44:return Ae=nn.sent(),Te=e.as(An),Ue=Te.memberCount,Le=Te.joinedMemberCount,Re=Te.inviter,Oe=Te.invitee,Ae.isExclusive||Ae.isSuper||Ae.isBroadcast?Ae._setLatestMemberCount(Ue,Le,ne.ts):Ae.removeMember(Oe),this._sdkState.userId===Oe.userId?(Ae.invitedAt=0,Ae.myMemberState=yt.NONE,Ae.isPublic?this._dispatcher.dispatch(new jt({channels:[Ae],source:Vt.EVENT_CHANNEL_DECLINED_INVITE})):this._dispatcher.dispatch(new zt({channelUrls:[Ae.url],source:Vt.EVENT_CHANNEL_DECLINED_INVITE}))):this._dispatcher.dispatch(new jt({channels:[Ae],source:Vt.EVENT_CHANNEL_DECLINED_INVITE})),Ie((function(){return r(tn,void 0,void 0,(function(){return i(this,(function(e){return this._groupChannelHandlers.forEach((function(e){e.onUserDeclinedInvitation(Ae,Re,Oe);})),[2]}))}))})),[3,69];case 45:return [4,this.getChannel(ne.channelUrl,!0)];case 46:return ke=nn.sent(),Fe=ne.category===_.TYPING_START,Pe=e.as(Fe?Fn:xn).user,ke._updateTypingStatus(Pe,Fe?ne.ts:0),this._dispatcher.dispatch(new jt({channels:[ke],source:Vt.EVENT_CHANNEL_TYPING_STATUS_UPDATE})),Ie((function(){return r(tn,void 0,void 0,(function(){return i(this,(function(e){return this._groupChannelHandlers.forEach((function(e){e.onTypingStatusUpdated(ke);})),[2]}))}))})),[3,69];case 47:return [4,this.getChannel(ne.channelUrl,!0)];case 48:xe=nn.sent(),He=ne.category===_.USER_CHANNEL_MUTE,(Ve=e.as(He?at$1:ot$1).user).userId===this._sdkState.userId&&(xe.myMutedState=He?kr.MUTED:kr.UNMUTED);try{for(Ge=s(xe.members),qe=Ge.next();!qe.done;qe=Ge.next())if((Be=qe.value).userId===Ve.userId){Be.isMuted=He;break}}catch(e){$t={error:e};}finally{try{qe&&!qe.done&&(en=Ge.return)&&en.call(Ge);}finally{if($t)throw $t.error}}return this._dispatcher.dispatch(new jt({channels:[xe],source:He?Vt.EVENT_CHANNEL_MUTED:Vt.EVENT_CHANNEL_UNMUTED})),Ie((function(){return r(tn,void 0,void 0,(function(){return i(this,(function(e){return this._groupChannelHandlers.forEach((function(e){He?e.onUserMuted(xe,Ve):e.onUserUnmuted(xe,Ve);})),[2]}))}))})),[3,69];case 49:return (Ke=this._leftChannels.get(ne.channelUrl))?(ze=Ke.channel,[3,52]):[3,50];case 50:return [4,this.getChannel(ne.channelUrl,!0)];case 51:ze=nn.sent(),nn.label=52;case 52:return je$1=ze,this._markAsLeave(je$1),st=e.as(ct$1).user,Ie((function(){return r(tn,void 0,void 0,(function(){return i(this,(function(e){return this._groupChannelHandlers.forEach((function(e){e.onUserBanned(je$1,st);})),[2]}))}))})),[3,69];case 53:return [4,this.getChannel(ne.channelUrl,!0)];case 54:return it=nn.sent(),at=e.as(dt).user,Ie((function(){return r(tn,void 0,void 0,(function(){return i(this,(function(e){return this._groupChannelHandlers.forEach((function(e){e.onUserUnbanned(it,at);})),[2]}))}))})),[3,69];case 55:return [4,this.getChannel(ne.channelUrl,!0)];case 56:return ot=nn.sent(),ut=e.as(pt).freeze,ot.isFrozen=ut,this._dispatcher.dispatch(new jt({channels:[ot],source:ut?Vt.EVENT_CHANNEL_FROZEN:Vt.EVENT_CHANNEL_UNFROZEN})),Ie((function(){return r(tn,void 0,void 0,(function(){return i(this,(function(e){return this._groupChannelHandlers.forEach((function(e){ut?e.onChannelFrozen(ot):e.onChannelUnfrozen(ot);})),[2]}))}))})),[3,69];case 57:return [4,this.getChannel(ne.channelUrl,!0)];case 58:return ct=nn.sent(),lt=e.as(On),Et=lt.allowAutoUnhide,Ct=lt.hidePreviousMessages,Nt=lt.messageOffsetTimestamp,null!==Et&&(ct.hiddenState=Et?Fr.HIDDEN_ALLOW_AUTO_UNHIDE:Fr.HIDDEN_PREVENT_AUTO_UNHIDE),null!==Ct&&Ct&&ct._updateUnreadCount(0,0),null!==Nt&&(ct.messageOffsetTimestamp=Nt),this._dispatcher.dispatch(new jt({channels:[ct],source:Vt.EVENT_CHANNEL_HIDDEN})),Ie((function(){return r(tn,void 0,void 0,(function(){return i(this,(function(e){return this._groupChannelHandlers.forEach((function(e){e.onChannelHidden(ct);})),[2]}))}))})),[3,69];case 59:return [4,this.getChannel(ne.channelUrl,!0)];case 60:return (bt=nn.sent()).hiddenState=Fr.UNHIDDEN,this._dispatcher.dispatch(new jt({channels:[bt],source:Vt.EVENT_CHANNEL_UNHIDDEN})),Ie((function(){return r(tn,void 0,void 0,(function(){return i(this,(function(e){return this._groupChannelHandlers.forEach((function(e){e.onChannelChanged(bt);})),[2]}))}))})),[3,69];case 61:return [4,this.getChannel(ne.channelUrl,!0)];case 62:return Mt=nn.sent(),this._dispatcher.dispatch(new zt({channelUrls:[ne.channelUrl],source:Vt.EVENT_CHANNEL_DELETED})),Ie((function(){return r(tn,void 0,void 0,(function(){return i(this,(function(e){return this._groupChannelHandlers.forEach((function(e){e.onChannelDeleted(Mt.url,Mt.channelType);})),[2]}))}))})),[3,69];case 63:return [4,this.getChannelWithoutCache(ne.channelUrl,!0)];case 64:return St=nn.sent(),this._dispatcher.dispatch(new jt({channels:[St],source:Vt.EVENT_CHANNEL_UPDATED})),Ie((function(){return r(tn,void 0,void 0,(function(){return i(this,(function(e){return this._groupChannelHandlers.forEach((function(e){e.onChannelChanged(St);})),[2]}))}))})),[3,69];case 65:return [4,this.getChannel(ne.channelUrl,!0)];case 66:return At=nn.sent(),Tt=e.as(je),Ut=Tt.created,It=Tt.updated,wt=Tt.deleted,Ut&&At._upsertCachedMetaData(Ut,ne.ts),It&&At._upsertCachedMetaData(It,ne.ts),wt&&At._removeFromCachedMetaData(wt,ne.ts),Ie((function(){return r(tn,void 0,void 0,(function(){return i(this,(function(e){return this._groupChannelHandlers.forEach((function(e){Ut&&e.onMetaDataCreated(At,Ut),It&&e.onMetaDataUpdated(At,It),wt&&e.onMetaDataDeleted(At,wt);})),[2]}))}))})),[3,69];case 67:return [4,this.getChannel(ne.channelUrl,!0)];case 68:return Dt=nn.sent(),Lt=e.as(tt),Rt=Lt.created,Ot=Lt.updated,kt=Lt.deleted,Ie((function(){return r(tn,void 0,void 0,(function(){return i(this,(function(e){return this._groupChannelHandlers.forEach((function(e){Rt&&e.onMetaCounterCreated(Dt,Rt),Ot&&e.onMetaCounterUpdated(Dt,Ot),kt&&e.onMetaCounterDeleted(Dt,kt);})),[2]}))}))})),[3,69];case 69:return [3,71];case 70:switch((Ft=e.as(be).event).category){case te.USER_BLOCK:Pt=me$1.getDataAsUserBlockEvent(this._iid,Ft),Ht=Pt.blocker,Gt=Pt.blockee,this._groupChannelCache.block(Ht.userId,Gt.userId);break;case te.USER_UNBLOCK:xt=me$1.getDataAsUserBlockEvent(this._iid,Ft),Ht=xt.blocker,Gt=xt.blockee,this._groupChannelCache.unblock(Ht.userId,Gt.userId);}return [3,71];case 71:return [3,73];case 72:if(qt=nn.sent(),h(qt))throw qt;return [3,73];case 73:return [2]}}))}))},e.prototype._markAsLeave=function(e){var t,n=this,r=null!==(t=this._leftChannels.get(e.url))&&void 0!==t?t:{channel:e,ref:0};r.ref++,this._leftChannels.set(e.url,r),setTimeout((function(){r.ref--,0===r.ref&&n._leftChannels.delete(e.url);}),1e4);},e.prototype.addHandler=function(e,t){this._groupChannelHandlers.set(e,t);},e.prototype.removeHandler=function(e){this._groupChannelHandlers.delete(e);},e.prototype.clearHandler=function(){this._groupChannelHandlers.clear();},e.prototype.subscribeGroupChannelEvent=function(e,t){this._groupChannelBroadcast.subscribe(e,t);},e.prototype.unsubscribeGroupChannelEvent=function(e){this._groupChannelBroadcast.unsubscribe(e);},e.prototype.subscribeMessageEvent=function(e,t){this._messageBroadcast.subscribe(e,t);},e.prototype.unsubscribeMessageEvent=function(e){this._messageBroadcast.unsubscribe(e);},e.prototype._updateJoinedMemberCount=function(e){e.joinedMemberCount=e.members.filter((function(e){return e.state===yt.JOINED})).length;},e.prototype.getChannel=function(e,t){return void 0===t&&(t=!1),r(this,void 0,void 0,(function(){var n;return i(this,(function(r){switch(r.label){case 0:at(y("string",e)).throw(p.invalidParameters),r.label=1;case 1:return r.trys.push([1,3,,4]),[4,this.getChannelFromCache(e)];case 2:return (n=r.sent())?[2,n]:[3,4];case 3:return r.sent(),[3,4];case 4:return [4,this.getChannelWithoutCache(e,t)];case 5:return [2,r.sent()]}}))}))},e.prototype.getChannelWithoutCache=function(e,t){return void 0===t&&(t=!1),r(this,void 0,void 0,(function(){var n,r,s,i$1,a;return i(this,(function(o){switch(o.label){case 0:return at(y("string",e)).throw(p.invalidParameters),n=new Xt({channelUrl:e,isInternalCall:t}),[4,this._requestQueue.send(n)];case 1:switch(r=o.sent(),s=r.as(Zt).channel,i$1=s.unreadMessageCount,a=s.unreadMentionCount,s.myCountPreference){case Or.UNREAD_MESSAGE_COUNT_ONLY:a=0;break;case Or.UNREAD_MENTION_COUNT_ONLY:i$1=0;break;case Or.OFF:i$1=0,a=0;}return s._updateUnreadCount(i$1,a),[4,this._groupChannelCache.upsert([s])];case 2:return o.sent(),[2,s]}}))}))},e.prototype.getMyGroupChannels=function(e,t,n$1,r$1){return void 0===r$1&&(r$1=Vt.REQUEST_CHANNEL),r(this,void 0,void 0,(function(){var i$1,a,o,u,c;return i(this,(function(l){switch(l.label){case 0:return i$1=new $t(n(n({},t),{userId:this._sdkState.userId,token:e,limit:n$1})),[4,this._requestQueue.send(i$1)];case 1:return a=l.sent(),o=a.as(en),u=o.channels,c=o.token,this._dispatcher.dispatch(new jt({channels:u,source:r$1})),[2,{channels:u,token:c}]}}))}))},e.prototype.getMessageFromCache=function(e){return r(this,void 0,void 0,(function(){return i(this,(function(t){switch(t.label){case 0:return [4,this._messageCache.get(e)];case 1:return [2,t.sent()]}}))}))},e.prototype.getMessagesFromCache=function(e,t,n,r$1,s){return void 0===s&&(s=Y),r(this,void 0,void 0,(function(){return i(this,(function(i){switch(i.label){case 0:return [4,this._messageCache.fetch({channelUrl:e,token:t,limit:s,filter:r$1,backward:"next"===n})];case 1:return [2,i.sent()]}}))}))},e.prototype.getAllFailedMessagesFromCache=function(e,t){return r(this,void 0,void 0,(function(){return i(this,(function(n){switch(n.label){case 0:return [4,this._unsentMessageCache.fetch({channelUrl:e,filter:t,sendingStatus:le.FAILED})];case 1:return [2,n.sent()]}}))}))},e.prototype.removeFailedMessageFromCache=function(e){return r(this,void 0,void 0,(function(){return i(this,(function(t){switch(t.label){case 0:return [4,this._unsentMessageCache.remove([e])];case 1:return t.sent(),[2]}}))}))},e.prototype.getCachedMessageCountBetween=function(e,t,n,r$1){return r(this,void 0,void 0,(function(){return i(this,(function(s){switch(s.label){case 0:return [4,this._messageCache.countBetween(e,t,new Gn({top:n,bottom:r$1}))];case 1:return [2,s.sent()]}}))}))},e.prototype.getMyGroupChannelChangeLogs=function(e,t,n$1){return void 0===n$1&&(n$1=Vt.REQUEST_CHANNEL_CHANGELOGS),r(this,void 0,void 0,(function(){var i$1,a,o,u,c;return i(this,(function(l){switch(l.label){case 0:return t=n(n({},Ft),t),at(y("string",e)&&Pt(t)).throw(p.invalidParameters),i$1=new Yt(U({userId:this._sdkState.userId,ts:"number"==typeof e?e:null,token:"string"==typeof e?e:null,filter:t})),[4,this._requestQueue.send(i$1)];case 1:return a=l.sent(),o=a.as(Jt),u=o.updatedChannels,c=o.deletedChannelUrls,u.length>0&&this._dispatcher.dispatch(new jt({channels:u,source:n$1})),c.length>0&&this._dispatcher.dispatch(new zt({channelUrls:c,source:n$1})),[2,o]}}))}))},e.prototype.getGroupChannelCount=function(e){return r(this,void 0,void 0,(function(){var t,n$1;return i(this,(function(r){switch(r.label){case 0:return e=n(n({},xt),e),at(Ht(e)).throw(p.invalidParameters),t=new tn({userId:this._sdkState.userId,filter:e}),[4,this._requestQueue.send(t)];case 1:return n$1=r.sent(),[2,n$1.as(nn).groupChannelCount]}}))}))},e.prototype.getUnreadItemCount=function(e){return r(this,void 0,void 0,(function(){var t,n$1,r,i$1;return i(this,(function(a){switch(a.label){case 0:return e=n(n({},Gt),e),at(function(e){return E(Dt,e.keys)}(e)).throw(p.invalidParameters),t=St$1.of(this._iid),n$1=t.sdkState,r=t.requestQueue,i$1=new rn({userId:n$1.userId,filter:e}),[4,r.send(i$1)];case 1:return [2,a.sent().as(sn)]}}))}))},e.prototype.getTotalUnreadChannelCount=function(){return r(this,void 0,void 0,(function(){var e,t,n,r,s;return i(this,(function(i){switch(i.label){case 0:return e=St$1.of(this._iid),t=e.sdkState,n=e.requestQueue,r=new an({userId:t.userId}),[4,n.send(r)];case 1:return s=i.sent(),[2,s.as(on).unreadCount]}}))}))},e.prototype.getTotalUnreadMessageCount=function(e){return r(this,void 0,void 0,(function(){var n$1,r,i$1,a,o;return i(this,(function(u){switch(u.label){case 0:return e=n(n({},qt),e),at(function(e){return E("string",e.channelCustomTypesFilter)&&m(bt,e.superChannelFilter)}(e)).throw(p.invalidParameters),n$1=St$1.of(this._iid),r=n$1.sdkState,i$1=n$1.requestQueue,a=new un({userId:r.userId,filter:e}),[4,i$1.send(a)];case 1:return o=u.sent(),[2,o.as(cn).unreadCount]}}))}))},e.prototype.getTotalScheduledMessageCount=function(e){return void 0===e&&(e={}),r(this,void 0,void 0,(function(){var n$1,r,i$1;return i(this,(function(a){switch(a.label){case 0:return e=n(n({},Bt),e),at(function(e){return y("string",e.channelUrl,!0)&&E(Ct$1,e.scheduledStatus,!0)&&m(se,e.messageTypeFilter)}(e)).throw(p.invalidParameters),n$1=St$1.of(this._iid).requestQueue,r=new ln(e),[4,n$1.send(r)];case 1:return i$1=a.sent(),[2,i$1.as(hn).count]}}))}))},e.prototype.getSubscribedTotalUnreadMessageCount=function(){var e=St$1.of(this._iid).subscribedUnreadMessageCount;return e.all>=0?e.all:0},e.prototype.getSubscribedCustomTypeTotalUnreadMessageCount=function(){var e=0,t=St$1.of(this._iid).subscribedUnreadMessageCount;for(var n in t.customTypes)e+=t.customTypes[n];return e},e.prototype.getSubscribedCustomTypeUnreadMessageCount=function(e){var t;return null!==(t=St$1.of(this._iid).subscribedUnreadMessageCount.customTypes[e])&&void 0!==t?t:0},e.prototype.createChannel=function(e){return r(this,void 0,void 0,(function(){var t,n$1,r;return i(this,(function(i){switch(i.label){case 0:return e=n(n({},Ot),e),at(kt(e)).throw(p.invalidParameters),e.isPublic||(e.accessCode=null),t=new _n(n({userId:this._sdkState.userId},e)),[4,this._requestQueue.send(t)];case 1:return n$1=i.sent(),r=n$1.as(fn).channel,[4,this._groupChannelCache.upsert([r])];case 2:return i.sent(),[2,r]}}))}))},e.prototype.markAsReadAll=function(){return r(this,void 0,void 0,(function(){var e,t,n,r,s$1,i$1,a,o;return i(this,(function(u){switch(u.label){case 0:return e=Date.now(),at(e-this._markAsReadAllLastSentAt>=1e3).throw(p.markAsReadAllRateLimitExceeded),this._markAsReadAllLastSentAt=e,t=new pn({userId:this._sdkState.userId}),[4,this._requestQueue.send(t)];case 1:u.sent(),n=this._groupChannelCache.channels;try{for(r=s(n),s$1=r.next();!s$1.done;s$1=r.next())(i$1=s$1.value)._updateUnreadMemberState(this._sdkState.userId,e),i$1._updateUnreadCount(0,0);}catch(e){a={error:e};}finally{try{s$1&&!s$1.done&&(o=r.return)&&o.call(r);}finally{if(a)throw a.error}}return n.length>0?[4,this._groupChannelCache.upsert(n)]:[3,3];case 2:u.sent(),u.label=3;case 3:return [2]}}))}))},e.prototype.markAsReadWithChannelUrls=function(e){return r(this,void 0,void 0,(function(){var t,n,r,s$1,i$1,a,o,u,c;return i(this,(function(l){switch(l.label){case 0:return t=Date.now(),at(E("string",e)&&t-this._markAsReadAllLastSentAt>=1e3).throw(p.markAsReadAllRateLimitExceeded),this._markAsReadAllLastSentAt=t,n=new pn({userId:this._sdkState.userId,channelUrls:e}),[4,this._requestQueue.send(n)];case 1:l.sent(),r=this._groupChannelCache.channels,s$1=[];try{for(i$1=s(r),a=i$1.next();!a.done;a=i$1.next())o=a.value,e.includes(o.url)&&(o._updateUnreadMemberState(this._sdkState.userId,t),o._updateUnreadCount(0,0),s$1.push(o));}catch(e){u={error:e};}finally{try{a&&!a.done&&(c=i$1.return)&&c.call(i$1);}finally{if(u)throw u.error}}return s$1.length>0?[4,this._groupChannelCache.upsert(s$1)]:[3,3];case 2:l.sent(),l.label=3;case 3:return [2]}}))}))},e.prototype.markAsDelivered=function(e){return r(this,void 0,void 0,(function(){return i(this,(function(t){switch(t.label){case 0:return [4,this.getChannel(e)];case 1:return [4,t.sent().markAsDelivered()];case 2:return t.sent(),[2]}}))}))},e}(),Kn=new Map,jn=new Map,zn=new Map,Qn=function(){function e(t){var n=t.key,r$1=t.concurrentCallLimit,s=void 0===r$1?2:r$1,i$1=t.backOffDelay,a=void 0===i$1?0:i$1,o=this;this._holdersKey=e.createSemaphoreHoldersKey(n),this._resolversKey=e.createSemaphoreResolversKey(n),this._chainProcessStateKey=e.createChainProcessStateKey(n),this._numLocks=s,this._backOffDelay=a,this._localAcquiredKeys=[],this._localResolversData=[],z()?(Kn[this._holdersKey]||(Kn[this._holdersKey]=[]),jn[this._resolversKey]||(jn[this._resolversKey]=[])):(window.addEventListener("storage",(function(e){return r(o,void 0,void 0,(function(){var t,n;return i(this,(function(r){if(this._localResolversData.length>0&&this.numLocksAvailable>0&&!this._isProcessChainAcquireRunning()&&this._hasHighestPriorityResolver())switch(e.key){case this._holdersKey:if(t=JSON.parse(e.oldValue),n=JSON.parse(e.newValue),!t||!n||n.length>=t.length)return [2];this._processChainResolve();break;case this._chainProcessStateKey:if(JSON.parse(e.newValue))return [2];this._processChainResolve();break;default:return [2]}return [2]}))}))})),window.addEventListener("beforeunload",(function(){var e=o._getLocalResolversData(),t=o._localResolversData.map((function(e){return e.key})),n=e.filter((function(e){return t.indexOf(e.key)<0}));window.localStorage.setItem(o._resolversKey,JSON.stringify(n)),o._localAcquiredKeys.forEach((function(e){return o.release(e)}));})));}return e.createSemaphoreHoldersKey=function(e){return "collection@semaphore_holders_for:"+e},e.createSemaphoreResolversKey=function(e){return "collection@semaphore_resolvers_for:"+e},e.createChainProcessStateKey=function(e){return "collection@semaphore_chain_process_state_for:"+e},Object.defineProperty(e.prototype,"numLocks",{get:function(){return this._numLocks},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"backOffDelay",{get:function(){return this._backOffDelay},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"numLocksAvailable",{get:function(){if(z())return this.numLocks-Kn[this._holdersKey].length;var e=this._getLocalHoldersData();return this.numLocks-e.length},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"waitCount",{get:function(){return z()?jn[this._resolversKey].length:this._getLocalResolversData().length},enumerable:!1,configurable:!0}),e.prototype._hasHighestPriorityResolver=function(){var e=this._getLocalResolversData();return e.length>0&&this._localResolversData.map((function(e){return e.key})).indexOf(e[0].key)>=0},e.prototype._isProcessChainAcquireRunning=function(){if(z())return zn[this._chainProcessStateKey];var e=window.localStorage[this._chainProcessStateKey];return void 0!==e&&JSON.parse(e)},e.prototype._setProcessChainAcquireRunning=function(e){z()?zn[this._chainProcessStateKey]=e:e?window.localStorage.setItem(this._chainProcessStateKey,JSON.stringify(e)):window.localStorage.removeItem(this._chainProcessStateKey);},e.prototype._processChainResolve=function(){return r(this,void 0,void 0,(function(){var e;return i(this,(function(t){switch(t.label){case 0:return this.waitCount>0&&this.numLocksAvailable>0&&!this._isProcessChainAcquireRunning()?(this._setProcessChainAcquireRunning(!0),this._tryResolve()?[4,me(this._backOffDelay)]:[3,2]):[3,3];case 1:t.sent(),t.label=2;case 2:this._setProcessChainAcquireRunning(!1),z()?this._processChainResolve():(e=new StorageEvent("storage",{key:this._chainProcessStateKey,oldValue:JSON.stringify(!0),newValue:JSON.stringify(!1)}),dispatchEvent(e)),t.label=3;case 3:return [2]}}))}))},e.prototype.acquire=function(e){return void 0===e&&(e=0),r(this,void 0,void 0,(function(){var t,n=this;return i(this,(function(r){return z()?[2,new Promise((function(t){for(var r={key:R(),resolver:function(e){return t(e)},priority:e},s=jn[n._resolversKey],i=-1,a=0;a<s.length;a++)if(e>s[a].priority){i=a;break}i>=0?jn[n._resolversKey].splice(i,0,r):jn[n._resolversKey].push(r),n._processChainResolve();}))]:(t=this._getLocalResolversData(),[2,new Promise((function(r){for(var s=R(),i={key:s,priority:e},a={key:s,resolver:function(e){return r(e)},priority:e},o=-1,u=0;u<t.length;u++)if(e>t[u].priority){o=u;break}o>=0?(t.splice(o,0,i),n._localResolversData.splice(o,0,a)):(t.push(i),n._localResolversData.push(a)),window.localStorage.setItem(n._resolversKey,JSON.stringify(t)),n._processChainResolve();}))])}))}))},e.prototype.release=function(e){if(z()){if((t=Kn[this._holdersKey].indexOf(e))>=0)return Kn[this._holdersKey].splice(t,1),this._processChainResolve(),!0}else if(window.localStorage[this._holdersKey]){var t,n=JSON.parse(window.localStorage[this._holdersKey]),r=a([],o(n),!1);if((t=n.indexOf(e))>=0){n.splice(t,1),window.localStorage.setItem(this._holdersKey,JSON.stringify(n)),this._localAcquiredKeys.splice(this._localAcquiredKeys.indexOf(e),1);var s=new StorageEvent("storage",{key:this._holdersKey,oldValue:JSON.stringify(r),newValue:JSON.stringify(n)});return dispatchEvent(s),!0}}return !1},e.prototype._tryResolve=function(){if(z()){if(Kn[this._holdersKey].length<this.numLocks){var e=R();return Kn[this._holdersKey]=a(a([],o(Kn[this._holdersKey]),!1),[e],!1),(n=jn[this._resolversKey].shift()).resolver(e),!0}}else {var t=this._getLocalHoldersData();if(t.length<this.numLocks){e=R();var n=this._localResolversData.shift(),r=this._getLocalResolversData(),s=r.map((function(e){return e.key})).indexOf(n.key);r.splice(s,1),window.localStorage.setItem(this._resolversKey,JSON.stringify(r)),window.localStorage.setItem(this._holdersKey,JSON.stringify(a(a([],o(t),!1),[e],!1))),this._localAcquiredKeys.push(e);var i=new StorageEvent("storage",{key:this._holdersKey,oldValue:JSON.stringify(a([],o(t),!1)),newValue:JSON.stringify(a(a([],o(t),!1),[e],!1))});return dispatchEvent(i),(0, n.resolver)(e),!0}}return !1},e.prototype._getLocalHoldersData=function(){var e=window.localStorage[this._holdersKey];return void 0!==e?JSON.parse(e):[]},e.prototype._getLocalResolversData=function(){var e=window.localStorage[this._resolversKey];return void 0!==e?JSON.parse(e):[]},e}();!function(e){e[e.IDLE=0]="IDLE",e[e.RUNNING=1]="RUNNING",e[e.END=2]="END";}(wn||(wn={}));var Wn,Yn=function(t$1){function n(e,n,r,s){void 0===r&&(r=2),void 0===s&&(s=10);var i=t$1.call(this)||this;return i._worker=null,i._state=wn.IDLE,i._semaphore=null,i._retryCount=0,i._retryLimit=3,i.priority=0,i._worker=n,i._semaphore=new Qn({key:e,concurrentCallLimit:r,backOffDelay:s}),i}return t(n,t$1),Object.defineProperty(n.prototype,"isIdle",{get:function(){return this._state===wn.IDLE},enumerable:!1,configurable:!0}),Object.defineProperty(n.prototype,"isRunning",{get:function(){return this._state===wn.RUNNING},enumerable:!1,configurable:!0}),Object.defineProperty(n.prototype,"isDone",{get:function(){return this._state===wn.END},enumerable:!1,configurable:!0}),Object.defineProperty(n.prototype,"retryCount",{get:function(){return this._retryCount},enumerable:!1,configurable:!0}),Object.defineProperty(n.prototype,"retryLimit",{get:function(){return this._retryLimit},enumerable:!1,configurable:!0}),n.prototype._run=function(e){return r(this,void 0,void 0,(function(){var t,n;return i(this,(function(r){switch(r.label){case 0:if(!this.isRunning)return [3,4];r.label=1;case 1:return r.trys.push([1,3,,4]),[4,this._worker(e)];case 2:return t=r.sent(),this._retryCount=0,this.dispatch("progress",t),t.hasNext?this._run(t.nextToken):this.end(),[3,4];case 3:return n=r.sent(),this.dispatch("error",n),this._retryCount<this._retryLimit?(this._retryCount++,this._run(e)):this.stop(),[3,4];case 4:return [2]}}))}))},n.prototype.start=function(e){this.isIdle&&(this._state=wn.RUNNING,this._run(e));},n.prototype.stop=function(){this._state=wn.IDLE,this.dispatch("stop");},n.prototype.end=function(){this._state=wn.END,this.dispatch("end");},n}(M),Jn=function(e){this.source=e;},Xn=function(e){this.source=e;},Zn={},$n=function(){function e(e){var t=e._iid,n=e.channel,r$1=this;this._prevSync=null,this._nextSync=null,this._metadata=null,this._iid=t,this._channel=n;var s,i$1,a=St$1.of(this._iid),o=a.sdkState,u=a.logger;this._metadataKey=(s=o.userId,i$1=n.url,"sendbird:".concat(s,"@groupchannel/").concat(i$1,"/message/sync.meta"));var c=function(e,t){return "sendbird:".concat(e,"@groupchannel/").concat(t,"/message/sync")}(o.userId,n.url);this._prevSync=new Yn(c,(function(e){return r(r$1,void 0,void 0,(function(){var t,n,r,s,i$1,a;return i(this,(function(o){switch(o.label){case 0:return t={hasNext:!0,nextToken:0},[4,this.loadMetadata()];case 1:if(o.sent(),u.debug("message background prev sync from",null===(s=this._metadata)||void 0===s?void 0:s.range.top),this._metadata.previousComplete)return [3,9];o.label=2;case 2:return o.trys.push([2,5,,8]),[4,En$1.of(this._iid).getMessagesByTimestamp(this._channel.url,this._channel.channelType,null!==(a=null===(i$1=this._metadata.range)||void 0===i$1?void 0:i$1.top)&&void 0!==a?a:e,{prevResultSize:100,nextResultSize:0,replyType:ue$1.ALL,includeReactions:!0,includeMetaArray:!0,includeParentMessageInfo:!0,includeThreadInfo:!0},$t$1.SYNC_MESSAGE_BACKGROUND)];case 3:return n=o.sent(),this.extendRange(n),t.hasNext=n.length>=100,t.nextToken=this._metadata.range.top,this._metadata.previousComplete=!t.hasNext,u.debug("message background prev sync progress",t),[4,this.saveMetadata()];case 4:return o.sent(),[3,8];case 5:return (r=o.sent())instanceof p&&r.isInvalidTokenError?[4,this.clearMetadata()]:[3,7];case 6:o.sent(),o.label=7;case 7:return t.hasNext=!1,t.nextToken=0,[3,8];case 8:return [3,10];case 9:t.hasNext=!1,o.label=10;case 10:return [2,t]}}))}))})),this._nextSync=new Yn(c,(function(e){return r(r$1,void 0,void 0,(function(){var t,n,r,s,i$1;return i(this,(function(a){switch(a.label){case 0:return t={hasNext:!0,nextToken:0},[4,this.loadMetadata()];case 1:return a.sent(),u.debug("message background next sync from",null===(r=this._metadata)||void 0===r?void 0:r.range.bottom),[4,En$1.of(this._iid).getMessagesByTimestamp(this._channel.url,this._channel.channelType,null!==(i$1=null===(s=this._metadata.range)||void 0===s?void 0:s.bottom)&&void 0!==i$1?i$1:e,{prevResultSize:0,nextResultSize:100,replyType:ue$1.ALL,includeReactions:!0,includeMetaArray:!0,includeParentMessageInfo:!0,includeThreadInfo:!0},$t$1.SYNC_MESSAGE_BACKGROUND)];case 2:return n=a.sent(),this.extendRange(n),t.hasNext=n.length>=100,t.nextToken=this._metadata.range.bottom,u.debug("message background next sync progress",t),[4,this.saveMetadata()];case 3:return a.sent(),[2,t]}}))}))}));}return e.of=function(t,n){if(Zn[t]||(Zn[t]={}),!Zn[t][n.url]){var r=Zn[t][n.url]=new e({_iid:t,channel:n});St$1.of(t).dispatcher.on((function(e){if(e instanceof de)if(e.stateType===J.CONNECTED)r.resume();else r.pause();}));}return Zn[t][n.url]},Object.defineProperty(e.prototype,"range",{get:function(){var e;return null===(e=this._metadata)||void 0===e?void 0:e.range},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"previousComplete",{get:function(){var e;return !!(null===(e=this._metadata)||void 0===e?void 0:e.previousComplete)},enumerable:!1,configurable:!0}),e.prototype.isWrappingMessages=function(e){var t;return null===(t=this.range)||void 0===t?void 0:t.includes.apply(t,a([],o(e.map((function(e){return e.createdAt}))),!1))},e.prototype.extendRange=function(e){var t;this._metadata&&(t=this._metadata.range).extends.apply(t,a([],o(e.map((function(e){return e.createdAt}))),!1));},e.prototype.loadMetadata=function(){return r(this,void 0,void 0,(function(){var e;return i(this,(function(t){switch(t.label){case 0:return this._metadata?[3,2]:[4,St$1.of(this._iid).cacheContext.preference.get(this._metadataKey)];case 1:e=t.sent(),this._metadata={range:new Gn(e?e.range:{top:Number.MAX_SAFE_INTEGER,bottom:Number.MAX_SAFE_INTEGER}),previousComplete:!!e&&e.previousComplete},t.label=2;case 2:return [2]}}))}))},e.prototype.saveMetadata=function(){return r(this,void 0,void 0,(function(){return i(this,(function(e){switch(e.label){case 0:return this._metadata?[4,St$1.of(this._iid).cacheContext.preference.set(this._metadataKey,this._metadata)]:[3,2];case 1:e.sent(),e.label=2;case 2:return [2]}}))}))},e.prototype.clearMetadata=function(){return r(this,void 0,void 0,(function(){return i(this,(function(e){return St$1.of(this._iid).cacheContext.preference.remove(this._metadataKey),[2]}))}))},e.prototype.resume=function(){var e,t,n,r;St$1.of(this._iid).logger.debug("message background sync resume()"),this._metadata&&this._metadata.previousComplete||this._prevSync.start(null!==(t=null===(e=this._metadata)||void 0===e?void 0:e.range.top)&&void 0!==t?t:Date.now()),this._nextSync.start(null!==(r=null===(n=this._metadata)||void 0===n?void 0:n.range.bottom)&&void 0!==r?r:Date.now());},e.prototype.pause=function(){St$1.of(this._iid).logger.debug("message background sync stop()"),this._prevSync.stop(),this._nextSync.stop();},e}(),er={},tr=function(){function e(e){var t=e._iid,n=e.channel,r$1=this;this._sync=null,this._metadata=null,this._iid=t,this._channel=n;var s,i$1,a=St$1.of(this._iid).sdkState;this._metadataKey=(s=a.userId,i$1=n.url,"sendbird:".concat(s,"@groupchannel/").concat(i$1,"/message/changelogs.meta"));var o=function(e,t){return "sendbird:".concat(e,"@groupchannel/").concat(t,"/message/changelogs")}(a.userId,this._channel.url);this._sync=new Yn(o,(function(){return r(r$1,void 0,void 0,(function(){var e,t,n,r,s;return i(this,(function(i){switch(i.label){case 0:return e={hasNext:!0,nextToken:0},[4,this.loadMetadata()];case 1:i.sent(),i.label=2;case 2:return i.trys.push([2,5,,8]),[4,En$1.of(this._iid).getMessageChangelogs(this._channel.url,this._channel.channelType,this._metadata.token,{replyType:ue$1.ALL,includeReactions:!0,includeThreadInfo:!0,includeMetaArray:!0,includeParentMessageInfo:!0,includePollDetails:!0},$t$1.SYNC_MESSAGE_CHANGELOGS)];case 3:return t=i.sent(),n=t.hasMore,r=t.token,e.hasNext=n,e.nextToken=r,this._metadata.token=r,[4,this.saveMetadata()];case 4:return i.sent(),[3,8];case 5:return (s=i.sent())instanceof p&&s.isInvalidTokenError?[4,this.clearMetadata()]:[3,7];case 6:i.sent(),i.label=7;case 7:return e.hasNext=!1,e.nextToken="",[3,8];case 8:return [2,e]}}))}))}));}return e.of=function(t,n){if(er[t]||(er[t]={}),!er[t][n.url]){var r=er[t][n.url]=new e({_iid:t,channel:n});St$1.of(t).dispatcher.on((function(e){if(e instanceof de)if(e.stateType===J.CONNECTED)r.resume();else r.pause();}));}return er[t][n.url]},e.prototype.loadMetadata=function(){return r(this,void 0,void 0,(function(){var e,t,n,r;return i(this,(function(s){switch(s.label){case 0:return this._metadata?[3,2]:(e=St$1.of(this._iid),t=e.cacheContext,n=e.firstConnectedAt,[4,t.preference.get(this._metadataKey)]);case 1:r=s.sent(),this._metadata={token:r?r.token:n/1e3},s.label=2;case 2:return [2]}}))}))},e.prototype.saveMetadata=function(){return r(this,void 0,void 0,(function(){return i(this,(function(e){switch(e.label){case 0:return this._metadata?[4,St$1.of(this._iid).cacheContext.preference.set(this._metadataKey,this._metadata)]:[3,2];case 1:e.sent(),e.label=2;case 2:return [2]}}))}))},e.prototype.clearMetadata=function(){return r(this,void 0,void 0,(function(){return i(this,(function(e){return St$1.of(this._iid).cacheContext.preference.remove(this._metadataKey),[2]}))}))},e.prototype.resume=function(){this._sync.start(0);},e.prototype.pause=function(){this._sync.stop();},e}(),nr=function(t$1){function n(e){var n,s,i,a,o,u,c=this;return (c=t$1.call(this)||this).method=d.GET,c.path="".concat(We(e.channelType),"/").concat(e.channelUrl,"/messages_gap"),c.params=U({prev_start_ts:e.prevStart,prev_end_ts:e.prevEnd,prev_cache_count:e.prevCount,next_start_ts:e.nextStart,next_end_ts:e.nextEnd,next_cache_count:e.nextCount,huge_gap_threshold:null!==(n=e.threshold)&&void 0!==n?n:null,reverse:!0,custom_types:null!==(s=e.customTypes)&&void 0!==s?s:["*"],message_type:null!==(i=e.messageType)&&void 0!==i?i:null,include_reactions:null===(a=e.includeReactions)||void 0===a||a,with_sorted_meta_array:null===(o=e.includeMetaArray)||void 0===o||o,show_subchannel_messages_only:null!==(u=e.showSubchannelMessagesOnly)&&void 0!==u&&u}),c}return t(n,t$1),n}(q),rr=function(t$1){function n(e,n){var r,s,i,a,o=this;return (o=t$1.call(this,e,n)||this).isHugeGap=n.is_huge_gap,o.prevMessages=(null!==(r=n.prev_messages)&&void 0!==r?r:[]).map((function(t){return Ht$1(e,t)})),o.prevHasMore=null!==(s=n.prev_hasmore)&&void 0!==s&&s,o.nextMessages=(null!==(i=n.next_messages)&&void 0!==i?i:[]).map((function(t){return Ht$1(e,t)})),o.nextHasmore=null!==(a=n.next_hasmore)&&void 0!==a&&a,o}return t(n,t$1),n}(F),sr=function(e,t){return e.findIndex((function(e){return e.isIdentical(t)}))},ir=function(e,t,n){if(e.length>0){var r=sr(e,t);if(r<0){for(var s=0,i=e.length-1,a=Math.floor((s+i)/2);s<i;){var o=ar(e[a],t,n);if(o>0)i=a,a=Math.floor((s+i)/2);else {if(!(o<0))return {place:a,contains:e[a].isIdentical(t)};s=a+1,a=Math.floor((s+i)/2);}}return {place:ar(e[a],t,n)>0?a:a+1,contains:!1}}return {place:r,contains:!0}}return {place:e.length,contains:!1}},ar=function(e,t,n){switch(n){case K.LATEST_LAST_MESSAGE:return e.lastMessage&&t.lastMessage?t.lastMessage.createdAt-e.lastMessage.createdAt:e.lastMessage?-1:t.lastMessage?1:t.createdAt-e.createdAt;case K.CHRONOLOGICAL:return t.createdAt-e.createdAt;case K.CHANNEL_NAME_ALPHABETICAL:return e.name.localeCompare(t.name)}},or=function(e,t){if(t instanceof xt$1)return e.findIndex((function(e){return e instanceof xt$1&&t.isIdentical(e)}));e.findIndex((function(e){return e.isIdentical(t)}));},ur=function(e,t){if(e.length>0){for(var n=0,r=e.length-1,s=Math.floor((n+r)/2);n<r;){var i=e[s].createdAt-t.createdAt;if(i>0)r=s,s=Math.floor((n+r)/2);else {if(!(i<0))return s;n=s+1,s=Math.floor((n+r)/2);}}return e[s].createdAt>t.createdAt?s:s+1}return e.length};!function(e){e.CACHE_AND_REPLACE_BY_API="cache_and_replace_by_api";}(Wn||(Wn={}));var cr,lr,hr,dr=function(){function e(){}return e.prototype._invokeResponse=function(e,t,n){var r$1=this;Ie((function(){return r(r$1,void 0,void 0,(function(){return i(this,(function(r){switch(e){case"local":this._onCacheResult(t,n);break;case"remote":this._onApiResult(t,n);}return [2]}))}))}));},e.prototype.onCacheResult=function(e){return this._onCacheResult=e,this},e.prototype.onApiResult=function(e){return this._onApiResult=e,this},e}(),_r=function(){function e(e,t){var n=t.channel,r$1=t.filter,s$1=t.startingPoint,i$1=t.limit,a$1=this;this._channel=null,this._messages=[],this._unsentMessages=[],this._readReceiptMap=new Map,this._deliveryReceiptMap=new Map,this._iid=e,this._key="mc-".concat(R()),this.filter=null!=r$1?r$1:new ee,this._channel=n,this._syncRange=new Gn({}),this._hasPrevious=!0,this._hasNext=!0,this._startingPoint=s$1||Date.now()+6e5,this._limit=i$1||Y;var o$1=Bn.of(this._iid);o$1.subscribeGroupChannelEvent(this._key,{onUpdate:function(e,t){var n,r$1,s$1,i$1,o=sr(e,a$1._channel);if(o>=0)switch(Ie((function(){return r(a$1,void 0,void 0,(function(){var n;return i(this,(function(r){return n=new Jn(t),this._channel=e[o],this._handler.onChannelUpdated(n,this.channel),[2]}))}))})),t){case Vt.EVENT_CHANNEL_UPDATED:var u=!1;for(var c in a$1._messages){if((g=a$1._messages[c]).createdAt>=a$1._channel.messageOffsetTimestamp){u=!0;var l=parseInt(c);if(l>0){var h=a$1._messages.splice(0,l);a$1._removeMessagesFromView(h.map((function(e){return e.messageId})),$t$1.EVENT_MESSAGE_OFFSET_UPDATED);}break}}!u&&a$1._messages.length>0&&a$1._removeMessagesFromView(a$1._messages.map((function(e){return e.messageId})),$t$1.EVENT_MESSAGE_OFFSET_UPDATED);break;case Vt.EVENT_CHANNEL_READ:var p=[];try{for(var m=s(a$1._messages),v=m.next();!v.done;v=m.next()){var g=v.value;if((C=a$1._readReceiptMap.get(g.messageId))>0)C!==a$1._channel.getUnreadMemberCount(g)&&p.push(g);}}catch(e){n={error:e};}finally{try{v&&!v.done&&(r$1=m.return)&&r$1.call(m);}finally{if(n)throw n.error}}p.length>0&&a$1._updateMessagesToView(p,$t$1.EVENT_MESSAGE_READ);break;case Vt.EVENT_CHANNEL_DELIVERED:p=[];try{for(var E=s(a$1._messages),y=E.next();!y.done;y=E.next()){var C;g=y.value;if((C=a$1._deliveryReceiptMap.get(g.messageId))>0)C!==a$1._channel.getUndeliveredMemberCount(g)&&p.push(g);}}catch(e){s$1={error:e};}finally{try{y&&!y.done&&(i$1=E.return)&&i$1.call(E);}finally{if(s$1)throw s$1.error}}p.length>0&&a$1._updateMessagesToView(p,$t$1.EVENT_MESSAGE_READ);}},onRemove:function(e,t){e.indexOf(a$1.channel.url)>=0&&Ie((function(){return r(a$1,void 0,void 0,(function(){var e;return i(this,(function(n){return e=new Jn(t),this._handler.onChannelDeleted(e,this.channel.url),[2]}))}))}));}}),o$1.subscribeMessageEvent(this._key,{onUpdate:function(e,t){var n,r,s$1=[],i=[];try{for(var o=s(e),u=o.next();!u.done;u=o.next()){var c=u.value;c.channelUrl===a$1._channel.url&&(a$1.filter.match(c)?s$1.push(c):i.push(c.messageId));}}catch(e){n={error:e};}finally{try{u&&!u.done&&(r=o.return)&&r.call(o);}finally{if(n)throw n.error}}if(an$1(t)){if(s$1.length>0)switch(t){case $t$1.EVENT_MESSAGE_SENT_FAILED:case $t$1.EVENT_MESSAGE_SENT_SUCCESS:case $t$1.EVENT_MESSAGE_UPDATED:case $t$1.EVENT_MESSAGE_THREADINFO_UPDATED:case $t$1.EVENT_MESSAGE_REACTION_UPDATED:case $t$1.SYNC_MESSAGE_CHANGELOGS:a$1._updateMessagesToView(s$1,t);break;case $t$1.EVENT_MESSAGE_SENT_PENDING:case $t$1.EVENT_MESSAGE_RECEIVED:case $t$1.SYNC_MESSAGE_FILL:a$1._addMessagesToView(s$1,t);}i.length>0&&a$1._removeMessagesFromView(i,t);}},onRemove:function(e,t){a$1._removeMessagesFromView(e,t);},onRemoveUnsent:function(e,t){a$1._removeUnsentMessageFromView(e,t);}});var u=St$1.of(this._iid).cacheContext;!this._channel.isSuper&&u.localCacheEnabled&&$n.of(this._iid,this._channel).resume(),tr.of(this._iid,this._channel).resume(),this._prevFill=new Yn(this._key,(function(e){return r(a$1,void 0,void 0,(function(){var t,n;return i(this,(function(r){switch(r.label){case 0:return [4,this._getRemoteMessages(e,{prevLimit:this._limit,source:$t$1.SYNC_MESSAGE_FILL})];case 1:return (t=r.sent()).length>0?(n=Math.min.apply(Math,a([],o(t.map((function(e){return e.createdAt}))),!1)),this._syncRange.extends(n),[2,{hasNext:t.length>=this._limit&&this.viewTop<n,nextToken:this._syncRange.top}]):[2,{hasNext:!1,nextToken:0}]}}))}))})),this._nextFill=new Yn(this._key,(function(e){return r(a$1,void 0,void 0,(function(){var t,n;return i(this,(function(r){switch(r.label){case 0:return [4,this._getRemoteMessages(e,{nextLimit:this._limit,source:$t$1.SYNC_MESSAGE_FILL})];case 1:return (t=r.sent()).length>0?(n=Math.max.apply(Math,a([],o(t.map((function(e){return e.createdAt}))),!1)),this._syncRange.extends(n),[2,{hasNext:!(t.length>=this._limit&&this._hasNext)||this.viewBottom>n,nextToken:this._syncRange.bottom}]):[2,{hasNext:!1,nextToken:0}]}}))}))}));var c=St$1.of(this._iid),p=c.dispatcher,m=c.logger;p.on((function(e){if(e instanceof de)if(e.stateType===J.CONNECTED)m.debug("check huge gap"),a$1._checkHugeGap();else a$1._prevFill.stop(),a$1._nextFill.stop();}));}return Object.defineProperty(e.prototype,"channel",{get:function(){return this._channel},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"succeededMessages",{get:function(){return a([],o(this._messages),!1)},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"failedMessages",{get:function(){return this._unsentMessages.filter((function(e){return e.sendingStatus===le.FAILED}))},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"pendingMessages",{get:function(){return this._unsentMessages.filter((function(e){return e.sendingStatus===le.PENDING}))},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"hasPrevious",{get:function(){return this._hasPrevious},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"hasNext",{get:function(){return this._hasNext},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"viewTop",{get:function(){return Math.min.apply(Math,a(a([],o(this._messages.map((function(e){return e.createdAt}))),!1),[Number.MAX_SAFE_INTEGER],!1))},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"viewBottom",{get:function(){return Math.max.apply(Math,a(a([],o(this._messages.map((function(e){return e.createdAt}))),!1),[0],!1))},enumerable:!1,configurable:!0}),e.prototype.setMessageCollectionHandler=function(e){this._handler=e;},e.prototype._filterUnderOffsetMessage=function(e){var t=this;return e.filter((function(e){return e.createdAt>=t._channel.messageOffsetTimestamp}))},e.prototype._addMessagesToView=function(e,t){var n,r$1,s$1=this,i$1=this._filterUnderOffsetMessage(e),a$1=[],o$1=[];try{for(var u=s(i$1),c=u.next();!c.done;c=u.next()){var p=c.value;if(p.messageId>0){if((E=or(this._messages,p))<0){var m=or(this._unsentMessages,p);m<0?a$1.push(p):(this._unsentMessages.splice(m,1),o$1.push(p));var v=ur(this._messages,p);this._messages.splice(v,0,p);}else o$1.push(p),this._messages[E]=p;if(this._readReceiptMap.set(p.messageId,this._channel.getUnreadMemberCount(p)),this._deliveryReceiptMap.set(p.messageId,this._channel.getUndeliveredMemberCount(p)),p.updatedAt>0){var g=this._updateChildMessagesInView(p);o$1.push.apply(o$1,a([],o(g),!1));}}else {var E;if(p instanceof xt$1)(E=or(this._unsentMessages,p))<0?or(this._messages,p)<0&&(this._unsentMessages.push(p),a$1.push(p)):(o$1.push(p),this._unsentMessages[E]=p);}}}catch(e){n={error:e};}finally{try{c&&!c.done&&(r$1=u.return)&&r$1.call(u);}finally{if(n)throw n.error}}an$1(t)&&Ie((function(){return r(s$1,void 0,void 0,(function(){var e;return i(this,(function(n){return e=new Xn(t),a$1.length>0&&this._handler.onMessagesAdded(e,this.channel,a$1),o$1.length>0&&this._handler.onMessagesUpdated(e,this.channel,o$1),[2]}))}))}));},e.prototype._updateChildMessagesInView=function(e){var t=[];return this._messages.forEach((function(n){n.applyParentMessage(e)&&t.push(n);})),t},e.prototype._updateMessagesToView=function(e,t){var n,r$1,s$1=this,i$1=[];try{for(var a=s(e),o=a.next();!o.done;o=a.next()){var u,c=o.value;if(c.messageId>0)if((u=or(this._messages,c))>=0)i$1.push(c),this._messages[u]=c;else {var l=or(this._unsentMessages,c);if(l>=0){i$1.push(c),this._unsentMessages.splice(l,1);var h=ur(this._messages,c);this._messages.splice(h,0,c);}}else if(c instanceof xt$1)(u=or(this._unsentMessages,c))>=0&&(i$1.push(c),this._unsentMessages[u]=c);}}catch(e){n={error:e};}finally{try{o&&!o.done&&(r$1=a.return)&&r$1.call(a);}finally{if(n)throw n.error}}return an$1(t)&&Ie((function(){return r(s$1,void 0,void 0,(function(){var e;return i(this,(function(n){return e=new Xn(t),i$1.length>0&&this._handler.onMessagesUpdated(e,this.channel,i$1),[2]}))}))})),i$1},e.prototype._removeMessagesFromView=function(e,t){var n,r$1,s$1=this,i$1=[],a=function(e){var t=o._messages.findIndex((function(t){return t.messageId===e}));t>=0&&(i$1.push(o._messages[t].messageId),o._messages.splice(t,1));},o=this;try{for(var u=s(e),c=u.next();!c.done;c=u.next()){a(c.value);}}catch(e){n={error:e};}finally{try{c&&!c.done&&(r$1=u.return)&&r$1.call(u);}finally{if(n)throw n.error}}return an$1(t)&&i$1.length>0&&Ie((function(){return r(s$1,void 0,void 0,(function(){var e;return i(this,(function(n){return e=new Xn(t),i$1.length>0&&this._handler.onMessagesDeleted(e,this.channel,i$1),[2]}))}))})),i$1},e.prototype._removeUnsentMessageFromView=function(e,t){var n=this._unsentMessages.findIndex((function(t){return t.reqId===e}));n>=0&&this._unsentMessages.splice(n,1);},e.prototype._getLocalMessages=function(e,t){var n=t.prevLimit,r$1=void 0===n?0:n,s=t.nextLimit,i$1=void 0===s?0:s;return r(this,void 0,void 0,(function(){var t,n,s,a$1,o$1,u,c;return i(this,(function(d){switch(d.label){case 0:return t=Bn.of(this._iid),r$1>0?[4,t.getMessagesFromCache(this._channel.url,e,"prev",this.filter,this._limit)]:[3,2];case 1:return s=d.sent(),[3,3];case 2:s=[],d.label=3;case 3:return n=s,i$1>0?[4,t.getMessagesFromCache(this._channel.url,e,"next",this.filter,this._limit)]:[3,5];case 4:return o$1=d.sent(),[3,6];case 5:o$1=[],d.label=6;case 6:if(a$1=o$1,n.length>0&&a$1.length)for(c in u=n.map((function(e){return e.messageId})),a$1)if(u.includes(a$1[c].messageId)){a$1.splice(parseInt(c),1);break}return [2,a(a([],o(n),!1),o(a$1),!1).sort((function(e,t){return t.createdAt-e.createdAt}))]}}))}))},e.prototype._getRemoteMessages=function(e,t){var n$1=t.prevLimit,r$1=void 0===n$1?0:n$1,i$1=t.nextLimit,a=void 0===i$1?0:i$1,o=t.source,u=void 0===o?$t$1.REQUEST_MESSAGE:o;return r(this,void 0,void 0,(function(){var t,n$1;return i(this,(function(i){switch(i.label){case 0:return t=En$1.of(this._iid),r$1>0||a>0?[4,t.getMessagesByTimestamp(this._channel.url,this._channel.channelType,e,n(n({},this.filter),{prevResultSize:r$1,nextResultSize:a,includeMetaArray:!0,includeReactions:!0,includeThreadInfo:!0}),u)]:[3,2];case 1:return n$1=i.sent(),[3,3];case 2:n$1=[],i.label=3;case 3:return [2,n$1]}}))}))},e.prototype._checkHugeGap=function(){return r(this,void 0,void 0,(function(){var e,t,n$1,r$1,i$1,a$1,o$1,u,c,f,p=this;return i(this,(function(m){switch(m.label){case 0:return this._messages.length>0?(e=this.viewTop,t=this._syncRange.top,n$1=this._syncRange.bottom,r$1=this.hasNext?this.viewBottom:Number.MAX_SAFE_INTEGER,[4,(i$1=Bn.of(this._iid)).getCachedMessageCountBetween(this._channel.url,this.filter,e,t)]):[3,4];case 1:return a$1=m.sent(),[4,i$1.getCachedMessageCountBetween(this._channel.url,this.filter,n$1,r$1)];case 2:return o$1=m.sent(),[4,Ee((function(){return r(p,void 0,void 0,(function(){var i$1,u,c,f,p,m,v,g,E,y,C,N,b,S,A,T,U,I=this;return i(this,(function(w){switch(w.label){case 0:return i$1=St$1.of(this._iid),u=i$1.dispatcher,c=i$1.requestQueue,f=new nr(n({channelUrl:this._channel.url,channelType:this._channel.channelType,prevStart:e,prevEnd:t,prevCount:a$1,nextStart:n$1,nextEnd:r$1,nextCount:o$1},this.filter)),[4,c.send(f)];case 1:return p=w.sent(),m=p.as(rr),v=m.isHugeGap,g=m.prevMessages,E=void 0===g?[]:g,y=m.prevHasMore,C=m.nextMessages,N=void 0===C?[]:C,b=m.nextHasmore,v?Ie((function(){return r(I,void 0,void 0,(function(){return i(this,(function(e){return this._handler.onHugeGapDetected(),[2]}))}))})):(this._hasPrevious=y,this._hasNext=b,S=this.viewTop,A=this.viewBottom,T=Math.min.apply(Math,a([Number.MAX_SAFE_INTEGER],o(E.map((function(e){return e.createdAt}))),!1)),U=Math.max.apply(Math,a([0],o(N.map((function(e){return e.createdAt}))),!1)),u.dispatch(new un$1({messages:E,source:$t$1.SYNC_MESSAGE_FILL})),u.dispatch(new un$1({messages:N,source:$t$1.SYNC_MESSAGE_FILL})),this._syncRange.extends(T,U),S<T&&this._prevFill.start(T),A>U&&this._nextFill.start(U)),[2]}}))}))}),1)];case 3:return m.sent(),[3,6];case 4:return u=Math.floor(this._limit/2),[4,this._getRemoteMessages(Date.now(),{prevLimit:u,nextLimit:u,source:$t$1.SYNC_MESSAGE_FILL})];case 5:(c=m.sent()).length>0&&((f=this._syncRange).extends.apply(f,a([],o(c.map((function(e){return e.createdAt}))),!1)),c.length<u&&(this._hasPrevious=!1,this._hasNext=!1)),m.label=6;case 6:return [2]}}))}))},e.prototype._loadAllFailedMessages=function(){return r(this,void 0,void 0,(function(){var e;return i(this,(function(t){switch(t.label){case 0:return [4,Bn.of(this._iid).getAllFailedMessagesFromCache(this._channel.url,this.filter)];case 1:return e=t.sent(),this._unsentMessages=e,[2,e]}}))}))},e.prototype.initialize=function(e){var t=this,n=new dr;this._messages=[],this._unsentMessages=[],this._syncRange=new Gn({}),this._hasNext=!0,this._hasPrevious=!0;var r=Math.floor(this._limit/2);if(e===Wn.CACHE_AND_REPLACE_BY_API)this._getLocalMessages(this._startingPoint,{prevLimit:r,nextLimit:r}).then((function(e){var r=t._filterUnderOffsetMessage(e);t._addMessagesToView(r,$t$1.REQUEST_MESSAGE),n._invokeResponse("local",null,r);})).catch((function(e){if(h(e))throw e;n._invokeResponse("local",e,null);})).finally((function(){t._loadAllFailedMessages(),t._getRemoteMessages(t._startingPoint,{prevLimit:r,nextLimit:r}).then((function(e){var s;t._messages=[];var i=t._filterUnderOffsetMessage(e);i.length<r&&(t._hasPrevious=!1,t._hasNext=!1),i.length>0&&((s=t._syncRange).extends.apply(s,a([],o(i.map((function(e){return e.createdAt}))),!1)),t._addMessagesToView(i,$t$1.REQUEST_MESSAGE)),n._invokeResponse("remote",null,i);})).catch((function(e){if(h(e))throw e;n._invokeResponse("remote",e,null);}));}));return n},e.prototype.loadPrevious=function(){return r(this,void 0,void 0,(function(){var e,t,n,r$1,s=this;return i(this,(function(i$1){switch(i$1.label){case 0:return this._hasPrevious?(e=this.viewTop,t=[],[4,Se((function(){return r(s,void 0,void 0,(function(){var n;return i(this,(function(r){switch(r.label){case 0:return n=this._filterUnderOffsetMessage,[4,this._getLocalMessages(e,{prevLimit:this._limit})];case 1:return t=n.apply(this,[r.sent()]),[2]}}))}))}))]):[3,5];case 1:return i$1.sent(),n=$n.of(this._iid,this._channel),0!==t.length&&n.isWrappingMessages(t)?[3,3]:[4,Se((function(){return r(s,void 0,void 0,(function(){var r,s;return i(this,(function(i){switch(i.label){case 0:return r=this._filterUnderOffsetMessage,[4,this._getRemoteMessages(e,{prevLimit:this._limit})];case 1:return t=r.apply(this,[i.sent()]),this._hasPrevious=t.length>=this._limit,t.length>0&&((s=this._syncRange).extends.apply(s,a([],o(t.map((function(e){return e.createdAt}))),!1)),n.range.overlap(this._syncRange)&&n.range.extends(this._syncRange.top)),[2]}}))}))}))];case 2:return i$1.sent(),this._addMessagesToView(t,$t$1.REQUEST_MESSAGE),[3,4];case 3:this._hasPrevious=t.length>=this._limit,t.length>0&&((r$1=this._syncRange).extends.apply(r$1,a([],o(t.map((function(e){return e.createdAt}))),!1)),this._addMessagesToView(t,$t$1.REQUEST_MESSAGE)),i$1.label=4;case 4:return [2,t];case 5:return [2,[]]}}))}))},e.prototype.loadNext=function(){return r(this,void 0,void 0,(function(){var e,t,n,r$1,s=this;return i(this,(function(i$1){switch(i$1.label){case 0:return e=this.viewBottom,t=[],[4,Se((function(){return r(s,void 0,void 0,(function(){var n;return i(this,(function(r){switch(r.label){case 0:return n=this._filterUnderOffsetMessage,[4,this._getLocalMessages(e,{nextLimit:this._limit})];case 1:return t=n.apply(this,[r.sent()]),[2]}}))}))}))];case 1:return i$1.sent(),n=$n.of(this._iid,this._channel),0!==t.length&&n.isWrappingMessages(t)?[3,3]:[4,Se((function(){return r(s,void 0,void 0,(function(){var r,s;return i(this,(function(i){switch(i.label){case 0:return r=this._filterUnderOffsetMessage,[4,this._getRemoteMessages(e,{nextLimit:this._limit})];case 1:return t=r.apply(this,[i.sent()]),this._hasNext=t.length>=this._limit,t.length>0&&((s=this._syncRange).extends.apply(s,a([],o(t.map((function(e){return e.createdAt}))),!1)),n.range.overlap(this._syncRange)&&n.range.extends(this._syncRange.bottom)),[2]}}))}))}))];case 2:return i$1.sent(),this._addMessagesToView(t,$t$1.REQUEST_MESSAGE),[3,4];case 3:this._hasNext=t.length>=this._limit,t.length>0&&((r$1=this._syncRange).extends.apply(r$1,a([],o(t.map((function(e){return e.createdAt}))),!1)),this._addMessagesToView(t,$t$1.REQUEST_MESSAGE)),i$1.label=4;case 4:return [2,t]}}))}))},e.prototype.removeFailedMessage=function(e){return r(this,void 0,void 0,(function(){var t;return i(this,(function(n){switch(n.label){case 0:return [4,Bn.of(this._iid).removeFailedMessageFromCache(e)];case 1:return n.sent(),(t=this._unsentMessages.findIndex((function(t){return t.reqId===e})))>-1&&this._unsentMessages.splice(t,1),[2]}}))}))},e.prototype.dispose=function(){var e=Bn.of(this._iid);e.unsubscribeGroupChannelEvent(this._key),e.unsubscribeMessageEvent(this._key);},e}(),fr={coverUrl:null,coverImage:null,isDistinct:null,isPublic:null,isDiscoverable:null,accessCode:null,name:null,data:null,customType:null,operatorUserIds:null,messageSurvivalSeconds:null},pr={hidePreviousMessages:!1,allowAutoUnhide:!0},mr=function(t$1){function n(e){var n=this,r=e.channelUrl,s=e.token,i=e.limit,a=e.order,o=e.mutedMemberFilter,u=e.memberStateFilter,c=e.nicknameStartsWithFilter,l=e.operatorFilter;return (n=t$1.call(this)||this).method=d.GET,n.path="".concat(qe,"/").concat(encodeURIComponent(r),"/members"),n.params={token:s,limit:i,order:a,muted_member_filter:o,member_state_filter:u,nickname_startswith:c,operator_filter:l,show_member_is_muted:!0,show_read_receipt:!0,show_delivery_receipt:!0},n}return t(n,t$1),n}(q),vr=function(t$1){function n(e,n){var r=t$1.call(this,e,n)||this;r.token=null,r.members=[];var s=n.next,i=n.members;return r.token=s,i&&i.length>0&&(r.members=i.map((function(t){return new It(e,t)}))),r}return t(n,t$1),n}(F);!function(e){e.ALL="all",e.MUTED="muted",e.UNMUTED="unmuted";}(cr||(cr={})),function(e){e.MEMBER_NICKNAME_ALPHABETICAL="member_nickname_alphabetical",e.OPERATOR_THEN_MEMBER_ALPHABETICAL="operator_then_member_alphabetical";}(lr||(lr={})),function(e){e.ALL="all",e.JOINED="joined_only",e.INVITED="invited_only",e.INVITED_BY_FRIEND="invited_by_friend",e.INVITED_BY_NON_FRIEND="invited_by_non_friend";}(hr||(hr={}));var gr=function(n$1){function r$1(e,t,r){var s,a,o,u,c=this;return (c=n$1.call(this,e,t,ne$1.GROUP,r)||this).mutedMemberFilter=cr.ALL,c.memberStateFilter=hr.ALL,c.nicknameStartsWithFilter=null,c.operatorFilter=At.ALL,c.order=lr.MEMBER_NICKNAME_ALPHABETICAL,c.mutedMemberFilter=null!==(s=r.mutedMemberFilter)&&void 0!==s?s:cr.ALL,c.memberStateFilter=null!==(a=r.memberStateFilter)&&void 0!==a?a:hr.ALL,c.nicknameStartsWithFilter=null!==(o=r.nicknameStartsWithFilter)&&void 0!==o?o:null,c.order=null!==(u=r.order)&&void 0!==u?u:lr.MEMBER_NICKNAME_ALPHABETICAL,c}return t(r$1,n$1),r$1.prototype._validate=function(){return n$1.prototype._validate.call(this)&&m(cr,this.mutedMemberFilter)&&m(hr,this.memberStateFilter)&&(y("string",this.nicknameStartsWithFilter)||null===this.nicknameStartsWithFilter)&&m(At,this.operatorFilter)&&m(lr,this.order)},r$1.prototype.next=function(){return r(this,void 0,void 0,(function(){var e,t,n$1,r,i$1,a;return i(this,(function(o){switch(o.label){case 0:return this._validate()?this._isLoading?[3,3]:this._hasNext?(this._isLoading=!0,e=St$1.of(this._iid).requestQueue,t=new mr(n(n({},this),{token:this._token})),[4,e.send(t)]):[3,2]:[3,5];case 1:return n$1=o.sent(),r=n$1.as(vr),i$1=r.members,a=r.token,this._token=a,this._hasNext=!!a,this._isLoading=!1,[2,i$1];case 2:return [2,[]];case 3:throw p.queryInProgress;case 4:return [3,6];case 5:throw p.invalidParameters;case 6:return [2]}}))}))},r$1}(On$1),Er=function(t$1){function n(e){var n=this,r=e.channelUrl,s=e.userId,i=e.accessCode;return (n=t$1.call(this)||this).method=d.PUT,n.path="".concat(qe,"/").concat(encodeURIComponent(r),"/accept"),n.params={user_id:s,access_code:i},n}return t(n,t$1),n}(q),yr=function(t$1){function n(e,n){var r=t$1.call(this,e,n)||this;return r.channel=new Vr(e,n),r.channel.myMemberState=yt.JOINED,r}return t(n,t$1),n}(F),Cr=function(t$1){function n(e){var n=this,s=e.channelUrl,i=e.isDistinct,a=e.isPublic,o=e.isDiscoverable,u=e.coverUrl,c=e.coverImage,l=e.accessCode,h=e.name,d$1=e.data,_=e.customType,f=e.operatorUserIds,p=e.messageSurvivalSeconds;return (n=t$1.call(this)||this).method=d.PUT,n.path="".concat(qe,"/").concat(encodeURIComponent(s)),n.params=U({is_distinct:i,is_public:a,is_discoverable:o,name:h,data:d$1,custom_type:_,cover_url:u,cover_file:c,access_code:l,operator_ids:f,message_survival_seconds:p}),n}return t(n,t$1),n}(q),Nr=function(t$1){function n(e,n){var r=t$1.call(this,e,n)||this;return r.channel=new Vr(e,n),r}return t(n,t$1),n}(F),br=function(t$1){function n(e){var n=this,r=e.channelUrl;return (n=t$1.call(this)||this).method=d.DELETE,n.path="".concat(qe,"/").concat(encodeURIComponent(r)),n}return t(n,t$1),n}(q);!function(t$1){function n(e,n){return t$1.call(this,e,n)||this}t(n,t$1);}(F);var Mr=function(t$1){function n(e){var n=this,r=e.channelUrl;return (n=t$1.call(this)||this).method=d.DELETE,n.path="".concat(qe,"/").concat(encodeURIComponent(r),"/hide"),n}return t(n,t$1),n}(q);!function(t$1){function n(){return null!==t$1&&t$1.apply(this,arguments)||this}t(n,t$1);}(F);var Sr=function(t$1){function n(e){var n=e.userId,r=e.channelUrl,s=e.countPreference,i=t$1.call(this)||this;return i.method=d.PUT,i.path="".concat(Ue$1,"/").concat(encodeURIComponent(n),"/count_preference/").concat(encodeURIComponent(r)),i.params={count_preference:s},i}return t(n,t$1),n}(q),Ar=function(t$1){function n(e,n){var r=t$1.call(this,e,n)||this;return r.countPreference=Or[n.count_preference],r}return t(n,t$1),n}(F),Tr=function(t$1){function n(e){var n=this,r=e.channelUrl;return (n=t$1.call(this)||this).method=d.PUT,n.path="".concat(qe,"/").concat(encodeURIComponent(r),"/reset_user_history"),n}return t(n,t$1),n}(q),Ur=function(t$1){function n(e,n){var r=t$1.call(this,e,n)||this;r.messageOffsetTimestamp=null;var s=n.ts_message_offset;return r.messageOffsetTimestamp=null!=s?s:null,r}return t(n,t$1),n}(F),Ir=n(n({},Ie$1),{scheduledAt:null,file:null,fileUrl:null,fileName:null,mimeType:null,fileSize:null,thumbnailSizes:null,requireAuth:!1}),wr=n(n({},we),{scheduledAt:null}),Dr=function(t$1){function n(e){var n,r=this;r=t$1.call(this)||this;var s=[];e.mentionType===ae$1.USERS&&(e.mentionedUserIds?s=e.mentionedUserIds:e.mentionedUsers&&(s=e.mentionedUsers.map((function(e){return e.userId}))));var i=e.channelType,a=e.channelUrl,o=e.scheduledMessageId;return r.method=d.PUT,r.path="".concat(We(i),"/").concat(encodeURIComponent(a),"/scheduled_messages/").concat(encodeURIComponent(o)),r.params={req_id:e.reqId,scheduled_at:e.scheduledAt,message_type:oe.FILE,url:e.fileUrl,file_name:e.fileName,file_size:e.fileSize,file_type:e.mimeType,thumbnails:e.thumbnailSizes?e.thumbnailSizes.map((function(e){return Gt$1.payloadify(e)})):[],custom_type:e.customType,data:e.data,require_auth:e.requireAuth,mention_type:e.mentionType,mentioned_user_ids:s,sorted_metaarray:null===(n=e.metaArrays)||void 0===n?void 0:n.map((function(e){return Dt$1.payloadify(e)})),apple_critical_alert_options:Lt$1.payloadify(e.appleCriticalAlertOptions),push_option:e.pushNotificationDeliveryOption},r}return t(n,t$1),n}(q),Lr=function(t$1){function n(e,n){var r=t$1.call(this,e,n)||this;return r.message=new Wt$1(e,n),r}return t(n,t$1),n}(F),Rr=function(t$1){function n(e){var n,r=this;r=t$1.call(this)||this;var s=[];e.mentionType===ae$1.USERS&&(e.mentionedUserIds?s=e.mentionedUserIds:e.mentionedUsers&&(s=e.mentionedUsers.map((function(e){return e.userId}))));var i=e.channelType,a=e.channelUrl,o=e.scheduledMessageId;return r.method=d.PUT,r.path="".concat(We(i),"/").concat(encodeURIComponent(a),"/scheduled_messages/").concat(encodeURIComponent(o)),r.params={req_id:e.reqId,scheduled_at:e.scheduledAt,message_type:oe.USER,message:e.message,custom_type:e.customType,data:e.data,mention_type:e.mentionType,mentioned_user_ids:s,sorted_metaarray:null===(n=e.metaArrays)||void 0===n?void 0:n.map((function(e){return Dt$1.payloadify(e)})),apple_critical_alert_options:Lt$1.payloadify(e.appleCriticalAlertOptions),target_langs:e.translationTargetLanguages,push_option:e.pushNotificationDeliveryOption},r}return t(n,t$1),n}(q);!function(t$1){function n(e,n){var r=t$1.call(this,e,n)||this;return r.message=new Vt$1(e,n),r}t(n,t$1);}(F);var Or,kr,Fr,Pr=function(t$1){function n(e){var n=t$1.call(this)||this,r=e.channelType,s=e.channelUrl,i=e.scheduledMessageId;return n.method=d.DELETE,n.path="".concat(We(r),"/").concat(encodeURIComponent(s),"/scheduled_messages/").concat(encodeURIComponent(i)),n}return t(n,t$1),n}(q),xr=function(t$1){function n(e){var n=t$1.call(this)||this,r=e.channelType,s=e.channelUrl,i=e.scheduledMessageId;return n.method=d.POST,n.path="".concat(We(r),"/").concat(encodeURIComponent(s),"/scheduled_messages/").concat(encodeURIComponent(i),"/send_now"),n}return t(n,t$1),n}(q);!function(e){e.ALL="all",e.UNREAD_MESSAGE_COUNT_ONLY="unread_message_count_only",e.UNREAD_MENTION_COUNT_ONLY="unread_mention_count_only",e.OFF="off";}(Or||(Or={})),function(e){e.MUTED="muted",e.UNMUTED="unmuted";}(kr||(kr={})),function(e){e.UNHIDDEN="unhidden",e.HIDDEN_ALLOW_AUTO_UNHIDE="hidden_allow_auto_unhide",e.HIDDEN_PREVENT_AUTO_UNHIDE="hidden_prevent_auto_unhide";}(Fr||(Fr={}));var Hr,Vr=function(o$1){function u(e,r){var u,c,d,_,f,p,v,g,E,y$1,C,N,b,M,S,A,T,U,I=this;return (I=o$1.call(this,e,r)||this)._unreadMemberStateMap=new Map,I._undeliveredMemberStateMap=new Map,I._typingStatus=new Map,I._lastMemberCountUpdated=0,I._typingStarted=0,I._typingEnded=0,I.isDistinct=!1,I.isSuper=!1,I.isBroadcast=!1,I.isExclusive=!1,I.isPublic=!1,I.isDiscoverable=!0,I.isAccessCodeRequired=!1,I.isPushEnabled=!1,I.unreadMessageCount=0,I.unreadMentionCount=0,I.members=[],I.memberCount=0,I.joinedMemberCount=0,I.hiddenState=Fr.UNHIDDEN,I.lastMessage=null,I.messageOffsetTimestamp=0,I.messageSurvivalSeconds=-1,I.myMemberState=yt.NONE,I.myRole=re$1.NONE,I.myMutedState=kr.UNMUTED,I.myLastRead=0,I.myCountPreference=Or.ALL,I.myPushTriggerOption=H$1.DEFAULT,I.inviter=null,I.invitedAt=0,I.joinedAt=0,I.channelType=ne$1.GROUP,I.isDistinct=null!==(c=r.is_distinct)&&void 0!==c&&c,I.isSuper=null!==(d=r.is_super)&&void 0!==d&&d,I.isBroadcast=null!==(_=r.is_broadcast)&&void 0!==_&&_,I.isExclusive=null!==(f=r.is_exclusive)&&void 0!==f&&f,I.isPublic=null!==(p=r.is_public)&&void 0!==p&&p,I.isDiscoverable=null!==(v=r.is_discoverable)&&void 0!==v?v:I.isPublic,I.isAccessCodeRequired=null!==(g=r.is_access_code_required)&&void 0!==g&&g,I.isPushEnabled=null!==(E=r.is_push_enabled)&&void 0!==E&&E,Array.isArray(r.members)&&(u=I.members).push.apply(u,a([],o(r.members.map((function(e){return new It(I._iid,e)}))),!1)),I.memberCount=null!==(y$1=r.member_count)&&void 0!==y$1?y$1:0,I.joinedMemberCount=null!==(C=r.joined_member_count)&&void 0!==C?C:0,I.hiddenState=m(Fr,r.hidden_state)?r.hidden_state:Fr.UNHIDDEN,I.messageOffsetTimestamp=null!==(N=r.ts_message_offset)&&void 0!==N?N:0,I.messageSurvivalSeconds=null!==(b=r.message_survival_seconds)&&void 0!==b?b:-1,I.lastMessage=r.last_message?Ht$1(I._iid,n({channel_type:I.channelType},r.last_message)):null,r.read_receipt&&Object.keys(r.read_receipt).forEach((function(e){y("number",r.read_receipt[e])&&I._updateUnreadMemberState(e,r.read_receipt[e]);})),r.delivery_receipt&&Object.keys(r.delivery_receipt).forEach((function(e){y("number",r.delivery_receipt[e])&&I._updateUndeliveredMemberState(e,r.delivery_receipt[e]);})),I.myMemberState=m(yt,r.member_state)?r.member_state:yt.NONE,I.myRole=m(re$1,r.my_role)?r.my_role:re$1.NONE,m(kr,r.is_muted)?I.myMutedState=r.is_muted:y("boolean",r.is_muted)?I.myMutedState=r.is_muted?kr.MUTED:kr.UNMUTED:I.myMutedState=kr.UNMUTED,I.myCountPreference=m(Or,r.count_preference)?r.count_preference:Or.ALL,I.myPushTriggerOption=m(H$1,r.push_trigger_option)?r.push_trigger_option:H$1.ALL,I.myLastRead=null!==(M=r.user_last_read)&&void 0!==M?M:0,I.inviter=r.inviter?new ct(I._iid,r.inviter):null,I.invitedAt=null!==(S=r.invited_at)&&void 0!==S?S:0,I.joinedAt=null!==(A=r.joined_ts)&&void 0!==A?A:0,I._updateUnreadCount(null!==(T=r.unread_message_count)&&void 0!==T?T:0,null!==(U=r.unread_mention_count)&&void 0!==U?U:0),I}return t(u,o$1),Object.defineProperty(u.prototype,"isHidden",{get:function(){return this.hiddenState!==Fr.UNHIDDEN},enumerable:!1,configurable:!0}),Object.defineProperty(u.prototype,"isTyping",{get:function(){return Object.keys(this._typingStatus).length>0},enumerable:!1,configurable:!0}),Object.defineProperty(u.prototype,"cachedUnreadMemberState",{get:function(){var e,t,n={};try{for(var r=s(this._unreadMemberStateMap),s$1=r.next();!s$1.done;s$1=r.next()){var i=o(s$1.value,2),a=i[0],o$1=i[1];n[a]=o$1;}}catch(t){e={error:t};}finally{try{s$1&&!s$1.done&&(t=r.return)&&t.call(r);}finally{if(e)throw e.error}}return n},enumerable:!1,configurable:!0}),Object.defineProperty(u.prototype,"cachedUndeliveredMemberState",{get:function(){var e,t,n={};try{for(var r=s(this._undeliveredMemberStateMap),s$1=r.next();!s$1.done;s$1=r.next()){var i=o(s$1.value,2),a=i[0],o$1=i[1];n[a]=o$1;}}catch(t){e={error:t};}finally{try{s$1&&!s$1.done&&(t=r.return)&&t.call(r);}finally{if(e)throw e.error}}return n},enumerable:!1,configurable:!0}),u.payloadify=function(e){return e?U(n(n({},o$1.payloadify.call(this,e)),{is_access_code_required:e.isAccessCodeRequired,is_distinct:e.isDistinct,is_super:e.isSuper,is_broadcast:e.isBroadcast,is_exclusive:e.isExclusive,is_public:e.isPublic,is_discoverable:e.isDiscoverable,is_muted:e.myMutedState,is_push_enabled:e.isPushEnabled,unread_message_count:e.unreadMessageCount,unread_mention_count:e.unreadMentionCount,push_trigger_option:e.myPushTriggerOption,count_preference:e.myCountPreference,hidden_state:e.hiddenState,member_count:e.memberCount,joined_member_count:e.joinedMemberCount,member_state:e.myMemberState,my_role:e.myRole,user_last_read:e.myLastRead,ts_message_offset:e.messageOffsetTimestamp,message_survival_seconds:e.messageSurvivalSeconds,read_receipt:e.cachedUnreadMemberState,delivery_receipt:e.cachedUndeliveredMemberState,members:e.members.map((function(e){return It.payloadify(e)})),last_message:Bt$1(e.lastMessage),inviter:e.inviter?ct.payloadify(e.inviter):null,invited_at:e.invitedAt,joined_ts:e.joinedAt})):null},u.prototype._updateUnreadCount=function(e,t){if("number"==typeof e&&e>=0)if(this.myCountPreference===Or.ALL||this.myCountPreference===Or.UNREAD_MESSAGE_COUNT_ONLY)if(this.isExclusive||this.isSuper||this.isBroadcast){var n=St$1.of(this._iid).maxSuperGroupChannelUnreadCount;this.unreadMessageCount=n&&e>=n?n:e;}else this.unreadMessageCount=e;else this.unreadMessageCount=0;else this.unreadMessageCount=0;"number"==typeof t&&t>=0&&(this.myCountPreference===Or.ALL||this.myCountPreference===Or.UNREAD_MENTION_COUNT_ONLY)?this.unreadMentionCount=t:this.unreadMentionCount=0;},u.prototype._updateUnreadMemberState=function(e,t){var n=this._unreadMemberStateMap.get(e);return (!n||n<t)&&(this._unreadMemberStateMap.set(e,t),St$1.of(this._iid).sdkState.userId===e&&(this.myLastRead=t),!0)},u.prototype._updateUndeliveredMemberState=function(e,t){var n=this._undeliveredMemberStateMap.get(e);(!n||n<t)&&this._undeliveredMemberStateMap.set(e,t);},u.prototype._updateTypingStatus=function(e,t){void 0===t&&(t=(new Date).getTime()),t>0?this._typingStatus[e.userId]={user:e,ts:t}:delete this._typingStatus[e.userId];},u.prototype._invalidateTypingStatus=function(){var e=(new Date).getTime(),t=!1;for(var n in this._typingStatus){e-this._typingStatus[n].ts>=1e4&&(delete this._typingStatus[n],t=!0);}return t},u.prototype._setLatestMemberCount=function(e,t,n){var r=!1;return n>=this._lastMemberCountUpdated&&(this._lastMemberCountUpdated=n,r=e!==this.memberCount||t!==this.joinedMemberCount,this.memberCount=e,this.joinedMemberCount=t),r},u.prototype.isReadMessage=function(e){var t=St$1.of(this._iid).sdkState,n=this._unreadMemberStateMap.get(t.userId);return n&&n>=e.createdAt},u.prototype.serialize=function(){var e=this;return st(this,(function(t){t.cachedUnreadMemberState=e.cachedUnreadMemberState,t.cachedUndeliveredMemberState=e.cachedUndeliveredMemberState;}))},u.prototype.createMessageCollection=function(e){return void 0===e&&(e={}),new _r(this._iid,n({channel:this},e))},u.prototype.createMemberListQuery=function(e){return void 0===e&&(e={}),new gr(this._iid,this.url,e)},u.prototype.addMember=function(e,t){if(void 0===t&&(t=0),!this.isExclusive&&!this.isSuper&&!this.isBroadcast){var n=this.members.findIndex((function(t){return t.userId===e.userId}));if(n>-1){var r=this.members[n];r.state===yt.JOINED&&(e.state=r.state),this.members.splice(n,1),this.memberCount--;}this.members.push(e),this.memberCount++,this._updateUnreadMemberState(e.userId,t),this._updateUndeliveredMemberState(e.userId,t);}},u.prototype.removeMember=function(e){if(!this.isExclusive&&!this.isSuper&&!this.isBroadcast){var t=this.members.findIndex((function(t){return t.userId===e.userId}));if(t>-1)return this.members.splice(t,1),this.memberCount--,!0}return !1},u.prototype.getUnreadMemberCount=function(e){var t,n;if(e instanceof xt$1&&!this.isExclusive&&!this.isSuper&&!this.isBroadcast){var r=St$1.of(this._iid).sdkState,s$1=e.createdAt,i=0;try{for(var a=s(this.members),o=a.next();!o.done;o=a.next()){var u=o.value;if(r.userId!==u.userId&&u.state===yt.JOINED&&e.sender.userId!==u.userId)(this.cachedUnreadMemberState[u.userId]||0)<s$1&&i++;}}catch(e){t={error:e};}finally{try{o&&!o.done&&(n=a.return)&&n.call(a);}finally{if(t)throw t.error}}return i}return 0},u.prototype.getUndeliveredMemberCount=function(e){var t,n;if(e instanceof xt$1&&!this.isExclusive&&!this.isSuper&&!this.isBroadcast){var r=St$1.of(this._iid).sdkState,s$1=e.createdAt,i=0;try{for(var a=s(this.members),o=a.next();!o.done;o=a.next()){var u=o.value;if(r.userId!==u.userId&&u.state===yt.JOINED&&e.sender.userId!==u.userId)(this.cachedUndeliveredMemberState[u.userId]||0)<s$1&&i++;}}catch(e){t={error:e};}finally{try{o&&!o.done&&(n=a.return)&&n.call(a);}finally{if(t)throw t.error}}return i}return 0},u.prototype.getReadMembers=function(e,t){var n=this;void 0===t&&(t=!1);var r=St$1.of(this._iid).sdkState;if(!r.userId||this.isExclusive||this.isSuper||this.isBroadcast)return [];var s=[];return this.members.forEach((function(i){(t||i.userId!==r.userId&&i.userId!==e.sender.userId)&&(n._unreadMemberStateMap.get(i.userId)>=e.createdAt&&s.push(i));})),s},u.prototype.getUnreadMembers=function(e,t){var n=this;void 0===t&&(t=!1);var r=St$1.of(this._iid).sdkState;if(!r.userId||this.isExclusive||this.isSuper||this.isBroadcast)return [];var s=[];return this.members.forEach((function(i){(t||i.userId!==r.userId&&i.userId!==e.sender.userId)&&(n._unreadMemberStateMap.get(i.userId)<e.createdAt&&s.push(i));})),s},u.prototype.getReadStatus=function(e){var t=this;void 0===e&&(e=!1);var n=St$1.of(this._iid).sdkState;if(!n.userId||this.isExclusive||this.isSuper||this.isBroadcast)return null;var r={};return this.members.forEach((function(s){if(e||s.userId!==n.userId){var i=t._unreadMemberStateMap.get(s.userId);r[s.userId]=new wt(t._iid,{channel_url:t.url,channel_type:t.channelType,user:It.payloadify(s),ts:i});}})),r},u.prototype.getTypingUsers=function(){var e=[];for(var t in this._typingStatus){var n=this._typingStatus[t].user;e.push(n);}return e},u.prototype.invalidateTypingStatus=function(){var e=St$1.of(this._iid).typingIndicatorInvalidateTime,t=(new Date).getTime(),n=!1;for(var r in this._typingStatus){t-this._typingStatus[r].ts>=e&&(delete this._typingStatus[r],n=!0);}return n},u.prototype.refresh=function(){return r(this,void 0,void 0,(function(){var e,t,n,r,s,i$1;return i(this,(function(a){switch(a.label){case 0:return e=St$1.of(this._iid),t=e.requestQueue,n=e.dispatcher,r=new Xt({channelUrl:this.url}),[4,t.send(r)];case 1:return s=a.sent(),i$1=s.as(Zt).channel,n.dispatch(new jt({channels:[i$1],source:Vt.REQUEST_CHANNEL})),[2,i$1]}}))}))},u.prototype.freeze=function(){return r(this,void 0,void 0,(function(){return i(this,(function(e){switch(e.label){case 0:return [4,o$1.prototype.freeze.call(this)];case 1:return e.sent(),St$1.of(this._iid).dispatcher.dispatch(new jt({channels:[this],source:Vt.EVENT_CHANNEL_HIDDEN})),[2]}}))}))},u.prototype.unfreeze=function(){return r(this,void 0,void 0,(function(){return i(this,(function(e){switch(e.label){case 0:return [4,o$1.prototype.unfreeze.call(this)];case 1:return e.sent(),St$1.of(this._iid).dispatcher.dispatch(new jt({channels:[this],source:Vt.EVENT_CHANNEL_UNHIDDEN})),[2]}}))}))},u.prototype.updateChannel=function(e){return r(this,void 0,void 0,(function(){var t,n$1,r,i$1,a,o;return i(this,(function(u){switch(u.label){case 0:return e=n(n({},fr),e),at(function(e){return y("string",e.coverUrl,!0)&&(S(e.coverImage)||y("string",e.coverImage)||null===e.coverImage)&&y("boolean",e.isDistinct,!0)&&y("boolean",e.isPublic,!0)&&y("boolean",e.isDiscoverable,!0)&&y("string",e.accessCode,!0)&&y("string",e.name,!0)&&y("string",e.data,!0)&&y("string",e.customType,!0)&&E("string",e.operatorUserIds,!0)&&y("number",e.messageSurvivalSeconds,!0)}(e)).throw(p.invalidParameters),t=St$1.of(this._iid),n$1=t.dispatcher,r=t.requestQueue,i$1=new Cr(n({channelUrl:this.url},e)),[4,r.send(i$1)];case 1:return a=u.sent(),o=a.as(Nr).channel,n$1.dispatch(new jt({channels:[o],source:Vt.EVENT_CHANNEL_UPDATED})),[2,o]}}))}))},u.prototype.invite=function(e){return r(this,void 0,void 0,(function(){return i(this,(function(t){return at(e.every((function(e){return e instanceof ct}))).throw(p.invalidParameters),[2,this.inviteWithUserIds(e.map((function(e){return e.userId})))]}))}))},u.prototype.inviteWithUserIds=function(e){return r(this,void 0,void 0,(function(){var t,n,r,s,i$1,a;return i(this,(function(o){switch(o.label){case 0:return at(E("string",e)).throw(p.invalidParameters),t=St$1.of(this._iid),n=t.dispatcher,r=t.requestQueue,s=new Cn({channelUrl:this.url,userIds:e}),[4,r.send(s)];case 1:return i$1=o.sent(),a=i$1.as(Nn).channel,n.dispatch(new jt({channels:[a],source:Vt.EVENT_CHANNEL_INVITED})),[2,a]}}))}))},u.prototype.join=function(e){return void 0===e&&(e=null),r(this,void 0,void 0,(function(){var t,n,r,s,i$1,a,o;return i(this,(function(u){switch(u.label){case 0:return at(y("string",e)||null===e).throw(p.invalidParameters),t=St$1.of(this._iid),n=t.dispatcher,r=t.sdkState,s=t.requestQueue,i$1=new mn({channelUrl:this.url,userId:r.userId,accessCode:e}),[4,s.send(i$1)];case 1:return a=u.sent(),(o=a.as(vn).channel).myMemberState=yt.JOINED,n.dispatch(new jt({channels:[o],source:Vt.EVENT_CHANNEL_JOINED})),[2,this]}}))}))},u.prototype.leave=function(e){return void 0===e&&(e=!1),r(this,void 0,void 0,(function(){var t,n,r,s;return i(this,(function(i){switch(i.label){case 0:return t=St$1.of(this._iid),n=t.sdkState,r=t.requestQueue,s=new En({channelUrl:this.url,userId:n.userId,shouldRemoveOperatorStatus:e}),[4,r.send(s)];case 1:return i.sent(),[2]}}))}))},u.prototype.acceptInvitation=function(e){return void 0===e&&(e=null),r(this,void 0,void 0,(function(){var t,n,r,s,i$1,a,o;return i(this,(function(u){switch(u.label){case 0:return at(y("string",e)||null===e).throw(p.invalidParameters),t=St$1.of(this._iid),n=t.dispatcher,r=t.sdkState,s=t.requestQueue,i$1=new Er({channelUrl:this.url,userId:r.userId,accessCode:e}),[4,s.send(i$1)];case 1:return a=u.sent(),(o=a.as(yr).channel).myMemberState=yt.JOINED,n.dispatch(new jt({channels:[o],source:Vt.EVENT_CHANNEL_ACCEPTED_INVITE})),[2,o]}}))}))},u.prototype.declineInvitation=function(){return r(this,void 0,void 0,(function(){var e,t,n,r,s,i$1;return i(this,(function(a){switch(a.label){case 0:return e=St$1.of(this._iid),t=e.sdkState,n=e.requestQueue,r=new Mn({channelUrl:this.url,userId:t.userId}),[4,n.send(r)];case 1:return s=a.sent(),(i$1=s.as(Sn).channel).myMemberState=yt.NONE,[2,i$1]}}))}))},u.prototype.sendUserMessage=function(e){var t=this,n=new In$1,r=St$1.of(this._iid).dispatcher,s=pe.of(this._iid);return o$1.prototype.sendUserMessage.call(this,e).onPending((function(e){s.completeCurrentAndProcessNextAutoResend(e),n._trigger(null,e);})).onFailed((function(e,t){t&&s.completeCurrentAndProcessNextAutoResend(t),n._trigger(e,t);})).onSucceeded((function(e){var i=Bn.of(t._iid);s.completeCurrentAndProcessNextAutoResend(e),t.lastMessage=e,i.handlers.map((function(e){return e.onChannelChanged(t)})),r.dispatch(new jt({channels:[t],source:Vt.EVENT_MESSAGE_SENT})),n._trigger(null,e);})),n},u.prototype._autoResendUserMessage=function(e){var t=this,n=new In$1,r=St$1.of(this._iid).dispatcher,s=pe.of(this._iid);return o$1.prototype._autoResendUserMessage.call(this,e).onPending((function(e){s.completeCurrentAndProcessNextAutoResend(e),n._trigger(null,e);})).onFailed((function(e,t){s.completeCurrentAndProcessNextAutoResend(t),n._trigger(e,t);})).onSucceeded((function(e){var i=Bn.of(t._iid);s.completeCurrentAndProcessNextAutoResend(e),t.lastMessage=e,i.handlers.map((function(e){return e.onChannelChanged(t)})),r.dispatch(new jt({channels:[t],source:Vt.EVENT_MESSAGE_SENT})),n._trigger(null,e);})),n},u.prototype.sendFileMessage=function(e){var t=this,n=new In$1,r=St$1.of(this._iid).dispatcher,s=pe.of(this._iid);return o$1.prototype.sendFileMessage.call(this,e).onPending((function(e){s.completeCurrentAndProcessNextAutoResend(e),n._trigger(null,e);})).onFailed((function(e,t){t&&s.completeCurrentAndProcessNextAutoResend(t),n._trigger(e,t);})).onSucceeded((function(e){var i=Bn.of(t._iid);s.completeCurrentAndProcessNextAutoResend(e),t.lastMessage=e,i.handlers.map((function(e){return e.onChannelChanged(t)})),r.dispatch(new jt({channels:[t],source:Vt.EVENT_MESSAGE_SENT})),n._trigger(null,e);})),n},u.prototype._autoResendFileMessage=function(e){var t=this,n=new In$1,r=St$1.of(this._iid).dispatcher,s=pe.of(this._iid);return o$1.prototype._autoResendFileMessage.call(this,e).onPending((function(e){s.completeCurrentAndProcessNextAutoResend(e),n._trigger(null,e);})).onFailed((function(e,t){s.completeCurrentAndProcessNextAutoResend(t),n._trigger(e,t);})).onSucceeded((function(e){var i=Bn.of(t._iid);s.completeCurrentAndProcessNextAutoResend(e),t.lastMessage=e,i.handlers.map((function(e){return e.onChannelChanged(t)})),r.dispatch(new jt({channels:[t],source:Vt.EVENT_MESSAGE_SENT})),n._trigger(null,e);})),n},u.prototype.deleteMessage=function(e){return r(this,void 0,void 0,(function(){return i(this,(function(t){switch(t.label){case 0:return [4,o$1.prototype.deleteMessage.call(this,e)];case 1:return t.sent(),0===e.messageId&&St$1.of(this._iid).dispatcher.dispatch(new ln$1({reqId:e.reqId,source:$t$1.EVENT_MESSAGE_DELETED})),[2]}}))}))},u.prototype.hide=function(e){return r(this,void 0,void 0,(function(){var t,n$1,r,i$1,a,o,u;return i(this,(function(c){switch(c.label){case 0:return e=n(n({},pr),e),at(function(e){return y("boolean",e.hidePreviousMessages)&&y("boolean",e.allowAutoUnhide)}(e)).throw(p.invalidParameters),t=St$1.of(this._iid),n$1=t.dispatcher,r=t.sdkState,i$1=t.requestQueue,a=new Ln(n({channelUrl:this.url,userId:r.userId},e)),[4,i$1.send(a)];case 1:return o=c.sent(),u=o.as(Rn).messageOffsetTimestamp,this.hiddenState=e.allowAutoUnhide?Fr.HIDDEN_ALLOW_AUTO_UNHIDE:Fr.HIDDEN_PREVENT_AUTO_UNHIDE,e.hidePreviousMessages&&this._updateUnreadCount(0,0),u&&(this.messageOffsetTimestamp=u),n$1.dispatch(new jt({channels:[this],source:Vt.EVENT_CHANNEL_HIDDEN})),[2,this]}}))}))},u.prototype.unhide=function(){return r(this,void 0,void 0,(function(){var e,t,n,r;return i(this,(function(s){switch(s.label){case 0:return e=St$1.of(this._iid),t=e.dispatcher,n=e.requestQueue,r=new Mr({channelUrl:this.url}),[4,n.send(r)];case 1:return s.sent(),this.hiddenState=Fr.UNHIDDEN,t.dispatch(new jt({channels:[this],source:Vt.EVENT_CHANNEL_UNHIDDEN})),[2,this]}}))}))},u.prototype.delete=function(){return r(this,void 0,void 0,(function(){var e,t;return i(this,(function(n){switch(n.label){case 0:return e=St$1.of(this._iid).requestQueue,t=new br({channelUrl:this.url}),[4,e.send(t)];case 1:return n.sent(),[2]}}))}))},u.prototype.markAsRead=function(){return r(this,void 0,void 0,(function(){var e,t,n,r,s,i$1,a,o=this;return i(this,(function(u){switch(u.label){case 0:return e=St$1.of(this._iid),t=e.sdkState,n=e.dispatcher,r=e.requestQueue,s=new Tn({channelUrl:this.url}),[4,r.send(s)];case 1:return i$1=u.sent(),a=i$1.as(Un).readStatus,this._updateUnreadMemberState(t.userId,a.readAt),(this.unreadMessageCount>0||this.unreadMentionCount>0)&&(this._updateUnreadCount(0,0),Bn.of(this._iid).handlers.map((function(e){return e.onChannelChanged(o)}))),n.dispatch(new jt({channels:[this],source:Vt.EVENT_CHANNEL_READ})),[2]}}))}))},u.prototype.markAsDelivered=function(){return r(this,void 0,void 0,(function(){var e,t,n,r;return i(this,(function(s){switch(s.label){case 0:return e=St$1.of(this._iid),t=e.sdkState,n=e.requestQueue,r=new In({channelUrl:this.url,userId:t.userId}),[4,n.send(r)];case 1:return s.sent(),[2]}}))}))},u.prototype.startTyping=function(){return r(this,void 0,void 0,(function(){var e,t,n,r,s;return i(this,(function(i){return e=St$1.of(this._iid),t=e.requestQueue,n=e.typingIndicatorThrottle,(r=(new Date).getTime())-this._typingStarted>=n&&(this._typingStarted=r,this._typingEnded=0,s=new kn({channelUrl:this.url,time:this._typingStarted}),t.send(s)),[2]}))}))},u.prototype.endTyping=function(){return r(this,void 0,void 0,(function(){var e,t,n,r,s;return i(this,(function(i){return e=St$1.of(this._iid),t=e.requestQueue,n=e.typingIndicatorThrottle,(r=(new Date).getTime())-this._typingEnded>=n&&(this._typingStarted=0,this._typingEnded=r,s=new Pn({channelUrl:this.url,time:this._typingStarted}),t.send(s)),[2]}))}))},u.prototype.createScheduledUserMessage=function(e){e=n(n({},ne),e),at(re(e)).throw(p.invalidParameters);var t=new In$1;return this._createScheduledUserMessage(e,t),t},u.prototype.updateScheduledUserMessage=function(e,t){return r(this,void 0,void 0,(function(){var n$1,r,i$1;return i(this,(function(a){switch(a.label){case 0:return t=n(n({},wr),t),at(function(e){return Me(e)&&y("number",e.scheduledAt,!0)}(t)).throw(p.invalidParameters),n$1=St$1.of(this._iid).requestQueue,r=new Rr(n({reqId:this._generateRequestId(),scheduledMessageId:e,channelType:this.channelType,channelUrl:this.url},t)),[4,n$1.send(r)];case 1:return i$1=a.sent(),[2,i$1.as(Rt$1).message]}}))}))},u.prototype.createScheduledFileMessage=function(e){var t=this;e=n(n({},ae),e),at(ie(e)).throw(p.invalidParameters);var n$1=St$1.of(this._iid).dispatcher,r$1=Date.now(),i$1=this._generateRequestId(),a=new In$1;return me(Ot$2).then((function(){var s=t._createPendingScheduledFileMessage(e,i$1,r$1);n$1.dispatch(new un$1({messages:[s],source:$t$1.EVENT_MESSAGE_SENT_PENDING})),Ie((function(){return r(t,void 0,void 0,(function(){return i(this,(function(e){return [2,a._trigger(null,s)]}))}))}));})),S(e.file)?this._uploadFileAndUpdateParams(e).then((function(){return t._createScheduledFileMessage(e,a,i$1,r$1)})):this._createScheduledFileMessage(e,a,i$1,r$1),a},u.prototype.updateScheduledFileMessage=function(e,t){return r(this,void 0,void 0,(function(){var n$1,r;return i(this,(function(i){switch(i.label){case 0:return t=n(n({},Ir),t),at(function(e){return Ee$1(e)&&y("number",e.scheduledAt,!0)&&(S(e.file)||y("string",e.fileUrl))&&y("string",e.fileName,!0)&&y("string",e.mimeType,!0)&&y("number",e.fileSize,!0)&&(null===e.thumbnailSizes||e.thumbnailSizes.every((function(e){return y("object",e)&&e.maxWidth>0&&e.maxHeight>0})))}(t)).throw(p.invalidParameters),S(t.file)?[4,this._uploadFileAndUpdateParams(t)]:[3,2];case 1:i.sent(),i.label=2;case 2:return n$1=new Dr(n(n({reqId:this._generateRequestId(),scheduledMessageId:e,channelType:this.channelType,channelUrl:this.url},t),{fileUrl:t.fileUrl,requireAuth:t.requireAuth})),[4,St$1.of(this._iid).requestQueue.send(n$1)];case 3:return r=i.sent(),[2,r.as(Lr).message]}}))}))},u.prototype.cancelScheduledMessage=function(e){return r(this,void 0,void 0,(function(){var t;return i(this,(function(n){switch(n.label){case 0:return t=new Pr({scheduledMessageId:e,channelType:this.channelType,channelUrl:this.url}),[4,St$1.of(this._iid).requestQueue.send(t)];case 1:return n.sent(),[2]}}))}))},u.prototype.sendScheduledMessageNow=function(e){return r(this,void 0,void 0,(function(){var t;return i(this,(function(n){switch(n.label){case 0:return t=new xr({scheduledMessageId:e,channelType:this.channelType,channelUrl:this.url}),[4,St$1.of(this._iid).requestQueue.send(t)];case 1:return n.sent(),[2]}}))}))},u.prototype.getMyPushTriggerOption=function(){return r(this,void 0,void 0,(function(){var e,t,n,r,s;return i(this,(function(i){switch(i.label){case 0:return e=St$1.of(this._iid),t=e.sdkState,n=e.requestQueue,r=new _e({userId:t.userId}),[4,n.send(r)];case 1:return s=i.sent(),[2,s.as(Ee$2).pushTriggerOption]}}))}))},u.prototype.setMyPushTriggerOption=function(e){return r(this,void 0,void 0,(function(){var n,r,s,i$1,a;return i(this,(function(o){switch(o.label){case 0:return at(m(H$1,e)).throw(p.invalidParameters),n=St$1.of(this._iid),r=n.sdkState,s=n.requestQueue,i$1=new Ae({userId:r.userId,pushTriggerOption:e}),[4,s.send(i$1)];case 1:return a=o.sent(),[2,a.as(ye).pushTriggerOption]}}))}))},u.prototype.setMyCountPreference=function(e){return r(this,void 0,void 0,(function(){var n,r,s,i$1,a,o,u;return i(this,(function(c){switch(c.label){case 0:return at(m(Or,e)).throw(p.invalidParameters),n=St$1.of(this._iid),r=n.dispatcher,s=n.sdkState,i$1=n.requestQueue,a=new Sr({channelUrl:this.url,userId:s.userId,countPreference:e}),[4,i$1.send(a)];case 1:return o=c.sent(),u=o.as(Ar).countPreference,this.myCountPreference=u,this._updateUnreadCount(this.unreadMessageCount,this.unreadMentionCount),r.dispatch(new jt({channels:[this],source:Vt.EVENT_CHANNEL_CREATED})),[2,u]}}))}))},u.prototype.resetMyHistory=function(){return r(this,void 0,void 0,(function(){var e,t,n,r,s,i$1;return i(this,(function(a){switch(a.label){case 0:return e=St$1.of(this._iid),t=e.dispatcher,n=e.requestQueue,r=new Tr({channelUrl:this.url}),[4,n.send(r)];case 1:return s=a.sent(),i$1=s.as(Ur).messageOffsetTimestamp,this.messageOffsetTimestamp=i$1,t.dispatch(new jt({channels:[this],source:Vt.EVENT_CHANNEL_RESET_HISTORY})),[2,this]}}))}))},u.prototype._uploadFileAndUpdateParams=function(e){return r(this,void 0,void 0,(function(){var t,n,r,s,i$1,a,o,u,c,l,h;return i(this,(function(d){switch(d.label){case 0:return S(e.file)?(t=St$1.of(this._iid).requestQueue,n=new bt$1({file:e.file,channelUrl:this.url,thumbnailSizes:e.thumbnailSizes,requestId:this._generateRequestId()}),[4,t.send(n)]):[3,2];case 1:r=d.sent(),s=r.as(Nt$1),i$1=s.url,a=s.fileSize,o=void 0===a?e.fileSize:a,u=s.thumbnailSizes,c=void 0===u?e.thumbnailSizes:u,l=s.requireAuth,h=void 0!==l&&l,e.fileUrl=i$1,e.fileSize=o,e.thumbnailSizes=c,e.requireAuth=h,d.label=2;case 2:return [2]}}))}))},u}(kt$1),Gr={},qr=function(){function e(e){var t=e._iid,n=this;this._sync=null,this._metadata=null,this._iid=t;var r$1,s=St$1.of(this._iid),i$1=s.sdkState,a$1=s.logger;this._metadataKey=(r$1=i$1.userId,"sendbird:".concat(r$1,"@groupchannel/sync.meta"));var o$1=function(e){return "sendbird:".concat(e,"@groupchannel/sync")}(i$1.userId);this._sync=new Yn(o$1,(function(){return r(n,void 0,void 0,(function(){var e,t,n,r,s,i$1;return i(this,(function(o$1){switch(o$1.label){case 0:return e={hasNext:!0,nextToken:""},[4,this.loadMetadata()];case 1:if(o$1.sent(),a$1.debug("channel background sync from",this._metadata.token),this._metadata.completed)return [3,9];o$1.label=2;case 2:return o$1.trys.push([2,5,,8]),[4,Bn.of(this._iid).getMyGroupChannels(this._metadata.token,{includeEmpty:!0,order:K.CHRONOLOGICAL},100,Vt.SYNC_CHANNEL_BACKGROUND)];case 3:return t=o$1.sent(),n=t.channels,r=t.token,e.hasNext=n.length>=100&&!!r,e.nextToken=r,this._metadata.token=r,(i$1=this._metadata.range).extends.apply(i$1,a([],o(n.map((function(e){return e.createdAt}))),!1)),this._metadata.completed=!e.hasNext,a$1.debug("channel background sync progress",e),[4,this.saveMetadata()];case 4:return o$1.sent(),[3,8];case 5:return (s=o$1.sent())instanceof p&&s.isInvalidTokenError?[4,this.clearMetaData()]:[3,7];case 6:o$1.sent(),o$1.label=7;case 7:return e.hasNext=!1,e.nextToken="",[3,8];case 8:return [3,10];case 9:e.hasNext=!1,e.nextToken="",o$1.label=10;case 10:return [2,e]}}))}))}));}return e.of=function(t){if(!Gr[t]){var n=Gr[t]=new e({_iid:t});St$1.of(t).dispatcher.on((function(e){if(e instanceof de)if(e.stateType===J.CONNECTED)n.resume();else n.pause();}));}return Gr[t]},Object.defineProperty(e.prototype,"range",{get:function(){var e;return null===(e=this._metadata)||void 0===e?void 0:e.range},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"completed",{get:function(){var e;return !!(null===(e=this._metadata)||void 0===e?void 0:e.completed)},enumerable:!1,configurable:!0}),e.prototype.loadMetadata=function(){return r(this,void 0,void 0,(function(){var e;return i(this,(function(t){switch(t.label){case 0:return this._metadata?[3,2]:[4,St$1.of(this._iid).cacheContext.preference.get(this._metadataKey)];case 1:e=t.sent(),this._metadata={token:e?e.token:"",range:new Gn(e?e.range:{top:Number.MAX_SAFE_INTEGER,bottom:0}),completed:!!e&&e.completed},t.label=2;case 2:return [2]}}))}))},e.prototype.saveMetadata=function(){return r(this,void 0,void 0,(function(){return i(this,(function(e){switch(e.label){case 0:return this._metadata?[4,St$1.of(this._iid).cacheContext.preference.set(this._metadataKey,this._metadata)]:[3,2];case 1:e.sent(),e.label=2;case 2:return [2]}}))}))},e.prototype.clearMetaData=function(){return r(this,void 0,void 0,(function(){return i(this,(function(e){switch(e.label){case 0:return [4,St$1.of(this._iid).cacheContext.preference.remove(this._metadataKey)];case 1:return e.sent(),[2]}}))}))},e.prototype.resume=function(){var e,t;St$1.of(this._iid).logger.debug("channel background sync resume()"),this._sync.start(null!==(t=null===(e=this._metadata)||void 0===e?void 0:e.token)&&void 0!==t?t:"");},e.prototype.pause=function(){St$1.of(this._iid).logger.debug("channel background sync stop()"),this._sync.stop();},e}(),Br={},Kr=function(){function e(e){var t=e._iid,n=this;this._sync=null,this._metadataKey=null,this._metadata=null,this._iid=t;var r$1,s=St$1.of(this._iid).sdkState;this._metadataKey=(r$1=s.userId,"sendbird:".concat(r$1,"@groupchannel/changelogs.meta"));var i$1=function(e){return "sendbird:".concat(e,"@groupchannel/changelogs")}(s.userId);this._sync=new Yn(i$1,(function(){return r(n,void 0,void 0,(function(){var e,t,n,r,s;return i(this,(function(i){switch(i.label){case 0:return e={hasNext:!0,nextToken:0},[4,this.loadMetadata()];case 1:i.sent(),i.label=2;case 2:return i.trys.push([2,5,,8]),[4,Bn.of(this._iid).getMyGroupChannelChangeLogs(this._metadata.token,{},Vt.SYNC_CHANNEL_CHANGELOGS)];case 3:return t=i.sent(),n=t.hasMore,r=t.token,e.hasNext=n,e.nextToken=r,this._metadata.token=r,[4,this.saveMetadata()];case 4:return i.sent(),[3,8];case 5:return (s=i.sent())instanceof p&&s.isInvalidTokenError?[4,this.clearMetadata()]:[3,7];case 6:i.sent(),i.label=7;case 7:return e.hasNext=!1,e.nextToken="",[3,8];case 8:return [2,e]}}))}))}));}return e.of=function(t){if(!Br[t]){var n=Br[t]=new e({_iid:t});St$1.of(t).dispatcher.on((function(e){if(e instanceof de)if(e.stateType===J.CONNECTED)n.resume();else n.pause();}));}return Br[t]},e.prototype.loadMetadata=function(){return r(this,void 0,void 0,(function(){var e,t,n,r;return i(this,(function(s){switch(s.label){case 0:return this._metadata?[3,2]:(e=St$1.of(this._iid),t=e.cacheContext,n=e.firstConnectedAt,[4,t.preference.get(this._metadataKey)]);case 1:r=s.sent(),this._metadata={token:r?r.token:n/1e3},s.label=2;case 2:return [2]}}))}))},e.prototype.saveMetadata=function(){return r(this,void 0,void 0,(function(){return i(this,(function(e){switch(e.label){case 0:return this._metadata?[4,St$1.of(this._iid).cacheContext.preference.set(this._metadataKey,this._metadata)]:[3,2];case 1:e.sent(),e.label=2;case 2:return [2]}}))}))},e.prototype.clearMetadata=function(){return r(this,void 0,void 0,(function(){return i(this,(function(e){return St$1.of(this._iid).cacheContext.preference.remove(this._metadataKey),[2]}))}))},e.prototype.resume=function(){this._sync.start(0);},e.prototype.pause=function(){this._sync.stop();},e}(),jr=function(){function e(e,t){var n=t.filter,r=t.order,s=t.limit,i=this;this.channels=[],this._iid=e,this._key="gcc-".concat(R()),this.filter=null!=n?n:new Lt,this.order=null!=r?r:K.LATEST_LAST_MESSAGE,this._hasMore=!0,this._token="",this._limit=null!=s?s:j;var a=St$1.of(this._iid),o=a.sdkState;a.cacheContext.localCacheEnabled&&qr.of(e).resume(),Kr.of(e).resume(),Bn.of(this._iid).subscribeGroupChannelEvent(this._key,{onUpdate:function(e,t){var n=e.filter((function(e){return i.filter.match(e,o.userId)})),r=e.filter((function(e){return !i.filter.match(e,o.userId)})).map((function(e){return e.url}));n.length>0&&i._addChannelsToView(n,t),r.length>0&&i._removeChannelsFromView(r,t);},onRemove:function(e,t){i._removeChannelsFromView(e,t);}});}return Object.defineProperty(e.prototype,"hasMore",{get:function(){return this._hasMore},enumerable:!1,configurable:!0}),e.prototype.setGroupChannelCollectionHandler=function(e){this._handler=e;},e.prototype._addChannelsToView=function(e,t,n){var r$1,s$1,i$1=this;void 0===n&&(n=!1);var a=[],o=[];try{for(var u=s(e),c=u.next();!c.done;c=u.next()){var l=c.value,h=ir(this.channels,l,this.order),p=h.place;if(h.contains)switch(o.push(l),t){case Vt.EVENT_CHANNEL_UPDATED:case Vt.EVENT_MESSAGE_RECEIVED:this.channels.splice(p,1);var m=ir(this.channels,l,this.order).place;this.channels.splice(m,0,l);break;default:this.channels[p]=l;}else if(p===this.channels.length){var v=qr.of(this._iid);(n||v.completed)&&(a.push(l),this.channels.push(l));}else a.push(l),this.channels.splice(p,0,l);}}catch(e){r$1={error:e};}finally{try{c&&!c.done&&(s$1=u.return)&&s$1.call(u);}finally{if(r$1)throw r$1.error}}Kt(t)&&Ie((function(){return r(i$1,void 0,void 0,(function(){var e;return i(this,(function(n){return e=new Jn(t),a.length>0&&this._handler.onChannelsAdded(e,a),o.length>0&&this._handler.onChannelsUpdated(e,o),[2]}))}))}));},e.prototype._removeChannelsFromView=function(e,t){var n,r$1,s$1=this,i$1=[],a=function(e){var t=o.channels.findIndex((function(t){return t.url===e}));t>=0&&(i$1.push(o.channels[t].url),o.channels.splice(t,1));},o=this;try{for(var u=s(e),c=u.next();!c.done;c=u.next()){a(c.value);}}catch(e){n={error:e};}finally{try{c&&!c.done&&(r$1=u.return)&&r$1.call(u);}finally{if(n)throw n.error}}return Kt(t)&&i$1.length>0&&Ie((function(){return r(s$1,void 0,void 0,(function(){var e;return i(this,(function(n){return e=new Jn(t),this._handler.onChannelsDeleted(e,i$1),[2]}))}))})),i$1},e.prototype._getLocalChannels=function(){return r(this,void 0,void 0,(function(){return i(this,(function(e){switch(e.label){case 0:return [4,Bn.of(this._iid).getChannelsFromCache(this._token,this.filter,this.order)];case 1:return [2,e.sent()]}}))}))},e.prototype._getRemoteChannels=function(){return r(this,void 0,void 0,(function(){var e,t,n$1;return i(this,(function(r){switch(r.label){case 0:return [4,Bn.of(this._iid).getMyGroupChannels(this._token,n(n({},this.filter),{order:this.order}),this._limit)];case 1:return e=r.sent(),t=e.channels,n$1=e.token,this._token=n$1,[2,t]}}))}))},e.prototype.loadMore=function(){return r(this,void 0,void 0,(function(){var e,t=this;return i(this,(function(n){switch(n.label){case 0:return this._hasMore?(e=[],[4,Se((function(){return r(t,void 0,void 0,(function(){return i(this,(function(t){switch(t.label){case 0:return [4,this._getLocalChannels()];case 1:return e=t.sent(),[2]}}))}))}))]):[3,3];case 1:return n.sent(),[4,Se((function(){return r(t,void 0,void 0,(function(){return i(this,(function(t){switch(t.label){case 0:return [4,this._getRemoteChannels()];case 1:return e=t.sent(),[2]}}))}))}))];case 2:return n.sent(),this._addChannelsToView(e,Vt.REQUEST_CHANNEL,!0),[2,e];case 3:return [2,[]]}}))}))},e.prototype.dispose=function(){Bn.of(this._iid).unsubscribeGroupChannelEvent(this._key);},e}(),zr=function(t$1){function n(e){var n=this,s=e.token,i=e.limit,a=e.order,o=e.includeEmpty,u=e.membershipFilter,c=e.channelNameContainsFilter,l=e.channelUrlsFilter,h=e.customTypesFilter,d$1=e.customTypeStartsWithFilter,_=e.superChannelFilter,f=e.metadataOrderKeyFilter,p=e.metadataKey,m=e.metadataValues,v=e.metadataValueStartsWith,g=e.includeFrozen,E=e.includeMetaData;return (n=t$1.call(this)||this).method=d.GET,n.path=qe,n.params=U({token:s,limit:i,order:a,show_member:!0,show_read_receipt:!0,show_delivery_receipt:!0,show_empty:o,public_mode:Ct.PUBLIC,public_membership_mode:u,name_contains:c,channel_urls:l,custom_types:h,custom_type_startswith:d$1,super_mode:_,metadata_order_key:f,metadata_key:p,metadata_values:m,metadata_value_startswith:v,show_frozen:g,show_metadata:E}),n}return t(n,t$1),n}(q),Qr=function(t$1){function n(e,n){var r=t$1.call(this,e,n)||this;r.token=null,r.channels=[],r.ts=null;var s=n.next,i=n.channels,a=n.ts;return r.token=s,i&&i.length>0&&(r.channels=i.map((function(t){return t.ts=a,new Vr(e,t)}))),r.ts="number"==typeof a?a:null,r}return t(n,t$1),n}(F);!function(e){e.ALL="all",e.JOINED="joined";}(Hr||(Hr={}));var Wr=function(n$1){function r$1(e,t){var r,s,i,a,o,u,c,l,h,d,_,f,p,m,v=this;return (v=n$1.call(this,e,t)||this).includeEmpty=!1,v.includeFrozen=!0,v.includeMetaData=!0,v.channelUrlsFilter=null,v.customTypesFilter=null,v.customTypeStartsWithFilter=null,v.nicknameContainsFilter=null,v.channelNameContainsFilter=null,v.membershipFilter=Hr.ALL,v.superChannelFilter=bt.ALL,v.metadataKey=null,v.metadataValues=null,v.metadataOrderKeyFilter=null,v.metadataValueStartsWith=null,v.order=G.CHRONOLOGICAL,v.includeEmpty=null!==(r=t.includeEmpty)&&void 0!==r&&r,v.includeFrozen=null===(s=t.includeFrozen)||void 0===s||s,v.includeMetaData=null===(i=t.includeMetaData)||void 0===i||i,v.channelUrlsFilter=null!==(a=t.channelUrlsFilter)&&void 0!==a?a:null,v.customTypesFilter=null!==(o=t.customTypesFilter)&&void 0!==o?o:null,v.customTypeStartsWithFilter=null!==(u=t.customTypeStartsWithFilter)&&void 0!==u?u:null,v.channelNameContainsFilter=null!==(c=t.channelNameContainsFilter)&&void 0!==c?c:null,v.membershipFilter=null!==(l=t.membershipFilter)&&void 0!==l?l:Hr.ALL,v.superChannelFilter=null!==(h=t.superChannelFilter)&&void 0!==h?h:bt.ALL,v.metadataKey=null!==(d=t.metadataKey)&&void 0!==d?d:null,v.metadataValues=null!==(_=t.metadataValues)&&void 0!==_?_:null,v.metadataOrderKeyFilter=null!==(f=t.metadataOrderKeyFilter)&&void 0!==f?f:null,v.metadataValueStartsWith=null!==(p=t.metadataValueStartsWith)&&void 0!==p?p:null,v.order=null!==(m=t.order)&&void 0!==m?m:G.CHRONOLOGICAL,v}return t(r$1,n$1),r$1.prototype._validate=function(){return n$1.prototype._validate.call(this)&&y("boolean",this.includeEmpty)&&y("boolean",this.includeFrozen)&&y("boolean",this.includeMetaData)&&y("string",this.channelNameContainsFilter,!0)&&E("string",this.channelUrlsFilter,!0)&&E("string",this.customTypesFilter,!0)&&y("string",this.customTypeStartsWithFilter,!0)&&m(Hr,this.membershipFilter)&&m(bt,this.superChannelFilter)&&m(G,this.order)&&y("string",this.metadataOrderKeyFilter,!0)&&y("string",this.metadataKey,!0)&&E("string",this.metadataValues,!0)&&y("string",this.metadataValueStartsWith,!0)},r$1.prototype.next=function(){return r(this,void 0,void 0,(function(){var e,t,n$1,r,i$1,a,o,u,c;return i(this,(function(l){switch(l.label){case 0:return this._validate()?this._isLoading?[3,3]:(e=[],this._hasNext?(this._isLoading=!0,t=St$1.of(this._iid),n$1=t.requestQueue,r=t.dispatcher,i$1=new zr(n(n({},this),{token:this._token})),[4,n$1.send(i$1)]):[3,2]):[3,5];case 1:return a=l.sent(),o=a.as(Qr),u=o.channels,c=o.token,this._token=c,this._hasNext=!!c,r.dispatch(new jt({channels:u,source:Vt.REQUEST_CHANNEL})),this._isLoading=!1,[2,u];case 2:return [2,e];case 3:throw p.queryInProgress;case 4:return [3,6];case 5:throw p.invalidParameters;case 6:return [2]}}))}))},r$1}(bn$1),Yr=function(t$1){function n(e){void 0===e&&(e={});var n=t$1.call(this)||this;return Object.keys(e).forEach((function(t){n.hasOwnProperty(t)&&(n[t]=e[t]);})),n}return t(n,t$1),n}(function(t$1){function n(){var e=null!==t$1&&t$1.apply(this,arguments)||this;return e.onUserJoined=Y$1,e.onUserLeft=Y$1,e.onUserReceivedInvitation=Y$1,e.onUserDeclinedInvitation=Y$1,e.onChannelHidden=Y$1,e.onUnreadMemberStatusUpdated=Y$1,e.onUndeliveredMemberStatusUpdated=Y$1,e.onTypingStatusUpdated=Y$1,e}return t(n,t$1),n}(U$1)),Jr=function(t$1){function n(e){var n=this,s=e.token,i=e.limit,a=e.order,o=e.reverse,u=e.channelUrl,c=e.messageTypeFilter,l=e.scheduledStatus;return (n=t$1.call(this)||this).method=d.GET,n.path="".concat(Ve),n.params=U({limit:i,reverse:o,channel_url:u,order:a,status:l}),s&&(n.params.token=s),c&&(n.params.message_type_filter=c),n}return t(n,t$1),n}(q),Xr=function(t$1){function n(e,n){var r=t$1.call(this,e,n)||this;r.token=null,r.scheduledMessages=[];var s=n.next,i=n.scheduled_messages;return r.token=s,r.scheduledMessages=i.map((function(t){return Ht$1(e,t)})),r}return t(n,t$1),n}(F),Zr=function(n$1){function r$1(e,t){var r,s,i,a,o,u=this;return (u=n$1.call(this,e,t)||this).channelUrl=null,u.order=null,u.reverse=!1,u.scheduledStatus=null,u.messageTypeFilter=se.ALL,u.channelUrl=null!==(r=t.channelUrl)&&void 0!==r?r:null,u.order=null!==(s=t.order)&&void 0!==s?s:null,u.reverse=null!==(i=t.reverse)&&void 0!==i&&i,u.scheduledStatus=null!==(a=t.scheduledStatus)&&void 0!==a?a:null,u.messageTypeFilter=null!==(o=t.messageTypeFilter)&&void 0!==o?o:se.ALL,u}return t(r$1,n$1),r$1.prototype._validate=function(){return n$1.prototype._validate.call(this)&&y("string",this.channelUrl,!0)&&(m(Q,this.order)||null===this.order)&&y("boolean",this.reverse)&&(E(Ct$1,this.scheduledStatus)||null===this.scheduledStatus)&&m(se,this.messageTypeFilter)},r$1.prototype.next=function(){return r(this,void 0,void 0,(function(){var e,t,n$1,r,i$1,a;return i(this,(function(o){switch(o.label){case 0:return this._validate()?this._isLoading?[3,3]:this._hasNext?(this._isLoading=!0,e=St$1.of(this._iid).requestQueue,t=new Jr(n(n({},this),{token:this._token})),[4,e.send(t)]):[3,2]:[3,5];case 1:return n$1=o.sent(),r=n$1.as(Xr),i$1=r.scheduledMessages,a=r.token,this._token=a,this._hasNext=!!a,this._isLoading=!1,[2,i$1];case 2:return [2,[]];case 3:throw p.queryInProgress;case 4:return [3,6];case 5:throw p.invalidParameters;case 6:return [2]}}))}))},r$1}(bn$1),$r=function(t$1){function n$1(){var e=null!==t$1&&t$1.apply(this,arguments)||this;return e.name="groupChannel",e}return t(n$1,t$1),n$1.prototype.init=function(e,n){var r=n.sdkState,s=n.dispatcher,i=n.sessionManager,a=n.requestQueue,o=n.logger,u=n.onlineDetector,c=n.cacheContext;t$1.prototype.init.call(this,e,{sdkState:r,dispatcher:s,sessionManager:i,requestQueue:a,logger:o,onlineDetector:u,cacheContext:c}),this._manager=new Bn(e,{sdkState:r,cacheContext:c,dispatcher:s,sessionManager:i,requestQueue:a,logger:o});},n$1.prototype.createGroupChannelCollection=function(e){return void 0===e&&(e={}),new jr(this._iid,e)},n$1.prototype.createMyGroupChannelListQuery=function(e){return void 0===e&&(e={}),new Vn(this._iid,e)},n$1.prototype.createPublicGroupChannelListQuery=function(e){return void 0===e&&(e={}),new Wr(this._iid,e)},n$1.prototype.createScheduledMessageListQuery=function(e){return void 0===e&&(e={}),new Zr(this._iid,e)},n$1.prototype.addGroupChannelHandler=function(e,t){at(y("string",e)&&t instanceof Yr).throw(p.invalidParameters),this._manager.addHandler(e,t);},n$1.prototype.removeGroupChannelHandler=function(e){at(y("string",e)).throw(p.invalidParameters),this._manager.removeHandler(e);},n$1.prototype.removeAllGroupChannelHandlers=function(){this._manager.clearHandler();},n$1.prototype.buildGroupChannelFromSerializedData=function(e){return this._manager.buildGroupChannelFromSerializedData(e)},n$1.prototype.buildGroupChannelListQueryFromSerializedData=function(e){return this._manager.buildGroupChannelListQueryFromSerializedData(e)},n$1.prototype.buildMemberFromSerializedData=function(e){return this._manager.buildMemberFromSerializedData(e)},n$1.prototype.getChannel=function(e){return r(this,void 0,void 0,(function(){return i(this,(function(t){return at(y("string",e)).throw(p.invalidParameters),[2,this._manager.getChannel(e)]}))}))},n$1.prototype.getChannelWithoutCache=function(e){return r(this,void 0,void 0,(function(){return i(this,(function(t){return at(y("string",e)).throw(p.invalidParameters),[2,this._manager.getChannelWithoutCache(e)]}))}))},n$1.prototype.getMyGroupChannelChangeLogsByToken=function(e,t){return r(this,void 0,void 0,(function(){return i(this,(function(n$1){switch(n$1.label){case 0:return t=n(n({},Ft),t),at(y("string",e)&&Pt(t)).throw(p.invalidParameters),[4,this._manager.getMyGroupChannelChangeLogs(e,t)];case 1:return [2,n$1.sent()]}}))}))},n$1.prototype.getMyGroupChannelChangeLogsByTimestamp=function(e,t){return r(this,void 0,void 0,(function(){return i(this,(function(n$1){switch(n$1.label){case 0:return t=n(n({},Ft),t),at(y("number",e)&&Pt(t)).throw(p.invalidParameters),[4,this._manager.getMyGroupChannelChangeLogs(e,t)];case 1:return [2,n$1.sent()]}}))}))},n$1.prototype.getGroupChannelCount=function(e){return r(this,void 0,void 0,(function(){return i(this,(function(t){return e=n(n({},xt),e),at(Ht(e)).throw(p.invalidParameters),[2,this._manager.getGroupChannelCount(e)]}))}))},n$1.prototype.getUnreadItemCount=function(e){return r(this,void 0,void 0,(function(){return i(this,(function(t){switch(t.label){case 0:return [4,this._manager.getUnreadItemCount(e)];case 1:return [2,t.sent()]}}))}))},n$1.prototype.getTotalUnreadChannelCount=function(){return r(this,void 0,void 0,(function(){return i(this,(function(e){switch(e.label){case 0:return [4,this._manager.getTotalUnreadChannelCount()];case 1:return [2,e.sent()]}}))}))},n$1.prototype.getTotalUnreadMessageCount=function(e){return r(this,void 0,void 0,(function(){return i(this,(function(t){switch(t.label){case 0:return [4,this._manager.getTotalUnreadMessageCount(e)];case 1:return [2,t.sent()]}}))}))},n$1.prototype.getTotalScheduledMessageCount=function(e){return r(this,void 0,void 0,(function(){return i(this,(function(t){switch(t.label){case 0:return [4,this._manager.getTotalScheduledMessageCount(e)];case 1:return [2,t.sent()]}}))}))},n$1.prototype.getSubscribedTotalUnreadMessageCount=function(){return this._manager.getSubscribedTotalUnreadMessageCount()},n$1.prototype.getSubscribedCustomTypeTotalUnreadMessageCount=function(){return this._manager.getSubscribedCustomTypeTotalUnreadMessageCount()},n$1.prototype.getSubscribedCustomTypeUnreadMessageCount=function(e){return this._manager.getSubscribedCustomTypeUnreadMessageCount(e)},n$1.prototype.createChannel=function(e){return void 0===e&&(e={}),r(this,void 0,void 0,(function(){return i(this,(function(t){return e=n(n({},Ot),e),at(kt(e)).throw(p.invalidParameters),[2,this._manager.createChannel(e)]}))}))},n$1.prototype.createDistinctChannelIfNotExist=function(e){return r(this,void 0,void 0,(function(){return i(this,(function(t){return e=n(n({},Ot),e),at(kt(e)).throw(p.invalidParameters),e&&(e.isDistinct=!0),[2,this.createChannel(e)]}))}))},n$1.prototype.createChannelWithUserIds=function(e,t,n$1,r$1,i$1,a){return void 0===t&&(t=!1),void 0===n$1&&(n$1=null),void 0===r$1&&(r$1=null),void 0===i$1&&(i$1=""),void 0===a&&(a=""),r(this,void 0,void 0,(function(){var o;return i(this,(function(u){return o=n(n({},Ot),{invitedUserIds:e,isDistinct:t,name:n$1,data:i$1,customType:a}),"string"==typeof r$1?o.coverUrl=r$1:o.coverImage=r$1,[2,this.createChannel(o)]}))}))},n$1.prototype.markAsReadAll=function(){return r(this,void 0,void 0,(function(){return i(this,(function(e){return this._manager.markAsReadAll(),[2]}))}))},n$1.prototype.markAsReadWithChannelUrls=function(e){return r(this,void 0,void 0,(function(){return i(this,(function(t){return at(E("string",e)).throw(p.invalidParameters),this._manager.markAsReadWithChannelUrls(e),[2]}))}))},n$1.prototype.markAsDelivered=function(e){return r(this,void 0,void 0,(function(){return i(this,(function(t){switch(t.label){case 0:return at(y("string",e)).throw(p.invalidParameters),[4,this.getChannel(e)];case 1:return [4,t.sent().markAsDelivered()];case 2:return t.sent(),[2]}}))}))},n$1}(Tt$1);

export { $r as $, Yr as Y };
//# sourceMappingURL=groupChannel-57b063a3.js.map
