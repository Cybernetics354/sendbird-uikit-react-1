{"version":3,"file":"EditDetailsModal.js","sources":["../../../src/smart-components/OpenChannelSettings/components/EditDetailsModal.tsx"],"sourcesContent":["import React, {\n  useState,\n  useRef,\n  useContext,\n  ReactElement,\n} from 'react';\nimport { OpenChannelUpdateParams } from '@sendbird/chat/openChannel';\n\nimport { LocalizationContext } from '../../../lib/LocalizationContext';\nimport Modal from '../../../ui/Modal';\nimport Input, { InputLabel } from '../../../ui/Input';\nimport Avatar from '../../../ui/Avatar/index';\nimport { Type as ButtonType } from '../../../ui/Button/type';\nimport Label, { LabelColors, LabelTypography } from '../../../ui/Label';\nimport TextButton from '../../../ui/TextButton';\nimport OpenChannelAvatar from '../../../ui/ChannelAvatar/OpenChannelAvatar';\nimport { useOpenChannelSettingsContext } from '../context/OpenChannelSettingsProvider';\nimport useSendbirdStateContext from '../../../hooks/useSendbirdStateContext';\n\ninterface Props {\n  onCancel(): void;\n}\n\nconst EditDetails = (props: Props): ReactElement => {\n  const {\n    onCancel,\n  } = props;\n  const globalState = useSendbirdStateContext();\n  const logger = globalState?.config?.logger;\n  const theme = globalState?.config?.theme;\n  const {\n    channel,\n    onBeforeUpdateChannel,\n    onChannelModified,\n    setChannel,\n  } = useOpenChannelSettingsContext();\n\n  const inputRef = useRef(null);\n  const formRef = useRef(null);\n  const hiddenInputRef = useRef(null);\n  const [currentImg, setCurrentImg] = useState(null);\n  const [newFile, setNewFile] = useState(null);\n  const { stringSet } = useContext(LocalizationContext);\n  const title = channel?.name;\n  return (\n    <Modal\n      titleText={stringSet.MODAL__CHANNEL_INFORMATION__TITLE}\n      submitText={stringSet.BUTTON__SAVE}\n      onCancel={onCancel}\n      onSubmit={() => {\n        if (title !== '' && !inputRef.current.value) {\n          if (formRef.current.reportValidity) { // might not work in explorer\n            formRef.current.reportValidity();\n          }\n          return;\n        }\n        const currentTitle = inputRef.current.value;\n        const currentImg = newFile;\n        logger.info('ChannelSettings: Channel information being updated');\n        const params: OpenChannelUpdateParams = onBeforeUpdateChannel\n          ? onBeforeUpdateChannel(currentTitle, currentImg, channel?.data)\n          : {\n            name: currentTitle,\n            coverUrlOrImage: currentImg,\n            data: channel?.data,\n          };\n        logger.info('ChannelSettings: Updating channel information', params);\n        channel?.updateChannel(params)\n          .then((updateChannel) => {\n            logger.info('ChannelSettings: Channel information update succeeded', updateChannel);\n            onChannelModified?.(updateChannel);\n            setChannel(updateChannel);\n          })\n          .catch((error) => {\n            logger.error('ChannelSettings: Channel infomation update failed', error);\n            setChannel(null);\n          });\n        onCancel();\n      }}\n      type={ButtonType.PRIMARY}\n    >\n      <form\n        className=\"channel-profile-form\"\n        ref={formRef}\n        onSubmit={(e) => { e.preventDefault(); }}\n      >\n        <div className=\"channel-profile-form__img-section\">\n          <InputLabel>\n            {stringSet.MODAL__CHANNEL_INFORMATION__CHANNEL_IMAGE}\n          </InputLabel>\n          <div className=\"channel-profile-form__avatar\">\n            {\n              currentImg\n                ? (\n                  <Avatar\n                    height=\"80px\"\n                    width=\"80px\"\n                    src={currentImg}\n                  />\n                ) : (\n                  <OpenChannelAvatar\n                    height={80}\n                    width={80}\n                    channel={channel}\n                    theme={theme}\n                  />\n                )\n            }\n          </div>\n          <input\n            ref={hiddenInputRef}\n            type=\"file\"\n            accept=\"image/gif, image/jpeg, image/png\"\n            style={{ display: 'none' }}\n            onChange={(e) => {\n              setCurrentImg(URL.createObjectURL(e.target.files[0]));\n              setNewFile(e.target.files[0]);\n              hiddenInputRef.current.value = '';\n            }}\n          />\n          <TextButton\n            className=\"channel-profile-form__avatar-button\"\n            onClick={() => hiddenInputRef.current.click()}\n            notUnderline\n          >\n            <Label type={LabelTypography.BUTTON_1} color={LabelColors.PRIMARY}>\n              {stringSet.MODAL__CHANNEL_INFORMATION__UPLOAD}\n            </Label>\n          </TextButton>\n        </div>\n        <div className=\"channel-profile-form__name-section\">\n          <InputLabel>\n            {stringSet.MODAL__CHANNEL_INFORMATION__CHANNEL_NAME}\n          </InputLabel>\n          <Input\n            required={title !== ''}\n            name=\"channel-profile-form__name\"\n            ref={inputRef}\n            value={title}\n            placeHolder={stringSet.MODAL__CHANNEL_INFORMATION__INPUT__PLACE_HOLDER}\n          />\n        </div>\n      </form>\n    </Modal>\n  );\n};\n\nexport default EditDetails;\n"],"names":["EditDetails","props","onCancel","globalState","useSendbirdStateContext","logger","config","theme","_c","useOpenChannelSettingsContext","channel","onBeforeUpdateChannel","onChannelModified","setChannel","inputRef","useRef","formRef","hiddenInputRef","_d","useState","currentImg","setCurrentImg","_e","newFile","setNewFile","stringSet","useContext","LocalizationContext","title","name","React","MODAL__CHANNEL_INFORMATION__TITLE","BUTTON__SAVE","current","value","reportValidity","currentTitle","info","params","data","coverUrlOrImage","updateChannel","then","catch","error","ButtonType","PRIMARY","e","preventDefault","MODAL__CHANNEL_INFORMATION__CHANNEL_IMAGE","OpenChannelAvatar","display","URL","createObjectURL","target","files","click","LabelTypography","BUTTON_1","LabelColors","MODAL__CHANNEL_INFORMATION__UPLOAD","MODAL__CHANNEL_INFORMATION__CHANNEL_NAME","MODAL__CHANNEL_INFORMATION__INPUT__PLACE_HOLDER"],"mappings":"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"}